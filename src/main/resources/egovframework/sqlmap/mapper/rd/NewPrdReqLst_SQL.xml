<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="NewPrdReqLst">
	<select id="selectNewPrdReqLst" parameterType="HashMap" resultType="HashMap">
		/* NewPrdReqLst.selectNewPrdReqLst 신규상품요청처리 조회 */
		<![CDATA[
		SELECT
			Z2.CO_CD                                         /*회사코드*/
			, Z2.NEW_PRD_REQ_NO                                /*신규상품요청번호*/
			, Z2.NEW_PRD_REQ_STATS_CD                          /*처리상태*/
			, Z2.NEW_PRD_REQ_STATS_CD_NM                       /*처리상태명*/
			, Z2.REQ_SBJ_CD                                    /*요청주체코드*/
			, Z2.REQ_SBJ_NM                                    /*요청주체명*/
			, Z2.PRD_PRPS_STATS_CD                             /*상품제안상태코드*/
			, Z2.PRD_PRPS_STATS_NM                             /*상품제안상태명*/
			, Z2.RND_REQ_PRD_ID                                /*RND상품ID*/
			, Z2.REQ_PRD_NM                                    /*요청상품명*/
			, Z2.PRD_CLCD                                      /*카테고리ID*/
			, Z2.PRD_CLCD_NM                                   /*카테고리*/
			, SSP_APP.FN_RD_ATTR_VAL_LIST(Z2.CO_CD, Z2.NEW_PRD_REQ_NO, Z2.PRD_CLCD) AS NEW_PRD_REQ_PRVL_LIST    /*대표규격*/
			, Z2.MNFR_NO                                       /*제조사번호*/
			, Z2.MRO_MNFR_NM                                   /*제조사명*/
			, Z2.BASIS_UNIT_QTY                                /*기본단위수량*/
			, Z2.BASIS_UNIT_CD                                 /*기본단위코드*/
			, Z2.SELL_UNIT_CD                                  /*판매단위코드*/
			, Z2.BASIS_NM                                      /*주문단위명*/
			, Z2.CHM_MTL_PRD_YN                                /*화학물질여부*/
			, Z2.TX_CLCD                                       /*세금분류코드*/
			, Z2.TX_CLCD_NM                                    /*세금분류코드명*/
			, Z2.PUB_ONLY_SPR_CD                               /*공용전용구분*/
			, Z2.PUB_ONLY_SPR_NM                               /*공용전용구분명*/
			, Z2.DISP_PRD_SPR_CD                               /*전시상품*/
			, Z2.DISP_PRD_SPR_NM                               /*전시상품구분명*/
			, Z2.REQ_DTM                                       /*요청일*/
			, Z2.BZPLC_ID                                      /*사업장ID*/
			, Z2.BZPLC_NM                                      /*사업장명*/
			, Z2.OPR_UNIT_ID                                   /*운영단위ID*/
			, Z2.OPR_UNIT_NM                                   /*운영단위명*/
			, Z2.REQ_ID                                        /*요청자*/
			, Z2.REQ_NM                                        /*요청자*/
			, Z2.PURG_CHRPSN_ID                                /*구매담당자ID*/
			, Z2.PURG_CHRPSN_NM                                /*구매담당자명*/
			, Z2.PROC_DTM                                      /*처리일*/
			, Z2.PROC_ID                                       /*처리자*/
			, Z2.PROC_NM                                       /*처리자명*/
		FROM (
			SELECT
				Z1.CO_CD
				, Z1.NEW_PRD_REQ_NO
				, Z1.NEW_PRD_REQ_STATS_CD
				, DECODE(Z1.NEW_PRD_REQ_STATS_CD, '27', '완료', Z2.COM_USR_DEFN_NM_2) AS NEW_PRD_REQ_STATS_CD_NM  /*처리상태명*/
				, Z1.REQ_SBJ_CD
				, Z3.COM_DTL_CD_NM AS REQ_SBJ_NM               /*요청주체명*/
				, Z1.PRD_PRPS_STATS_CD
				, Z4.COM_DTL_CD_NM AS PRD_PRPS_STATS_NM        /*상품제안상태명*/
				, Z1.RND_REQ_PRD_ID
				, Z1.REQ_PRD_NM
				, Z1.PRD_CLCD
				, Z1.PRD_CLCD_NM
				, Z1.MNFR_NO
				, Z5.MRO_MNFR_NM
				, Z1.BASIS_UNIT_QTY
				, Z1.BASIS_UNIT_CD
				, Z1.SELL_UNIT_CD
				, Z1.BASIS_NM
				, Z1.CHM_MTL_PRD_YN
				, Z1.TX_CLCD
				, Z6.COM_DTL_CD_NM AS TX_CLCD_NM               /*세금분류코드명*/
				, Z1.PUB_ONLY_SPR_CD
				, Z7.COM_DTL_CD_NM AS PUB_ONLY_SPR_NM          /*공용전용구분명*/
				, Z1.DISP_PRD_SPR_CD
				, Z8.COM_DTL_CD_NM AS DISP_PRD_SPR_NM          /*전시상품구분명*/
				, Z15.BZPLC_ID
				, Z15.BZPLC_NM
				, Z16.OPR_UNIT_ID
				, Z16.OPR_UNIT_NM
				, Z1.REQ_DTM
				, Z1.REQ_ID
				, FN_CC_GET_MBR_NM(Z1.CO_CD, Z1.REQ_ID) AS REQ_NM             /*요청자명*/
				, Z1.PURG_CHRPSN_ID
				, Z11.OPRTR_NM AS PURG_CHRPSN_NM           /*구매담당자명*/
				, Z1.PROC_DTM
				, Z1.PROC_ID
				, Z12.OPRTR_NM AS PROC_NM                  /*처리자명*/
			FROM (
				SELECT
					A2.CO_CD
                             , A2.NEW_PRD_REQ_NO
                             , A2.REQ_PRD_NM
                             , A2.PRD_CLCD
                             , A2.PUB_ONLY_SPR_CD
                             , A2.BASIS_UNIT_CD
                             , A2.BASIS_UNIT_QTY
                             , CASE WHEN A2.BASIS_UNIT_QTY > 1
                                     AND A2.SELL_UNIT_CD != A2.BASIS_UNIT_CD
                                    THEN A2.SELL_UNIT_CD
                               END                                          AS SELL_UNIT_CD
                             , TRIM(TO_CHAR(A2.BASIS_UNIT_QTY,'999,999,999,999,999'))
                               ||' '
                               ||A2.BASIS_UNIT_CD
                               ||CASE WHEN A2.SELL_UNIT_CD IS NOT NULL
                                       AND A2.BASIS_UNIT_CD != A2.SELL_UNIT_CD
                                      THEN '/'||A2.SELL_UNIT_CD
                               END                                          AS BASIS_NM
                             , A2.ORGPLC_CTRY_CD
                             , A2.MNFR_NO
                             , A2.MRO_REQ_NO
                             , A2.MRO_PROC_STATS_CD
                             , A2.MRO_DUP_PRD_ID
                             , A2.MRO_PRD_ID
                             , A2.EXCEPT_END_RSN
                             , A2.PRD_REG_DIS_TP_CD
                             , A2.REG_DIS_RSN
                             , A2.PRD_PRPS_SPR_CD
                             , A2.PRD_PRPS_STATS_CD
                             , A2.ALT_PRPS_RSN
                             , A2.CUST_RJT_RSN
                             , A2.PRPS_PRD_ID
                             , A2.TRSF_RSN
                             , A2.MALL_SPR_CD
                             , A2.ESTM_REQ_NO
                             , A2.UPD_RSN
                             , A2.RND_REQ_PRD_ID
                             , A2.REGPSN_ID
                             , A2.REG_DTM
                             , A2.UPDPSN_ID
                             , A2.UPD_DTM
                             , A2.REQ_SBJ_CD
                             , A2.NEW_PRD_REQ_STATS_CD
                             , A2.PRD_CLCD_NM
                             , A2.CHM_MTL_PRD_YN
                             , A2.TX_CLCD
                             , A2.DISP_PRD_SPR_CD
                             , A2.REQ_DTM
                             , A2.REQ_ID
                             , A2.PURG_CHRPSN_ID
                             , A2.PROC_DTM
                             , A2.PROC_ID
                             , A2.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
		                  FROM (
		                        SELECT A1.CO_CD                                                                             AS CO_CD
                                     , A1.NEW_PRD_REQ_NO                                                                    AS NEW_PRD_REQ_NO
                                     , A1.REQ_PRD_NM                                                                        AS REQ_PRD_NM
                                     , A1.PRD_CLCD                                                                          AS PRD_CLCD
                                     , A1.PUB_ONLY_SPR_CD                                                                   AS PUB_ONLY_SPR_CD
                                     , A1.BASIS_UNIT_CD                                                                     AS BASIS_UNIT_CD
                                     , A1.BASIS_UNIT_QTY                                                                    AS BASIS_UNIT_QTY
                                     , A1.SELL_UNIT_CD                                                                      AS SELL_UNIT_CD
                                     , A1.ORGPLC_CTRY_CD                                                                    AS ORGPLC_CTRY_CD
                                     , A1.MNFR_NO                                                                           AS MNFR_NO
                                     , A1.MRO_REQ_NO                                                                        AS MRO_REQ_NO
                                     , A1.MRO_PROC_STATS_CD                                                                 AS MRO_PROC_STATS_CD
                                     , A1.MRO_DUP_PRD_ID                                                                    AS MRO_DUP_PRD_ID
                                     , A1.MRO_PRD_ID                                                                        AS MRO_PRD_ID
                                     , A1.EXCEPT_END_RSN                                                                    AS EXCEPT_END_RSN
                                     , A1.PRD_REG_DIS_TP_CD                                                                 AS PRD_REG_DIS_TP_CD
                                     , A1.REG_DIS_RSN                                                                       AS REG_DIS_RSN
                                     , A1.PRD_PRPS_SPR_CD                                                                   AS PRD_PRPS_SPR_CD
                                     , A1.PRD_PRPS_STATS_CD                                                                 AS PRD_PRPS_STATS_CD
                                     , A1.ALT_PRPS_RSN                                                                      AS ALT_PRPS_RSN
                                     , A1.CUST_RJT_RSN                                                                      AS CUST_RJT_RSN
                                     , A1.PRPS_PRD_ID                                                                       AS PRPS_PRD_ID
                                     , A1.TRSF_RSN                                                                          AS TRSF_RSN
                                     , A1.MALL_SPR_CD                                                                       AS MALL_SPR_CD
                                     , A1.ESTM_REQ_NO                                                                       AS ESTM_REQ_NO
                                     , A1.UPD_RSN                                                                           AS UPD_RSN
                                     
                                     /*, A1.RND_REQ_PRD_ID                                                                    AS RND_REQ_PRD_ID*/
                                     , DECODE(A1.NEW_PRD_REQ_STATS_CD, '30', A1.PRPS_PRD_ID
                                                                     , '56', A1.PRPS_PRD_ID    /*MRO_DUP_PRD_ID*/
                                                                           , A1.RND_REQ_PRD_ID                           )  AS RND_REQ_PRD_ID
                                     
                                     , A1.REGPSN_ID                                                                         AS REGPSN_ID
                                     , A1.REG_DTM                                                                           AS REG_DTM
                                     , A1.UPDPSN_ID                                                                         AS UPDPSN_ID
                                     , A1.UPD_DTM                                                                           AS UPD_DTM
                                     , A1.REQ_SBJ_CD                                                                        AS REQ_SBJ_CD
                                     , A1.NEW_PRD_REQ_STATS_CD                                                              AS NEW_PRD_REQ_STATS_CD
                                     , A1.PRD_CLCD_NM                                                                       AS PRD_CLCD_NM
                                     , A1.CHM_MTL_PRD_YN                                                                    AS CHM_MTL_PRD_YN
                                     , A1.TX_CLCD                                                                           AS TX_CLCD
                                     , A1.DISP_PRD_SPR_CD                                                                   AS DISP_PRD_SPR_CD
                                     , A1.REQ_DTM                                                                           AS REQ_DTM
                                     , A1.REQ_ID                                                                            AS REQ_ID
                                     , A1.PURG_CHRPSN_ID                                                                    AS PURG_CHRPSN_ID
                                     , A1.PROC_DTM                                                                          AS PROC_DTM
                                     , A1.PROC_ID                                                                           AS PROC_ID
                                     , A1.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER                                                AS TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
		                          FROM (
		                                SELECT /*+ INDEX_USE(A TB_PR_NEW_PRD_REQ_PROC_PK) */
		                                       A.CO_CD                                                                     AS CO_CD                       /*회사코드*/
                                             , A.NEW_PRD_REQ_NO                                                            AS NEW_PRD_REQ_NO              /*신규상품요청번호*/
                                             , A.REQ_PRD_NM                                                                AS REQ_PRD_NM                  /*요청상품명*/
                                             , A.PRD_CLCD                                                                  AS PRD_CLCD                    /*상품분류코드*/
                                             , A.PUB_ONLY_SPR_CD                                                           AS PUB_ONLY_SPR_CD             /*공용전용구분코드*/
                                             , A.BASIS_UNIT_CD                                                             AS BASIS_UNIT_CD               /*기본단위코드*/
                                             , A.BASIS_UNIT_QTY                                                            AS BASIS_UNIT_QTY              /*기본단위수량*/
                                             , A.SELL_UNIT_CD                                                              AS SELL_UNIT_CD                /*판매단위코드*/
                                             , A.ORGPLC_CTRY_CD                                                            AS ORGPLC_CTRY_CD              /*원산지국가코드*/
                                             , A.MNFR_NO                                                                   AS MNFR_NO                     /*제조사번호*/
                                             , A.MRO_REQ_NO                                                                AS MRO_REQ_NO                  /*MRO요청번호*/
                                             , A.MRO_PROC_STATS_CD                                                         AS MRO_PROC_STATS_CD           /*MRO처리상태코드*/
                                             , TO_CHAR(TO_NUMBER(A.MRO_DUP_PRD_ID))                                        AS MRO_DUP_PRD_ID              /*MRO중복상품ID*/
                                             , A.MRO_PRD_ID                                                                AS MRO_PRD_ID                  /*MRO상품ID*/
                                             , A.EXCEPT_END_RSN                                                            AS EXCEPT_END_RSN              /*예외종료사유*/
                                             , A.PRD_REG_DIS_TP_CD                                                         AS PRD_REG_DIS_TP_CD           /*상품등록불가유형코드*/
                                             , A.REG_DIS_RSN                                                               AS REG_DIS_RSN                 /*등록불가사유*/
                                             , A.PRD_PRPS_SPR_CD                                                           AS PRD_PRPS_SPR_CD             /*상품제안구분코드*/
                                             , A.PRD_PRPS_STATS_CD                                                         AS PRD_PRPS_STATS_CD           /*상품제안상태코드*/
                                             , A.ALT_PRPS_RSN                                                              AS ALT_PRPS_RSN                /*대체제안사유*/
                                             , A.CUST_RJT_RSN                                                              AS CUST_RJT_RSN                /*고객거부사유*/
                                             , TO_CHAR(TO_NUMBER(A.PRPS_PRD_ID))                                           AS PRPS_PRD_ID                 /*제안상품ID*/
                                             , A.TRSF_RSN                                                                  AS TRSF_RSN                    /*이관사유*/
                                             , A.MALL_SPR_CD                                                               AS MALL_SPR_CD                 /*몰구분코드*/
                                             , A.ESTM_REQ_NO                                                               AS ESTM_REQ_NO                 /*견적요청번호*/
                                             , A.UPD_RSN                                                                   AS UPD_RSN                     /*수정사유*/
                                             , TO_CHAR(TO_NUMBER(A.RND_REQ_PRD_ID))                                        AS RND_REQ_PRD_ID              /*RND요청상품ID*/
                                             , B.REGPSN_ID                                                                 AS REGPSN_ID					  /*등록자ID*/
                                             , A.REG_DTM                                                                   AS REG_DTM                     /*등록일시*/
                                             , A.UPDPSN_ID                                                                 AS UPDPSN_ID                   /*수정자ID*/
                                             , A.UPD_DTM                                                                   AS UPD_DTM                     /*수정일시*/
                                             , C.REQ_SBJ_CD                                                                AS REQ_SBJ_CD
                                             , B.NEW_PRD_REQ_STATS_CD                                                      AS NEW_PRD_REQ_STATS_CD
                                             , (
                                                SELECT SSP_APP.FN_PR_FULL_CLSF_NM
                                                       (
                                                         A.CO_CD
                                                       , A.PRD_CLCD
                                                       )
                                                  FROM DUAL
                                               )                                                                           AS PRD_CLCD_NM
                                             , ROW_NUMBER() OVER (
                                                                  PARTITION BY A.CO_CD
		                                                                     , A.NEW_PRD_REQ_NO
		                                                                 ORDER BY B.SEQ DESC
		                                                          )                                                        AS TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
                                             , NVL(D.CHM_MTL_PRD_YN,C.CHM_MTL_YN)                                          AS CHM_MTL_PRD_YN
                                             , NVL(D.TX_CLCD, C.RND_TX_CLCD)                                               AS TX_CLCD
                                             , E.DISP_PRD_SPR_CD                                                           AS DISP_PRD_SPR_CD
                                             , TO_CHAR(A.REG_DTM, 'YYYY-MM-DD HH24:MI:SS')                                  AS REQ_DTM
                                             , A.REGPSN_ID                                                                 AS REQ_ID
                                             , FN_RD_CHRPSN_ID(A.CO_CD, A.MNFR_NO, A.PRD_CLCD, '30')                       AS PURG_CHRPSN_ID
                                             , TO_CHAR(B.UPD_DTM,'YYYY-MM-DD HH24:MI:SS')                                 AS PROC_DTM
                                             , B.UPDPSN_ID                                                                 AS PROC_ID
		                                  FROM SSP_APP.TB_PR_NEW_PRD_REQ_PROC            A
		                                  LEFT JOIN SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS B
		                                    ON 0=0
		                                   AND B.CO_CD          = A.CO_CD
		                                   AND B.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
		                                  LEFT JOIN SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO  C
		                                    ON 0=0
		                                   AND C.CO_CD          = A.CO_CD
		                                   AND C.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
		                                  LEFT JOIN SSP_APP.TB_PR_MRO_PRD_INFO           D
		                                    ON 0=0
		                                   AND D.CO_CD  = A.CO_CD
		                                   AND D.PRD_ID = A.RND_REQ_PRD_ID
		                                  LEFT JOIN SSP_APP.TB_PR_DISP_BASIS E
		                                    ON 0=0
		                                   AND E.CO_CD    = A.CO_CD
		                                   AND E.PRD_CLCD = A.PRD_CLCD
		 ]]>
		                                 <if test="NEW_PRD_REQ_NO_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S1
                                            ON 0=0
                                           AND S1.SES_ID        = #{SES_ID}
                                           AND S1.INQ_COND_DTLS = #{INQ_COND_DTLS}
                                           AND S1.COL_ITM       = 'NEW_PRD_REQ_NO'
                                           AND S1.COND_DATA_VAL = A.NEW_PRD_REQ_NO
                                         </if>
                                         <if test="RND_REQ_PRD_ID_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S2
                                            ON 0=0
                                           AND S2.SES_ID                   = #{SES_ID}
                                           AND S2.INQ_COND_DTLS            = #{INQ_COND_DTLS}
                                           AND S2.COL_ITM                  = 'RND_REQ_PRD_ID'
                                           AND LPAD(S2.COND_DATA_VAL,18,0) = A.RND_REQ_PRD_ID
                                         </if>
                                         <if test="REQ_PRD_NM_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S3
                                            ON 0=0
                                           AND S3.SES_ID        = #{SES_ID}
                                           AND S3.INQ_COND_DTLS = #{INQ_COND_DTLS}
                                           AND S3.COL_ITM       = 'REQ_PRD_NM'
                                           AND S3.COND_DATA_VAL = A.REQ_PRD_NM
                                         </if>
                                         <if test="PRD_CLCD_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S4
                                            ON 0=0
                                           AND S4.SES_ID        = #{SES_ID}
                                           AND S4.INQ_COND_DTLS = #{INQ_COND_DTLS}
                                           AND S4.COL_ITM       = 'PRD_CLCD'
                                           AND S4.COND_DATA_VAL = A.PRD_CLCD
                                         </if>
        <![CDATA[
		                                 WHERE 0=0
		                                   AND A.CO_CD       = #{CO_CD}
		                                   AND A.NEW_PRD_REQ_NO NOT IN (SELECT NEW_PRD_REQ_NO FROM TB_RD_CPRTCP_PKG_LINE_PRPS_DTL)
        ]]>
                                        <if test="PURG_CHRPSN_ID != null and PURG_CHRPSN_ID != ''">
                                            <![CDATA[
                                           AND FN_RD_CHRPSN_ID(A.CO_CD, A.MNFR_NO, A.PRD_CLCD, '30') = #{PURG_CHRPSN_ID}
                                            ]]>
                                        </if>
                                        <if test="CHM_MTL_PRD_YN != null and CHM_MTL_PRD_YN != ''">
                                            <![CDATA[
                                           AND NVL(D.CHM_MTL_PRD_YN,C.CHM_MTL_YN) = #{CHM_MTL_PRD_YN}
                                            ]]>
                                        </if>
                                        <if test="PUB_ONLY_SPR_CD != null and PUB_ONLY_SPR_CD != ''">
                                            <![CDATA[
                                           AND A.PUB_ONLY_SPR_CD = #{PUB_ONLY_SPR_CD}
                                            ]]>
                                        </if>
                                        <if test="DISP_PRD_SPR_CD != null and DISP_PRD_SPR_CD != ''">
                                            <![CDATA[
                                           AND E.DISP_PRD_SPR_CD = #{DISP_PRD_SPR_CD}
                                            ]]>
                                        </if>
                                        <if test="PRD_PRPS_STATS_CD != null and PRD_PRPS_STATS_CD != ''">
                                            <![CDATA[
                                           AND A.PRD_PRPS_STATS_CD = #{PRD_PRPS_STATS_CD}
                                            ]]>
                                        </if>
                                        <if test="REQ_SBJ_CD != null and REQ_SBJ_CD != ''">
                                            <![CDATA[
                                           AND C.REQ_SBJ_CD = #{REQ_SBJ_CD}
                                            ]]>
                                        </if>
        <![CDATA[
		                               ) A1
		                         WHERE 0=0
        ]]>
                                <if test='(DATE_FR_DT != null and DATE_FR_DT != "") and (DATE_TO_DT != null and DATE_TO_DT != "")'>
                                     <if test="REQ_DT_FNL_PROC_DT_SPR == 'REQ_DT'">
                                     <![CDATA[
                                   AND A1.REQ_DTM BETWEEN TO_CHAR(TO_DATE(#{DATE_FR_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 00:00:00'
                                                      AND TO_CHAR(TO_DATE(#{DATE_TO_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 23:59:59'
                                     ]]>
                                	 </if>
                                     <if test="REQ_DT_FNL_PROC_DT_SPR == 'FNL_PROC_DT'">
                                     <![CDATA[
                                   AND A1.PROC_DTM BETWEEN TO_CHAR(TO_DATE(#{DATE_FR_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 00:00:00'
                                                       AND TO_CHAR(TO_DATE(#{DATE_TO_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 23:59:59'
                                     ]]>
                                	 </if>
                                </if>
        <![CDATA[
		                       ) A2
		                 WHERE 0=0
		                   AND A2.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER = 1
        ]]>
                        <choose>
                            <when test="(NEW_PRD_REQ_STATS_CD_LIST != null and NEW_PRD_REQ_STATS_CD_LIST.size() != 0) or (NEW_PRD_REQ_ESCALATION_CD != null and NEW_PRD_REQ_ESCALATION_CD != '')">
                                  	<trim prefixOverrides="OR" prefix="AND(" suffix=")">
		                                <if test="NEW_PRD_REQ_STATS_CD_LIST != null and NEW_PRD_REQ_STATS_CD_LIST.size() != 0">
		                                    (
				                            	A2.MALL_SPR_CD = '20'
				                            AND A2.NEW_PRD_REQ_STATS_CD IN
				                               <foreach collection="NEW_PRD_REQ_STATS_CD_LIST" item="NEW_PRD_REQ_STATS_CD" index="index" separator="," open="(" close=")">
				                                   #{NEW_PRD_REQ_STATS_CD}
				                               </foreach>
				                            )
				                        </if>
				                        <if test="NEW_PRD_REQ_ESCALATION_CD != null and NEW_PRD_REQ_ESCALATION_CD != ''">
				                        OR
				                           (
				                           	   A2.MALL_SPR_CD = '10'
				                           AND A2.NEW_PRD_REQ_STATS_CD = #{NEW_PRD_REQ_ESCALATION_CD}
				                           )
				                        </if>
			                        </trim>
		                        
                            </when>
                            <otherwise>
                            AND (
	                            	(
	                            		A2.MALL_SPR_CD = '20'
			                        AND A2.NEW_PRD_REQ_STATS_CD IN ('22','33','30','56','52','29','42','35','34') /* SSP-2294 */
	                            	)
	                            	OR
	                            	(
	                            		A2.MALL_SPR_CD = '10'
			                        AND A2.NEW_PRD_REQ_STATS_CD = '35'
	                            	)
                            	)
                            </otherwise>
                        </choose>
        <![CDATA[
		               ) Z1
		          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z2
                    ON 0=0
                   AND Z2.LANG_CD     = #{LANG_CD}
                   AND Z2.COM_CLSF_CD = 'NEW_PRD_REQ_STATS_CD'
                   AND Z2.COM_DTL_CD  = Z1.NEW_PRD_REQ_STATS_CD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z3
                    ON 0=0
                   AND Z3.LANG_CD     = #{LANG_CD}
                   AND Z3.COM_CLSF_CD = 'REQ_SBJ_CD'
                   AND Z3.COM_DTL_CD  = Z1.REQ_SBJ_CD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z4
                    ON 0=0
                   AND Z4.LANG_CD     = #{LANG_CD}
                   AND Z4.COM_CLSF_CD = 'PRD_PRPS_STATS_CD'
                   AND Z4.COM_DTL_CD  = Z1.PRD_PRPS_STATS_CD
                  LEFT JOIN SSP_APP.TB_PR_MNFR_INFO Z5
                    ON 0=0
                   AND Z5.CO_CD   = Z1.CO_CD
                   AND Z5.MNFR_NO = Z1.MNFR_NO
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z6
                    ON 0=0
                   AND Z6.LANG_CD    = #{LANG_CD}
                   AND Z6.COM_CLSF_CD = 'TX_CLCD'
                   AND Z6.COM_DTL_CD  = Z1.TX_CLCD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z7
                    ON 0=0
                   AND Z7.LANG_CD     = #{LANG_CD}
                   AND Z7.COM_CLSF_CD = 'PUB_ONLY_SPR_CD'
                   AND Z7.COM_DTL_CD  = Z1.PUB_ONLY_SPR_CD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z8
                    ON 0=0
                   AND Z8.LANG_CD     = #{LANG_CD}
                   AND Z8.COM_CLSF_CD = 'DISP_PRD_SPR_CD'
                   AND Z8.COM_DTL_CD  = Z1.DISP_PRD_SPR_CD
                  LEFT JOIN SSP_APP.TB_CO_MBR_OPRTR_INFO Z11
                    ON 0=0
                   AND Z11.CO_CD    = Z1.CO_CD
                   AND Z11.OPRTR_ID = Z1.PURG_CHRPSN_ID
                  LEFT JOIN SSP_APP.TB_CO_MBR_OPRTR_INFO Z12
                    ON 0=0
                   AND Z12.CO_CD    = Z1.CO_CD
                   AND Z12.OPRTR_ID = Z1.PROC_ID
                  LEFT JOIN TB_CC_MBR_BASIS Z13
                    ON 0=0
                   AND Z13.CO_CD  = Z1.CO_CD
                   AND Z13.MBR_ID = Z1.REQ_ID
                  LEFT JOIN TB_CC_DEPT_BASIS Z14
                    ON 0=0
                   AND Z14.CO_CD   = Z13.CO_CD 
                   AND Z14.DEPT_ID = Z13.DEPT_ID
                  LEFT JOIN TB_CC_BZPLC_BASIS Z15
                    ON 0=0
                   AND Z15.CO_CD    = Z14.CO_CD
                   AND Z15.BZPLC_ID = Z14.BZPLC_ID
                  LEFT JOIN TB_CC_OPR_UNIT_BASIS   Z16
                    ON 0=0
                   AND Z16.CO_CD       = Z14.CO_CD 
                   AND Z16.BZPLC_ID    = Z14.BZPLC_ID 
                   AND Z16.OPR_UNIT_ID = Z14.OPR_UNIT_ID
		       ) Z2
         WHERE 1=1
		 ]]>
<!--  2022-07-26 속도가 안나와서 SROT 기능 뺌.
        <choose>
            <when test='(SORT_COLUMN != null and SORT_COLUMN != "") and (SORT_TYPE != null and SORT_TYPE != "")'>
         ORDER BY Z2.${SORT_COLUMN} ${SORT_TYPE}
            </when>
            <otherwise>
         ORDER BY Z2.CO_CD
                , Z2.NEW_PRD_REQ_NO
            </otherwise>
        </choose>
-->
        OFFSET #{START_NUM} ROWS FETCH FIRST #{ROW_COUNT} ROWS ONLY
    </select>

	<select id="selectNewPrdReqLstCount" parameterType="HashMap" resultType="Integer">
		/* NewPrdReqLst.selectNewPrdReqLstCount 신규상품요청처리 카운트 조회 */
		<![CDATA[
        SELECT COUNT(1)
		  FROM (
		        SELECT Z1.CO_CD	                         AS CO_CD                    /*회사코드*/
                     , Z1.NEW_PRD_REQ_NO	             AS NEW_PRD_REQ_NO           /*신규상품요청번호*/
                     , Z1.NEW_PRD_REQ_STATS_CD           AS NEW_PRD_REQ_STATS_CD     /*처리상태*/
                     , Z2.COM_USR_DEFN_NM_2              AS NEW_PRD_REQ_STATS_CD_NM  /*처리상태명*/
                     , Z1.REQ_SBJ_CD	                 AS REQ_SBJ_CD               /*요청주체코드*/
                     , Z3.COM_DTL_CD_NM                  AS REQ_SBJ_NM               /*요청주체명*/
                     , Z1.PRD_PRPS_STATS_CD              AS PRD_PRPS_STATS_CD        /*상품제안상태코드*/
                     , Z4.COM_DTL_CD_NM                  AS PRD_PRPS_STATS_NM        /*상품제안상태명*/
                     , TO_NUMBER(Z1.RND_REQ_PRD_ID)      AS RND_REQ_PRD_ID           /*RND상품ID*/
                     , Z1.REQ_PRD_NM                     AS REQ_PRD_NM               /*요청상품명*/
                     , Z1.PRD_CLCD                       AS PRD_CLCD                 /*카테고리ID*/
                     , Z1.PRD_CLCD_NM                    AS PRD_CLCD_NM              /*카테고리*/
                     , FN_RD_ATTR_VAL_LIST(Z1.CO_CD, Z1.NEW_PRD_REQ_NO, Z1.PRD_CLCD)          AS NEW_PRD_REQ_PRVL_LIST    /*대표규격*/
                     , Z1.MNFR_NO                        AS MNFR_NO                  /*제조사번호*/
                     , Z5.MRO_MNFR_NM                    AS MRO_MNFR_NM              /*제조사명*/
                     , Z1.BASIS_UNIT_QTY                 AS BASIS_UNIT_QTY           /*기본단위수량*/
                     , Z1.BASIS_UNIT_CD                  AS BASIS_UNIT_CD            /*기본단위코드*/
                     , Z1.SELL_UNIT_CD                   AS SELL_UNIT_CD             /*판매단위코드*/
                     , Z1.CHM_MTL_PRD_YN                 AS CHM_MTL_PRD_YN           /*화학물질여부*/
                     , Z1.TX_CLCD                        AS TX_CLCD                  /*세금분류코드*/
                     , Z6.COM_DTL_CD_NM                  AS TX_CLCD_NM               /*세금분류코드명*/
                     , Z1.PUB_ONLY_SPR_CD                AS PUB_ONLY_SPR_CD          /*공용전용구분*/
                     , Z7.COM_DTL_CD_NM                  AS PUB_ONLY_SPR_NM          /*공용전용구분명*/
                     , Z1.DISP_PRD_SPR_CD                AS DISP_PRD_SPR_CD          /*전시상품*/
                     , Z8.COM_DTL_CD_NM                  AS DISP_PRD_SPR_NM          /*전시상품구분명*/
                     , Z1.REQ_DTM                        AS REQ_DTM                  /*요청일*/
                     , Z1.REQ_ID                         AS REQ_ID                   /*요청자*/
                     , FN_CC_GET_MBR_NM(Z1.CO_CD, Z1.REQ_ID)   AS REQ_NM                   /*요청자*/
                     , Z1.PURG_CHRPSN_ID                 AS PURG_CHRPSN_ID           /*구매담당자ID*/
                     , Z11.OPRTR_NM                      AS PURG_CHRPSN_NM           /*구매담당자명*/
                     , Z1.PROC_DTM                       AS PROC_DTM                 /*처리일*/
                     , Z1.PROC_ID                        AS PROC_ID                  /*처리자*/
                     , FN_CC_GET_MBR_NM(Z1.CO_CD, Z1.REQ_ID)   AS PROC_NM                  /*처리자명*/
		          FROM (
		                SELECT A2.CO_CD
                             , A2.NEW_PRD_REQ_NO
                             , A2.REQ_PRD_NM
                             , A2.PRD_CLCD
                             , A2.PUB_ONLY_SPR_CD
                             , A2.BASIS_UNIT_CD
                             , A2.BASIS_UNIT_QTY
                             , A2.SELL_UNIT_CD
                             , A2.ORGPLC_CTRY_CD
                             , A2.MNFR_NO
                             , A2.MRO_REQ_NO
                             , A2.MRO_PROC_STATS_CD
                             , A2.MRO_DUP_PRD_ID
                             , A2.MRO_PRD_ID
                             , A2.EXCEPT_END_RSN
                             , A2.PRD_REG_DIS_TP_CD
                             , A2.REG_DIS_RSN
                             , A2.PRD_PRPS_SPR_CD
                             , A2.PRD_PRPS_STATS_CD
                             , A2.ALT_PRPS_RSN
                             , A2.CUST_RJT_RSN
                             , A2.PRPS_PRD_ID
                             , A2.TRSF_RSN
                             , A2.MALL_SPR_CD
                             , A2.ESTM_REQ_NO
                             , A2.UPD_RSN
                             , A2.RND_REQ_PRD_ID
                             , A2.REGPSN_ID
                             , A2.REG_DTM
                             , A2.UPDPSN_ID
                             , A2.UPD_DTM
                             , A2.REQ_SBJ_CD
                             , A2.NEW_PRD_REQ_STATS_CD
                             , A2.PRD_CLCD_NM
                             , A2.CHM_MTL_PRD_YN
                             , A2.TX_CLCD
                             , A2.DISP_PRD_SPR_CD
                             , A2.REQ_DTM
                             , A2.REQ_ID
                             , A2.PURG_CHRPSN_ID
                             , A2.PROC_DTM
                             , A2.PROC_ID
                             , A2.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
		                  FROM (
		                        SELECT A1.CO_CD                                                                             AS CO_CD
                                     , A1.NEW_PRD_REQ_NO                                                                    AS NEW_PRD_REQ_NO
                                     , A1.REQ_PRD_NM                                                                        AS REQ_PRD_NM
                                     , A1.PRD_CLCD                                                                          AS PRD_CLCD
                                     , A1.PUB_ONLY_SPR_CD                                                                   AS PUB_ONLY_SPR_CD
                                     , A1.BASIS_UNIT_CD                                                                     AS BASIS_UNIT_CD
                                     , A1.BASIS_UNIT_QTY                                                                    AS BASIS_UNIT_QTY
                                     , A1.SELL_UNIT_CD                                                                      AS SELL_UNIT_CD
                                     , A1.ORGPLC_CTRY_CD                                                                    AS ORGPLC_CTRY_CD
                                     , A1.MNFR_NO                                                                           AS MNFR_NO
                                     , A1.MRO_REQ_NO                                                                        AS MRO_REQ_NO
                                     , A1.MRO_PROC_STATS_CD                                                                 AS MRO_PROC_STATS_CD
                                     , A1.MRO_DUP_PRD_ID                                                                    AS MRO_DUP_PRD_ID
                                     , A1.MRO_PRD_ID                                                                        AS MRO_PRD_ID
                                     , A1.EXCEPT_END_RSN                                                                    AS EXCEPT_END_RSN
                                     , A1.PRD_REG_DIS_TP_CD                                                                 AS PRD_REG_DIS_TP_CD
                                     , A1.REG_DIS_RSN                                                                       AS REG_DIS_RSN
                                     , A1.PRD_PRPS_SPR_CD                                                                   AS PRD_PRPS_SPR_CD
                                     , A1.PRD_PRPS_STATS_CD                                                                 AS PRD_PRPS_STATS_CD
                                     , A1.ALT_PRPS_RSN                                                                      AS ALT_PRPS_RSN
                                     , A1.CUST_RJT_RSN                                                                      AS CUST_RJT_RSN
                                     , A1.PRPS_PRD_ID                                                                       AS PRPS_PRD_ID
                                     , A1.TRSF_RSN                                                                          AS TRSF_RSN
                                     , A1.MALL_SPR_CD                                                                       AS MALL_SPR_CD
                                     , A1.ESTM_REQ_NO                                                                       AS ESTM_REQ_NO
                                     , A1.UPD_RSN                                                                           AS UPD_RSN
                                     
                                /*, A1.RND_REQ_PRD_ID                                                                    AS RND_REQ_PRD_ID*/
                                     , DECODE(A1.NEW_PRD_REQ_STATS_CD, '30', A1.PRPS_PRD_ID
                                                                     , '56', A1.PRPS_PRD_ID      /*MRO_DUP_PRD_ID*/
                                                                           , A1.RND_REQ_PRD_ID                           )  AS RND_REQ_PRD_ID
                                     
                                     , A1.REGPSN_ID                                                                         AS REGPSN_ID
                                     , A1.REG_DTM                                                                           AS REG_DTM
                                     , A1.UPDPSN_ID                                                                         AS UPDPSN_ID
                                     , A1.UPD_DTM                                                                           AS UPD_DTM
                                     , A1.REQ_SBJ_CD                                                                        AS REQ_SBJ_CD
                                     , A1.NEW_PRD_REQ_STATS_CD                                                              AS NEW_PRD_REQ_STATS_CD
                                     , A1.PRD_CLCD_NM                                                                       AS PRD_CLCD_NM
                                     , A1.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER                                                AS TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
                                     , A1.CHM_MTL_PRD_YN                                                                    AS CHM_MTL_PRD_YN
                                     , A1.TX_CLCD                                                                           AS TX_CLCD
                                     , A1.DISP_PRD_SPR_CD                                                                   AS DISP_PRD_SPR_CD
                                     , A1.REQ_DTM                                                                           AS REQ_DTM
                                     , A1.REQ_ID                                                                            AS REQ_ID
                                     , A1.PURG_CHRPSN_ID                                                                    AS PURG_CHRPSN_ID
                                     , A1.PROC_DTM                                                                          AS PROC_DTM
                                     , A1.PROC_ID                                                                           AS PROC_ID
		                          FROM (
		                                SELECT /*+ INDEX_USE(A TB_PR_NEW_PRD_REQ_PROC_PK) */
		                                       A.CO_CD                                                                     AS CO_CD                       /*회사코드*/
                                             , A.NEW_PRD_REQ_NO                                                            AS NEW_PRD_REQ_NO              /*신규상품요청번호*/
                                             , A.REQ_PRD_NM                                                                AS REQ_PRD_NM                  /*요청상품명*/
                                             , A.PRD_CLCD                                                                  AS PRD_CLCD                    /*상품분류코드*/
                                             , A.PUB_ONLY_SPR_CD                                                           AS PUB_ONLY_SPR_CD             /*공용전용구분코드*/
                                             , A.BASIS_UNIT_CD                                                             AS BASIS_UNIT_CD               /*기본단위코드*/
                                             , A.BASIS_UNIT_QTY                                                            AS BASIS_UNIT_QTY              /*기본단위수량*/
                                             , A.SELL_UNIT_CD                                                              AS SELL_UNIT_CD                /*판매단위코드*/
                                             , A.ORGPLC_CTRY_CD                                                            AS ORGPLC_CTRY_CD              /*원산지국가코드*/
                                             , A.MNFR_NO                                                                   AS MNFR_NO                     /*제조사번호*/
                                             , A.MRO_REQ_NO                                                                AS MRO_REQ_NO                  /*MRO요청번호*/
                                             , A.MRO_PROC_STATS_CD                                                         AS MRO_PROC_STATS_CD           /*MRO처리상태코드*/
                                             , TO_CHAR(TO_NUMBER(A.MRO_DUP_PRD_ID))                                        AS MRO_DUP_PRD_ID              /*MRO중복상품ID*/
                                             , A.MRO_PRD_ID                                                                AS MRO_PRD_ID                  /*MRO상품ID*/
                                             , A.EXCEPT_END_RSN                                                            AS EXCEPT_END_RSN              /*예외종료사유*/
                                             , A.PRD_REG_DIS_TP_CD                                                         AS PRD_REG_DIS_TP_CD           /*상품등록불가유형코드*/
                                             , A.REG_DIS_RSN                                                               AS REG_DIS_RSN                 /*등록불가사유*/
                                             , A.PRD_PRPS_SPR_CD                                                           AS PRD_PRPS_SPR_CD             /*상품제안구분코드*/
                                             , A.PRD_PRPS_STATS_CD                                                         AS PRD_PRPS_STATS_CD           /*상품제안상태코드*/
                                             , A.ALT_PRPS_RSN                                                              AS ALT_PRPS_RSN                /*대체제안사유*/
                                             , A.CUST_RJT_RSN                                                              AS CUST_RJT_RSN                /*고객거부사유*/
                                             , TO_CHAR(TO_NUMBER(A.PRPS_PRD_ID))                                           AS PRPS_PRD_ID                 /*제안상품ID*/
                                             , A.TRSF_RSN                                                                  AS TRSF_RSN                    /*이관사유*/
                                             , A.MALL_SPR_CD                                                               AS MALL_SPR_CD                 /*몰구분코드*/
                                             , A.ESTM_REQ_NO                                                               AS ESTM_REQ_NO                 /*견적요청번호*/
                                             , A.UPD_RSN                                                                   AS UPD_RSN                     /*수정사유*/
                                             , TO_CHAR(TO_NUMBER(A.RND_REQ_PRD_ID))                                        AS RND_REQ_PRD_ID              /*RND요청상품ID*/
                                             , B.REGPSN_ID                                                                 AS REGPSN_ID                   /*등록자ID*/
                                             , A.REG_DTM                                                                   AS REG_DTM                     /*등록일시*/
                                             , A.UPDPSN_ID                                                                 AS UPDPSN_ID                   /*수정자ID*/
                                             , A.UPD_DTM                                                                   AS UPD_DTM                     /*수정일시*/
                                             , C.REQ_SBJ_CD                                                                AS REQ_SBJ_CD
                                             , B.NEW_PRD_REQ_STATS_CD                                                      AS NEW_PRD_REQ_STATS_CD
                                             , (
                                                SELECT SSP_APP.FN_PR_FULL_CLSF_NM
                                                       (
                                                         A.CO_CD
                                                       , A.PRD_CLCD
                                                       )
                                                  FROM DUAL
                                               )                                                                           AS PRD_CLCD_NM
                                             , ROW_NUMBER() OVER (
                                                                  PARTITION BY A.CO_CD
		                                                                     , A.NEW_PRD_REQ_NO
		                                                                 ORDER BY B.SEQ DESC
		                                                         )                                                         AS TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
                                             , NVL(D.CHM_MTL_PRD_YN,C.CHM_MTL_YN)                                          AS CHM_MTL_PRD_YN
                                             , NVL(D.TX_CLCD, C.RND_TX_CLCD)                                               AS TX_CLCD
                                             , E.DISP_PRD_SPR_CD                                                           AS DISP_PRD_SPR_CD
                                             , TO_CHAR(A.REG_DTM,'YYYY-MM-DD HH24:MI:SS')                                  AS REQ_DTM
                                             , A.REGPSN_ID                                                                 AS REQ_ID
                                             , FN_RD_CHRPSN_ID(A.CO_CD, A.MNFR_NO, A.PRD_CLCD, '30')                       AS PURG_CHRPSN_ID
                                             , TO_CHAR(B.UPD_DTM,'YYYY-MM-DD HH24:MI:SS')                                  AS PROC_DTM
                                             , B.UPDPSN_ID                                                                 AS PROC_ID
		                                  FROM SSP_APP.TB_PR_NEW_PRD_REQ_PROC            A
		                                  LEFT JOIN SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS B
		                                    ON 0=0
		                                   AND B.CO_CD          = A.CO_CD
		                                   AND B.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
		                                  LEFT JOIN SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO  C
		                                    ON 0=0
		                                   AND C.CO_CD          = A.CO_CD
		                                   AND C.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
		                                  LEFT JOIN SSP_APP.TB_PR_MRO_PRD_INFO           D
		                                    ON 0=0
		                                   AND D.CO_CD  = A.CO_CD
		                                   AND D.PRD_ID = A.RND_REQ_PRD_ID
		                                  LEFT JOIN SSP_APP.TB_PR_DISP_BASIS E
		                                    ON 0=0
		                                   AND E.CO_CD    = A.CO_CD
		                                   AND E.PRD_CLCD = A.PRD_CLCD
		 ]]>
		                                 <if test="NEW_PRD_REQ_NO_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S1
                                            ON 0=0
                                           AND S1.SES_ID        = #{SES_ID}
                                           AND S1.INQ_COND_DTLS = #{INQ_COND_DTLS}
                                           AND S1.COL_ITM       = 'NEW_PRD_REQ_NO'
                                           AND S1.COND_DATA_VAL = A.NEW_PRD_REQ_NO
                                         </if>
                                         <if test="RND_REQ_PRD_ID_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S2
                                            ON 0=0
                                           AND S2.SES_ID                   = #{SES_ID}
                                           AND S2.INQ_COND_DTLS            = #{INQ_COND_DTLS}
                                           AND S2.COL_ITM                  = 'RND_REQ_PRD_ID'
                                           AND LPAD(S2.COND_DATA_VAL,18,0) = A.RND_REQ_PRD_ID
                                         </if>
                                         <if test="REQ_PRD_NM_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S3
                                            ON 0=0
                                           AND S3.SES_ID        = #{SES_ID}
                                           AND S3.INQ_COND_DTLS = #{INQ_COND_DTLS}
                                           AND S3.COL_ITM       = 'REQ_PRD_NM'
                                           AND S3.COND_DATA_VAL = A.REQ_PRD_NM
                                         </if>
                                         <if test="PRD_CLCD_CNT > 0">
                                         INNER JOIN SSP_APP.TB_OD_ODR_INQ_TGT_DTLS S4
                                            ON 0=0
                                           AND S4.SES_ID        = #{SES_ID}
                                           AND S4.INQ_COND_DTLS = #{INQ_COND_DTLS}
                                           AND S4.COL_ITM       = 'PRD_CLCD'
                                           AND S4.COND_DATA_VAL = A.PRD_CLCD
                                         </if>
        <![CDATA[
		                                 WHERE 0=0
		                                   AND A.CO_CD       = #{CO_CD}
		                                   AND A.MALL_SPR_CD = '20'
        ]]>
                                        <if test="PURG_CHRPSN_ID != null and PURG_CHRPSN_ID != ''">
                                            <![CDATA[
                                           AND FN_RD_CHRPSN_ID(A.CO_CD, A.MNFR_NO, A.PRD_CLCD, '30') = #{PURG_CHRPSN_ID}
                                            ]]>
                                        </if>
                                        <if test="CHM_MTL_PRD_YN != null and CHM_MTL_PRD_YN != ''">
                                            <![CDATA[
                                           AND NVL(D.CHM_MTL_PRD_YN,C.CHM_MTL_YN) = #{CHM_MTL_PRD_YN}
                                            ]]>
                                        </if>
                                        <if test="PUB_ONLY_SPR_CD != null and PUB_ONLY_SPR_CD != ''">
                                            <![CDATA[
                                           AND A.PUB_ONLY_SPR_CD = #{PUB_ONLY_SPR_CD}
                                            ]]>
                                        </if>
                                        <if test="DISP_PRD_SPR_CD != null and DISP_PRD_SPR_CD != ''">
                                            <![CDATA[
                                           AND E.DISP_PRD_SPR_CD = #{DISP_PRD_SPR_CD}
                                            ]]>
                                        </if>
                                        <if test="PRD_PRPS_STATS_CD != null and PRD_PRPS_STATS_CD != ''">
                                            <![CDATA[
                                           AND A.PRD_PRPS_STATS_CD = #{PRD_PRPS_STATS_CD}
                                            ]]>
                                        </if>
                                        <if test="REQ_SBJ_CD != null and REQ_SBJ_CD != ''">
                                            <![CDATA[
                                           AND C.REQ_SBJ_CD = #{REQ_SBJ_CD}
                                            ]]>
                                        </if>
        <![CDATA[
		                               ) A1
		                         WHERE 0=0
        ]]>
                                <if test='(DATE_FR_DT != null and DATE_FR_DT != "") and (DATE_TO_DT != null and DATE_TO_DT != "")'>
                                     <if test="REQ_DT_FNL_PROC_DT_SPR == 'REQ_DT'">
                                     <![CDATA[
                                   AND A1.REQ_DTM BETWEEN TO_CHAR(TO_DATE(#{DATE_FR_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 00:00:00'
                                                      AND TO_CHAR(TO_DATE(#{DATE_TO_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 23:59:59'
                                     ]]>
                                	 </if>
                                     <if test="REQ_DT_FNL_PROC_DT_SPR == 'FNL_PROC_DT'">
                                     <![CDATA[
                                   AND A1.PROC_DTM BETWEEN TO_CHAR(TO_DATE(#{DATE_FR_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 00:00:00'
                                                       AND TO_CHAR(TO_DATE(#{DATE_TO_DT},'YYYYMMDD'),'YYYY-MM-DD') || ' 23:59:59'
                                     ]]>
                                	 </if>
                                </if>
        <![CDATA[
		                       ) A2
		                 WHERE 0=0
		                   AND A2.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER = 1
        ]]>
                        <choose>
                            <when test="(NEW_PRD_REQ_STATS_CD_LIST != null and NEW_PRD_REQ_STATS_CD_LIST.size() != 0) or (NEW_PRD_REQ_ESCALATION_CD != null and NEW_PRD_REQ_ESCALATION_CD != '')">
                                  <trim prefixOverrides="OR" prefix="AND(" suffix=")">
		                                <if test="NEW_PRD_REQ_STATS_CD_LIST != null and NEW_PRD_REQ_STATS_CD_LIST.size() != 0">
		                                    (
				                            	A2.MALL_SPR_CD = '20'
				                            AND A2.NEW_PRD_REQ_STATS_CD IN
				                               <foreach collection="NEW_PRD_REQ_STATS_CD_LIST" item="NEW_PRD_REQ_STATS_CD" index="index" separator="," open="(" close=")">
				                                   #{NEW_PRD_REQ_STATS_CD}
				                               </foreach>
				                            )
				                        </if>
				                        <if test="NEW_PRD_REQ_ESCALATION_CD != null and NEW_PRD_REQ_ESCALATION_CD != ''">
				                        OR
				                           (
				                           	   A2.MALL_SPR_CD = '10'
				                           AND A2.NEW_PRD_REQ_STATS_CD = #{NEW_PRD_REQ_ESCALATION_CD}
				                           )
				                        </if>
			                        </trim>
                            </when>
                            <otherwise>
                            AND (
	                            	(
	                            		A2.MALL_SPR_CD = '20'
			                        AND A2.NEW_PRD_REQ_STATS_CD IN ('22','33','30','56','52','29','42','35','34') /* SSP-2294 */
	                            	)
	                            	OR
	                            	(
	                            		A2.MALL_SPR_CD = '10'
			                        AND A2.NEW_PRD_REQ_STATS_CD = '35'
	                            	)
                            	)
                            </otherwise>
                        </choose>
        <![CDATA[
		               ) Z1
		          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z2
                    ON 0=0
                   AND Z2.LANG_CD     = #{LANG_CD}
                   AND Z2.COM_CLSF_CD = 'NEW_PRD_REQ_STATS_CD'
                   AND Z2.COM_DTL_CD  = Z1.NEW_PRD_REQ_STATS_CD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z3
                    ON 0=0
                   AND Z3.LANG_CD     = #{LANG_CD}
                   AND Z3.COM_CLSF_CD = 'REQ_SBJ_CD'
                   AND Z3.COM_DTL_CD  = Z1.REQ_SBJ_CD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z4
                    ON 0=0
                   AND Z4.LANG_CD     = #{LANG_CD}
                   AND Z4.COM_CLSF_CD = 'PRD_PRPS_STATS_CD'
                   AND Z4.COM_DTL_CD  = Z1.PRD_PRPS_STATS_CD
                  LEFT JOIN SSP_APP.TB_PR_MNFR_INFO Z5
                    ON 0=0
                   AND Z5.CO_CD   = Z1.CO_CD
                   AND Z5.MNFR_NO = Z1.MNFR_NO
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z6
                    ON 0=0
                   AND Z6.LANG_CD    = #{LANG_CD}
                   AND Z6.COM_CLSF_CD = 'TX_CLCD'
                   AND Z6.COM_DTL_CD  = Z1.TX_CLCD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z7
                    ON 0=0
                   AND Z7.LANG_CD     = #{LANG_CD}
                   AND Z7.COM_CLSF_CD = 'PUB_ONLY_SPR_CD'
                   AND Z7.COM_DTL_CD  = Z1.PUB_ONLY_SPR_CD
                  LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z8
                    ON 0=0
                   AND Z8.LANG_CD     = #{LANG_CD}
                   AND Z8.COM_CLSF_CD = 'DISP_PRD_SPR_CD'
                   AND Z8.COM_DTL_CD  = Z1.DISP_PRD_SPR_CD
                  LEFT JOIN SSP_APP.TB_CO_MBR_OPRTR_INFO Z11
                    ON 0=0
                   AND Z11.CO_CD    = Z1.CO_CD
                   AND Z11.OPRTR_ID = Z1.PURG_CHRPSN_ID
                  LEFT JOIN SSP_APP.TB_CO_MBR_OPRTR_INFO Z12
                    ON 0=0
                   AND Z12.CO_CD    = Z1.CO_CD
                   AND Z12.OPRTR_ID = Z1.PROC_ID
                  LEFT JOIN TB_CC_MBR_BASIS Z13
                    ON 0=0
                   AND Z13.CO_CD  = Z1.CO_CD
                   AND Z13.MBR_ID = Z1.REQ_ID
                  LEFT JOIN TB_CC_DEPT_BASIS Z14
                    ON 0=0
                   AND Z14.CO_CD   = Z13.CO_CD 
                   AND Z14.DEPT_ID = Z13.DEPT_ID
                  LEFT JOIN TB_CC_BZPLC_BASIS Z15
                    ON 0=0
                   AND Z15.CO_CD    = Z14.CO_CD
                   AND Z15.BZPLC_ID = Z14.BZPLC_ID
                  LEFT JOIN TB_CC_OPR_UNIT_BASIS   Z16
                    ON 0=0
                   AND Z16.CO_CD       = Z14.CO_CD 
                   AND Z16.BZPLC_ID    = Z14.BZPLC_ID 
                   AND Z16.OPR_UNIT_ID = Z14.OPR_UNIT_ID
		       ) Z2
         WHERE 1=1
		 ]]>
    </select>

	<resultMap id="clobMap" type="HashMap">
        <result property="CO_CD"                                  column="CO_CD"                                  />
        <result property="NEW_PRD_REQ_NO"                         column="NEW_PRD_REQ_NO"                         />
        <result property="NEW_PRD_REQ_STATS_CD"                   column="NEW_PRD_REQ_STATS_CD"                   />
        <result property="NEW_PRD_REQ_STATS_NM"                   column="NEW_PRD_REQ_STATS_NM"                   />
        <result property="PUB_ONLY_SPR_CD"                        column="PUB_ONLY_SPR_CD"                        />
        <result property="PUB_ONLY_SPR_NM"                        column="PUB_ONLY_SPR_NM"                        />
        <result property="RND_REQ_PRD_ID"                         column="RND_REQ_PRD_ID"                         />
        <result property="REQ_PRD_NM"                             column="REQ_PRD_NM"                             />
        <result property="MNFR_NO"                                column="MNFR_NO"                                />
        <result property="MRO_MNFR_NM"                            column="MRO_MNFR_NM"                            />
        <result property="BASIS_UNIT_QTY"                         column="BASIS_UNIT_QTY"                         />
        <result property="BASIS_UNIT_CD"                          column="BASIS_UNIT_CD"                          />
        <result property="SELL_UNIT_CD"                           column="SELL_UNIT_CD"                           />
        <result property="ORGPLC_CTRY_CD"                         column="ORGPLC_CTRY_CD"                         />
        <result property="CTRY_NM"                                column="CTRY_NM"                                />
        <result property="TX_CLCD"                                column="TX_CLCD"                                />
        <result property="TX_CLCD_NM"                             column="TX_CLCD_NM"                             />
        <result property="RND_HUB_HNL_DIS_TP_CD"                  column="RND_HUB_HNL_DIS_TP_CD"                  />
        <result property="RND_HUB_HNL_DIS_TP_NM"                  column="RND_HUB_HNL_DIS_TP_NM"                  />
        <result property="CHM_MTL_YN"                             column="CHM_MTL_YN"                             />
        <result property="REQ_SBJ_CD"                             column="REQ_SBJ_CD"                             />
        <result property="REQ_SBJ_NM"                             column="REQ_SBJ_NM"                             />
        <result property="REGPSN_ID"                              column="REGPSN_ID"                              />
        <result property="REGPSN_NM"                              column="REGPSN_NM"                              />
        <result property="REG_DTM"                                column="REG_DTM"                                />
        <result property="PRD_CLCD"                               column="PRD_CLCD"                               />
        <result property="OLD_PRD_CLCD"                           column="OLD_PRD_CLCD"                           />
        <result property="PRD_CLSF_NM"                            column="PRD_CLSF_NM"                            />
        <result property="NEW_PRD_REQ_PRVL_LIST"                  column="NEW_PRD_REQ_PRVL_LIST"                  />
        <result property="BRND_NM"                                column="BRND_NM"                                />
        <result property="HASH_TAG"                               column="HASH_TAG"                               />
        <result property="BG_SEQ"                                 column="BG_SEQ"                                 />
        <result property="BG_NM"                                  column="BG_NM"                                  />
        <result property="SBI_DOC_REG_ID"                         column="SBI_DOC_REG_ID"                         />
        <result property="BG_APLY_STR_DTM"                        column="BG_APLY_STR_DTM"                        />
        <result property="BG_APLY_END_DTM"                        column="BG_APLY_END_DTM"                        />
        <result property="DISP_PRD_SPR_CD"                        column="DISP_PRD_SPR_CD"                        />
        <result property="DISP_PRD_SPR_NM"                        column="DISP_PRD_SPR_NM"                        />
        <result property="PPI_DOC_REG_ID"                         column="PPI_DOC_REG_ID"                         />
        <result property="PRD_DTL_DESC"                           column="PRD_DTL_DESC"                           jdbcType="CLOB" javaType="java.lang.String"/>
        <result property="HPE_SELL_UPRC"                          column="HPE_SELL_UPRC"                          />
        <result property="DSTRB_STD_PRC"                          column="DSTRB_STD_PRC"                          />
        <result property="NOTI_ITM_ID"                            column="NOTI_ITM_ID"                            />
        <result property="PROC_ID"                                column="PROC_ID"                                />
        <result property="PROC_DTM"                               column="PROC_DTM"                               />
        <result property="TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER"     column="TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER"     />
        <result property="INVN_API_USE_YN" 						  column="INVN_API_USE_YN" 						  />
        <result property="CPRTCP_ID" 							  column="CPRTCP_ID" 							  />
        <result property="CPRTCP_NM" 							  column="CPRTCP_NM" 							  />
        <result property="CPRTCP_PRD_ID" 						  column="CPRTCP_PRD_ID" 						  />
 	</resultMap>

    <select id="selectPrdRegOcorpInq" parameterType="HashMap" resultMap="clobMap">
        <![CDATA[
        /* NewPrdReqLst.selectPrdRegOcorpInq R&D상품등록(자사) 조회 */
        SELECT Z1.CO_CD                                                                    /* 회사코드				*/
             , Z1.NEW_PRD_REQ_NO                                                           /* 신규상품요청번호		*/
             , Z1.NEW_PRD_REQ_STATS_CD                                                     /* 신규상품요청상태코드	*/
             , NVL(Z2.COM_USR_DEFN_NM_2,Z2.COM_USR_DEFN_NM_2) 	AS NEW_PRD_REQ_STATS_NM    /* 신규상품요청상태명		*/
             , Z1.PUB_ONLY_SPR_CD                                                          /* 공용전용구분코드		*/
             , Z3.COM_DTL_CD_NM                           		AS PUB_ONLY_SPR_NM         /* 공용전용구분명		*/
             , TO_NUMBER(Z1.RND_REQ_PRD_ID)               		AS RND_REQ_PRD_ID          /* RND요청상품ID		*/
             , Z1.REQ_PRD_NM                                                               /* 요청상품명			*/
             , Z1.MNFR_NO                                                                  /* 제조사번호			*/
             , Z4.MRO_MNFR_NM                                                              /* 제조사명				*/
             , Z1.BASIS_UNIT_QTY                                                           /* 기본단위수량			*/
             , Z1.BASIS_UNIT_CD                                                            /* 기본단위코드			*/
             , CASE WHEN Z1.BASIS_UNIT_QTY > 1
                     AND Z1.SELL_UNIT_CD IS NOT NULL
                     AND Z1.BASIS_UNIT_CD != Z1.SELL_UNIT_CD
                    THEN Z1.SELL_UNIT_CD
               END                                        		AS SELL_UNIT_CD            /* 판매단위코드			*/
             , Z1.ORGPLC_CTRY_CD                                                           /* 원산지국가코드		*/
             , Z5.CTRY_NM                                                                  /* 원산지국가명			*/
             , Z1.TX_CLCD                                                                  /* 세금분류코드			*/
             , Z6.COM_DTL_CD_NM                           		AS TX_CLCD_NM              /* 세금분류코드명		*/
             , Z1.RND_HUB_HNL_DIS_TP_CD                                                    /* RND허브취급불가유형코드	*/
             , Z10.COM_DTL_CD_NM                          		AS RND_HUB_HNL_DIS_TP_NM   /* RND허브취급불가유형명	*/
             , Z1.CHM_MTL_YN                                                               /* 화학물질여부			*/
             , Z1.REQ_SBJ_CD                                                               /* 요청주체코드			*/
             , Z11.COM_DTL_CD_NM                          		AS REQ_SBJ_NM              /* 요청주체명			*/
             , Z1.REGPSN_ID                                                                /* 등록자ID			*/
             , Z7.OPRTR_NM                                		AS REGPSN_NM               /* 등록자				*/
             , Z1.REG_DTM                                                                  /* 등록일시				*/
             , Z1.PRD_CLCD                                                                 /* 상품분류코드			*/
             , Z1.PRD_CLCD                                		AS OLD_PRD_CLCD            /* 기존상품분류코드		*/
             , FN_PR_FULL_CLSF_NM(Z1.CO_CD, Z1.PRD_CLCD)  		AS PRD_CLSF_NM             /* 상품분류명			*/
             , FN_RD_ATTR_VAL_LIST(Z1.CO_CD, Z1.NEW_PRD_REQ_NO, Z1.PRD_CLCD)             AS NEW_PRD_REQ_PRVL_LIST                         /* 대표규격*/
             , Z1.BRND_NM                                                                  /* 브랜드명				*/
             , Z1.HASH_TAG                                                                 /* 해시태그				*/
             , Z1.BG_SEQ                                                                   /* 배지순번				*/
             , Z1.BG_NM                                                                    /* 배지명				*/
             , Z1.SBI_DOC_REG_ID                                                           /* 배지문서등록ID		*/
             , Z1.BG_APLY_STR_DTM                                                          /* 배지적용시작일시		*/
             , Z1.BG_APLY_END_DTM                                                          /* 배지적용종료일시		*/
             , Z1.DISP_PRD_SPR_CD                                                          /* 전시상품구분코드		*/
             , Z9.COM_DTL_CD_NM                           		AS DISP_PRD_SPR_NM         /* 전시상품구분명		*/
             , Z1.PPI_DOC_REG_ID                                                           /* 상품문서등록ID		*/
             , Z1.PRD_DTL_DESC                                                             /* 상품상세설명			*/
             , Z1.HPE_SELL_UPRC                                                            /* 희망판매가격			*/
             , Z1.DSTRB_STD_PRC                                                            /* 유통판매가격			*/
             , Z1.NOTI_ITM_ID                                                              /* 고시ITEM ID			*/
             , CASE WHEN Z1.NOTI_ITM_ID IS NOT NULL
                    THEN '(' || Z1.NOTI_ITM_ID || ') ' ||
                          (
                           SELECT B.NOTI_ITM_NM
                             FROM SSP_APP.TB_PR_NOTI_ITM_BASIS B
                            WHERE B.CO_CD       = Z1.CO_CD
                              AND B.NOTI_ITM_ID = Z1.NOTI_ITM_ID
                           )
                    ELSE ''
               END                                        		AS NOTI_ITM_NM             /* 고시ITEM NM			*/
             , Z1.PROC_ID                                                                  /* 처리자ID			*/
             , Z1.PROC_DTM                                                                 /* 처리일시				*/
             , Z1.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER                                       /* 신규상품요청상태내역순서	*/
             /* 2023.06.21 이상민 : 재고API사용여부, 협력사ID, 협력사명, 협력사SKU 추가 */
             , Z1.INVN_API_USE_YN														   /* 재고API사용여부		*/
             , Z1.CPRTCP_ID																   /* 협력사ID			*/
             , Z12.COM_DTL_CD_NM							  		AS CPRTCP_NM		   /* 협력사명				*/
             , Z1.CPRTCP_PRD_ID															   /* 협력사SKU			*/
          FROM (
                SELECT A2.CO_CD                                    /* 회사코드				*/
                     , A2.NEW_PRD_REQ_NO                           /* 신규상품요청번호		*/
                     , A2.PUB_ONLY_SPR_CD                          /* 공용전용구분코드		*/
                     , A2.RND_REQ_PRD_ID                           /* RND요청상품ID		*/
                     , A2.REQ_PRD_NM                               /* 요청상품명			*/
                     , A2.MNFR_NO                                  /* 제조사번호			*/
                     , A2.BASIS_UNIT_CD                            /* 기본단위코드			*/
                     , A2.BASIS_UNIT_QTY                           /* 기본단위수량			*/
                     , A2.SELL_UNIT_CD                             /* 판매단위코드			*/
                     , A2.ORGPLC_CTRY_CD                           /* 원산지국가코드		*/
                     , A2.PRD_CLCD                                 /* 상품분류코드			*/
                     , A2.REGPSN_ID                                /* 등록자ID			*/
                     , A2.REG_DTM                                  /* 등록일시				*/
                     , A2.NEW_PRD_REQ_STATS_CD                     /* 신규상품요청상태코드	*/
                     , A2.RND_HUB_HNL_DIS_TP_CD                    /* RND허브취급불가유형코드	*/
                     , A2.REQ_SBJ_CD                               /* 요청주체코드			*/
                     , A2.HPE_SELL_UPRC                            /* 희망판매가격			*/
                     , A2.DSTRB_STD_PRC                            /* 유통판매가격			*/
                     , A2.TX_CLCD                                  /* 세금분류코드			*/
                     , A2.BRND_NM                                  /* 브랜드명				*/
                     , A2.HASH_TAG                                 /* 해시태그				*/
                     , A2.BG_SEQ                                   /* 배지순번				*/
                     , A2.BG_APLY_STR_DTM                          /* 배지적용시작일시		*/
                     , A2.BG_APLY_END_DTM                          /* 배지적용종료일시		*/
                     , A2.PPI_DOC_REG_ID                           /* 상품문서등록ID		*/
                     , A2.PRD_DTL_DESC                             /* 상품상세설명			*/
                     , A2.NOTI_ITM_ID                              /* 고시ITEM ID			*/
                     , A2.PROC_ID                                  /* 처리자ID			*/
                     , A2.PROC_DTM                                 /* 처리일시				*/
                     , A2.DISP_PRD_SPR_CD                          /* 전시상품구분코드		*/
                     , A2.BG_NM                                    /* 배지명				*/
                     , A2.SBI_DOC_REG_ID                           /* 배지문서등록ID		*/
                     , A2.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER       /* 신규상품요청상태내역순서	*/
                     , A2.CHM_MTL_YN                               /* 화학물질여부			*/
                     , A2.INVN_API_USE_YN						   /* 재고API사용여부		*/
                     , A2.CPRTCP_ID								   /* 협력사ID			*/
                     , A2.CPRTCP_PRD_ID							   /* 협력사SKU			*/
                  FROM (
                        SELECT A1.CO_CD
                             , A1.NEW_PRD_REQ_NO
                             , A1.PUB_ONLY_SPR_CD
                             , A1.RND_REQ_PRD_ID
                             , A1.REQ_PRD_NM
                             , A1.MNFR_NO
                             , A1.BASIS_UNIT_CD
                             , A1.BASIS_UNIT_QTY
                             , A1.SELL_UNIT_CD
                             , A1.ORGPLC_CTRY_CD
                             , A1.PRD_CLCD
                             , A1.REGPSN_ID
                             , A1.REG_DTM
                             , A1.NEW_PRD_REQ_STATS_CD
                             , A1.RND_HUB_HNL_DIS_TP_CD
                             , A1.REQ_SBJ_CD
                             , A1.HPE_SELL_UPRC
                             , A1.DSTRB_STD_PRC
                             , A1.TX_CLCD
                             , A1.BRND_NM
                             , A1.HASH_TAG
                             , A1.BG_SEQ
                             , A1.BG_APLY_STR_DTM
                             , A1.BG_APLY_END_DTM
                             , A1.PPI_DOC_REG_ID
                             , A1.PRD_DTL_DESC
                             , A1.NOTI_ITM_ID
                             , A1.PROC_ID
                             , A1.PROC_DTM
                             , A1.DISP_PRD_SPR_CD
                             , A1.BG_NM
                             , A1.SBI_DOC_REG_ID
                             , A1.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
                             , A1.CHM_MTL_YN
                             , A1.INVN_API_USE_YN
                             , A1.CPRTCP_ID
                             , A1.CPRTCP_PRD_ID
                          FROM (
                                SELECT A.CO_CD                                                                           /* 회사코드				*/
                                     , A.NEW_PRD_REQ_NO                                                                  /* 신규상품요청번호			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.PUB_ONLY_SPR_CD
                                            ELSE A.PUB_ONLY_SPR_CD
                                       END                                                AS PUB_ONLY_SPR_CD             /* 공용전용구분코드			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.PRD_ID
                                            ELSE A.RND_REQ_PRD_ID
                                       END                                                AS RND_REQ_PRD_ID              /* RND요청상품ID			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.PRD_NM
                                            ELSE A.REQ_PRD_NM
                                       END                                                AS REQ_PRD_NM                  /* 요청상품명				*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.MNFR_NO
                                            ELSE A.MNFR_NO
                                       END                                                AS MNFR_NO                     /* 제조사번호				*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.BASIS_UNIT_CD
                                            ELSE A.BASIS_UNIT_CD
                                       END                                                AS BASIS_UNIT_CD               /* 기본단위코드			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.BASIS_UNIT_QTY
                                            ELSE A.BASIS_UNIT_QTY
                                       END                                                AS BASIS_UNIT_QTY              /* 기본단위수량			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.SELL_UNIT_CD
                                            ELSE A.SELL_UNIT_CD
                                       END                                                AS SELL_UNIT_CD                /* 판매단위코드			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN D.ORGPLC_CTRY_CD
                                            ELSE A.ORGPLC_CTRY_CD
                                       END                                                AS ORGPLC_CTRY_CD              /* 원산지국가코드			*/
                                     , CASE WHEN D.CO_CD IS NOT NULL
                                            THEN E.PRD_CLCD
                                            ELSE A.PRD_CLCD
                                       END                                                AS PRD_CLCD                    /* 상품분류코드			*/
                                     , A.REGPSN_ID                                                                       /* 등록자ID				*/
                                     , TO_CHAR(A.REG_DTM,'YYYY-MM-DD HH24:MI:SS')         AS REG_DTM                     /* 등록일시				*/
                                     , B.NEW_PRD_REQ_STATS_CD                                                            /* 신규상품요청상태코드		*/
                                     , D.HUB_HNL_DIS_TP_CD                                AS RND_HUB_HNL_DIS_TP_CD       /* RND허브취급불가유형코드	*/
                                     , NVL(C.REQ_SBJ_CD,'10')                             AS REQ_SBJ_CD                  /* 요청주체코드			*/
                                     , (
                                        SELECT /*+ INDEX(S1 TB_PC_PRD_PRC_HST_PK) */
                                               S1.STPRC
                                          FROM SSP_APP.TB_PC_PRD_PRC_HST S1
                                         WHERE S1.CO_CD  = A.CO_CD
                                           AND S1.PRD_ID = A.RND_REQ_PRD_ID
                                           AND TO_CHAR(A.UPD_DTM,'YYYYMMDDHH24MISS') <= S1.BSS_SALSPRC_STR_DTM
                                           AND ROWNUM    = 1
                                      )                                                   AS HPE_SELL_UPRC               /* 희망판매단가			*/
                                     , C.DSTRB_STD_PRC                                                                   /* 유통표준가격			*/
                                     , NVL(D.TX_CLCD,C.RND_TX_CLCD)                       AS TX_CLCD                     /* 세금분류코드			*/
                                     , E.BRND_NM                                                                         /* 브랜드명				*/
                                     , E.HASH_TAG                                                                        /* 해시태그				*/
                                     , E.BG_SEQ                                                                          /* 배지순번				*/
                                     , TO_CHAR(E.BG_APLY_STR_DTM,'YYYY-MM-DD HH24:MI:SS') AS BG_APLY_STR_DTM             /* 배지적용시작일시			*/
                                     , TO_CHAR(E.BG_APLY_END_DTM,'YYYY-MM-DD HH24:MI:SS') AS BG_APLY_END_DTM             /* 배지적용종료일시			*/
                                     , E.DOC_REG_ID                                       AS PPI_DOC_REG_ID              /* 문서등록ID				*/
                                     , E.PRD_DTL_DESC                                                                    /* 상품상세설명			*/
                                     , CASE WHEN A.RND_REQ_PRD_ID IS NULL
                                            THEN H.NOTI_ITM_ID
                                            ELSE E.NOTI_ITM_ID
                                       END                                                AS NOTI_ITM_ID                 /* 고시품목ID				*/
                                     , E.UPDPSN_ID PROC_ID                                                               /* 수정자ID				*/
                                     , TO_CHAR(E.UPD_DTM,'YYYY-MM-DD HH24:MI:SS')         AS PROC_DTM                    /* 수정일시				*/
                                     , F.DISP_PRD_SPR_CD                                                                 /* 전시상품구분코드			*/
                                     , G.BG_NM                                                                           /* 배지명				*/
                                     , G.DOC_REG_ID                                       AS SBI_DOC_REG_ID              /* 배지문서등록ID			*/
                                     , NVL(D.CHM_MTL_PRD_YN,C.CHM_MTL_YN)                 AS CHM_MTL_YN                  /* 화학물질여부			*/
                                     , ROW_NUMBER() OVER (PARTITION BY A.CO_CD, A.NEW_PRD_REQ_NO ORDER BY B.SEQ DESC) AS TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER
                                       /* 2023.06.21 이상민 : 재고API사용여부, 협력사ID, 협력사SKU 추가 */
                                     , NVL(E.INVN_API_USE_YN, '%') 						  AS INVN_API_USE_YN			 /* 재고API사용여부			*/
                                     , E.CPRTCP_ID																		 /* 협력사ID				*/                                     
                                     , E.CPRTCP_PRD_ID																	 /* 협력사SKU				*/
                                  FROM SSP_APP.TB_PR_NEW_PRD_REQ_PROC            A
                                  LEFT JOIN SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS B
                                    ON 0=0
                                   AND B.CO_CD          = A.CO_CD
                                   AND B.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
                                  LEFT JOIN SSP_APP.TB_PR_MRO_PRD_INFO D
                                    ON 0=0
                                   AND D.CO_CD  = A.CO_CD
                                   AND D.PRD_ID = NVL(A.RND_REQ_PRD_ID,LPAD(#{RND_REQ_PRD_ID},18,0))
                                  LEFT JOIN SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO C
                                    ON 0=0
                                   AND C.CO_CD          = A.CO_CD
                                   AND C.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
                                  LEFT JOIN SSP_APP.TB_PR_PRD_INFO E
                                    ON 0=0
                                   AND E.CO_CD  = D.CO_CD
                                   AND E.PRD_ID = D.PRD_ID
                                  LEFT JOIN SSP_APP.TB_PR_PRD_CLSF_INFO H
                                    ON 0=0
                                   AND H.CO_CD    = A.CO_CD
                                   AND H.PRD_CLCD = A.PRD_CLCD
                                  LEFT JOIN SSP_APP.TB_PR_DISP_BASIS F
                                    ON 0=0
                                   AND F.CO_CD    = A.CO_CD
                                   AND F.PRD_CLCD = A.PRD_CLCD
                                  LEFT JOIN SSP_APP.TB_SA_BG_INFO G
                                    ON 0=0
                                   AND G.CO_CD  = E.CO_CD
                                   AND G.BG_SEQ = E.BG_SEQ
                                 WHERE 0=0
                                   AND A.CO_CD          = #{CO_CD}
                                   AND A.NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
                               ) A1
                         WHERE 0=0
                           AND A1.TB_PR_NEW_PRD_REQ_STATS_DTLS_ORDER = 1
                       ) A2
                 WHERE 0=0
               ) Z1
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z2
            ON 0=0
           AND Z2.LANG_CD     = #{LANG_CD}
           AND Z2.COM_CLSF_CD = 'NEW_PRD_REQ_STATS_CD'
           AND Z2.COM_DTL_CD  = Z1.NEW_PRD_REQ_STATS_CD
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z3
            ON 0=0
           AND Z3.LANG_CD     = #{LANG_CD}
           AND Z3.COM_CLSF_CD = 'PUB_ONLY_SPR_CD'
           AND Z3.COM_DTL_CD  = Z1.PUB_ONLY_SPR_CD
          LEFT JOIN SSP_APP.TB_PR_MNFR_INFO Z4
            ON 0=0
           AND Z4.CO_CD   = Z1.CO_CD
           AND Z4.MNFR_NO = Z1.MNFR_NO
          LEFT JOIN SSP_APP.TB_CO_CTRY_INFO Z5
            ON 0=0
           AND Z5.CO_CD       = Z1.CO_CD
           AND Z5.CTRY_SPR_CD = ORGPLC_CTRY_CD
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z6
            ON 0=0
           AND Z6.LANG_CD     = #{LANG_CD}
           AND Z6.COM_CLSF_CD = 'TX_CLCD'
           AND Z6.COM_DTL_CD  = Z1.TX_CLCD
          LEFT JOIN SSP_APP.TB_CO_MBR_OPRTR_INFO Z7
            ON 0=0
           AND Z7.CO_CD    = Z1.CO_CD
           AND Z7.OPRTR_ID = Z1.REGPSN_ID
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z9
            ON 0=0
           AND Z9.LANG_CD     = #{LANG_CD}
           AND Z9.COM_CLSF_CD = 'DISP_PRD_SPR_CD'
           AND Z9.COM_DTL_CD  = Z1.DISP_PRD_SPR_CD
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z10
            ON 0=0
           AND Z10.LANG_CD     = #{LANG_CD}
           AND Z10.COM_CLSF_CD = 'HUB_HNL_DIS_TP_CD'
           AND Z10.COM_DTL_CD  = Z1.RND_HUB_HNL_DIS_TP_CD
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z11
            ON 0=0
           AND Z11.LANG_CD     = #{LANG_CD}
           AND Z11.COM_CLSF_CD = 'REQ_SBJ_CD'
           AND Z11.COM_DTL_CD  = Z1.REQ_SBJ_CD
          LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL Z12
            ON 0=0
           AND Z12.LANG_CD     = #{LANG_CD}
           AND Z12.COM_CLSF_CD = 'API_CPRTCP_ID'
           AND Z12.COM_DTL_CD  = Z1.CPRTCP_ID
        ]]>
    </select>
    
    <select id="selectNewPrdProcCount" parameterType="HashMap" resultType="Integer">
        /* NewPrdReqLst.selectNewPrdProcCount 카테고리속성정보 카운트 */
        SELECT COUNT(*)
          FROM TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO
         WHERE CO_CD = #{CO_CD}
           AND NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
    </select>

    <select id="selectCatgAttrInfo" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectCatgAttrInfo 카테고리속성정보 조회 */
        <![CDATA[
        SELECT A.CO_CD                                AS CO_CD                     /*회사코드*/
             , A.PRD_CLCD                             AS PRD_CLCD                  /*상품분류코드*/
             , A.PRD_ATTR_CD                          AS PRD_ATTR_CD               /*상품속성코드*/
             , B.PRNM                                 AS PRNM                      /*상품속성명*/
             , A.SRT_SO                               AS SRT_SO                    /*정렬순서*/
             , C.NEW_PRD_REQ_PRVL                     AS NEW_PRD_REQ_PRVL          /*신규상품속성값*/
             , NVL(A.MAND_YN,'N')                     AS MAND_YN                   /*필수항목여부*/
             , D.NOTI_ITM_ID                          AS NOTI_ITM_ID               /*고시품목ID*/
             , CASE WHEN D.NOTI_ITM_ID IS NOT NULL
                    THEN '(' || D.NOTI_ITM_ID || ') ' ||
                          (
                           SELECT S1.NOTI_ITM_NM
                             FROM SSP_APP.TB_PR_NOTI_ITM_BASIS S1
                            WHERE S1.CO_CD       = D.CO_CD
                              AND S1.NOTI_ITM_ID = D.NOTI_ITM_ID
                           )
               END                                    AS NOTI_ITM_NM               /*고시ITEM NM*/
             , DECODE(A.PRD_CLCD,#{PRD_CLCD},'1','0') AS CHK_YN
          FROM (
                SELECT A.CO_CD                       /*회사코드*/
                     , A.PRD_CLCD                    /*상품분류코드*/
                     , A.PRD_ATTR_CD                 /*상품속성코드*/
                     , A.MAND_YN                     /*필수여부*/
                     , A.SRT_SO                      /*정렬순서*/
                     , A.UPD_RSN                     /*수정사유*/
                     , A.REGPSN_ID                   /*등록자ID*/
                     , A.REG_DTM                     /*등록일시*/
                     , A.UPDPSN_ID                   /*수정자ID*/
                     , A.UPD_DTM                     /*수정일시*/
                  FROM TB_PR_PRD_CLSF_ATTR_MAPP A
                 WHERE A.CO_CD    = #{CO_CD}
                   AND A.PRD_CLCD = #{PRD_CLCD}
                 UNION ALL
                SELECT A.CO_CD                       /*회사코드*/
                     , A.PRD_CLCD                    /*상품분류코드*/
                     , A.PRD_ATTR_CD                 /*상품속성코드*/
                     , A.MAND_YN                     /*필수여부*/
                     , A.SRT_SO                      /*정렬순서*/
                     , A.UPD_RSN                     /*수정사유*/
                     , A.REGPSN_ID                   /*등록자ID*/
                     , A.REG_DTM                     /*등록일시*/
                     , A.UPDPSN_ID                   /*수정자ID*/
                     , A.UPD_DTM                     /*수정일시*/
                  FROM TB_PR_PRD_CLSF_ATTR_MAPP A
                 WHERE A.CO_CD    = #{CO_CD}
                   AND A.PRD_CLCD = #{OLD_PRD_CLCD}
                   AND NOT EXISTS
                       (
                        SELECT 'X'
                          FROM TB_PR_PRD_CLSF_ATTR_MAPP S1
                         WHERE S1.CO_CD       = #{CO_CD}
                           AND S1.PRD_CLCD    = #{PRD_CLCD}
                           AND S1.PRD_ATTR_CD = A.PRD_ATTR_CD
                       )
               )                                A
          LEFT JOIN SSP_APP.TB_PR_PRD_ATTR_INFO B
            ON 0=0
           AND B.CO_CD       = A.CO_CD
           AND B.PRD_ATTR_CD = A.PRD_ATTR_CD
           ]]>
           <choose>
               <when test="STATE == 'PROC'">
                   LEFT JOIN SSP_APP.TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO C
               </when>
               <otherwise>
                   LEFT JOIN SSP_APP.TB_PR_NEW_PRD_CUST_REQ_ATTR_INFO C
               </otherwise>
           </choose>
            ON 0=0
           AND C.CO_CD                                                               = A.CO_CD
           AND SSP_APP.FN_RD_CONV_CUST_CPRTCP_TO_SSP_ATTR_CD(C.CO_CD,C.INTG_ATTR_CD) = A.PRD_ATTR_CD
           AND C.NEW_PRD_REQ_NO                                                      = #{NEW_PRD_REQ_NO}
          LEFT JOIN SSP_APP.TB_PR_PRD_CLSF_INFO D
            ON 0=0
           AND D.CO_CD    = A.CO_CD
           AND D.PRD_CLCD = A.PRD_CLCD
          LEFT JOIN SSP_APP.TB_PR_PRD_CLSF_ATTR_SRT_INFO SRT
            ON 1=1 
           AND SRT.CO_CD = A.CO_CD 
           AND SRT.PRD_CLCD = A.PRD_CLCD 
           AND SRT.INTG_ATTR_CD = A.PRD_ATTR_CD
         WHERE A.CO_CD = #{CO_CD} AND NVL(SRT.EXPS_YN, 'Y') = 'Y'
         ORDER BY DECODE(A.PRD_CLCD,#{PRD_CLCD},'1','2')
                , NVL(SRT.SRT_SO, A.SRT_SO)
        
    </select>

    <select id="selectPrdNotiPrdInq" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectPrdNotiPrdInq 상품고시상품 조회 */
        <![CDATA[
        SELECT B.CO_CD                       /*회사코드*/
             , B.NOTI_ITM_ID                 /*고시품목ID*/
             , B.NOTI_ITM_NM                 /*고시품목명*/
             , C.NOTI_ITM_DTL_NO             /*고시품목상세번호*/
             , C.NOTI_ITM_DTL_NM             /*고시품목상세명*/
             , C.NOTI_ITM_DTL_CTS            /*고시품목상세내용*/
             , D.PRD_ID                      /*상품ID*/
             , D.PRD_NOTI_ITM_MAPP_CTS       /*상품고시품목매핑내용*/
          FROM SSP_APP.TB_PR_NOTI_ITM_BASIS    B
          LEFT JOIN SSP_APP.TB_PR_NOTI_ITM_DTL C
            ON 0=0
           AND C.CO_CD       = B.CO_CD
           AND C.NOTI_ITM_ID = B.NOTI_ITM_ID
          LEFT JOIN SSP_APP.TB_PR_REG_PROC_PRD_NOTI_ITM_MAPP D
            ON 0=0
           AND D.CO_CD           = C.CO_CD
           AND D.NOTI_ITM_ID     = C.NOTI_ITM_ID
           AND D.NOTI_ITM_DTL_NO = C.NOTI_ITM_DTL_NO
           AND D.PRD_ID          = LPAD(#{PRD_ID},18,0)
         WHERE 0=0
           AND B.CO_CD       = #{CO_CD}
           AND B.NOTI_ITM_ID = #{NOTI_ITM_ID}
        ]]>
    </select>

    <select id="selectAttcFileDtlsInq" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectAttcFileDtlsInq 첨부파일내역 조회 */
        <![CDATA[
        SELECT A.DOC_REG_ID                  /*문서등록ID*/
             , A.DOC_REG_SEQ                 /*문서등록순번*/
             , A.ATFL_NM                     /*첨부파일명*/
             , A.ATFL_LEN                    /*첨부파일길이*/
             , A.ATFL_STOR_PATH              /*첨부파일저장경로*/
             , A.STOR_PLC_SPR_CD             /*저장장소구분코드*/
             , A.ORI_ATFL_NM                 /*원첨부파일명*/
             , A.SAP_DOC_ID                  /*SAP문서ID*/
             , A.RMKS_CTS                    /*비고내용*/
             , A.ETC_FDS_1                   /*기타필드1*/
             , A.ETC_FDS_2                   /*기타필드2*/
             , A.ETC_FDS_3                   /*기타필드3*/
             , A.ETC_FDS_4                   /*기타필드4*/
             , A.ETC_FDS_5                   /*기타필드5*/
             , A.REG_DTM                     /*등록일시*/
             , A.REGPSN_ID                   /*등록자ID*/
             , A.UPD_DTM                     /*수정일시*/
             , A.UPDPSN_ID                   /*수정자ID*/
          FROM SSP_APP.TB_CO_ATFL_DTLS A
         WHERE 1=1
           AND A.DOC_REG_ID = #{DOC_REG_ID}
        ]]>
    </select>

    <select id="selectReqProcDtlsInq" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectReqProcDtlsInq 요청처리내역 조회 */
        SELECT
            A.CO_CD                                                                                                             /* 회사코드 */
            , A.NEW_PRD_REQ_NO                                                                                                  /* 신규상품요청번호 */
            , B.NEW_PRD_REQ_STATS_CD                                                                                            /* 신규상품요청상태코드 */
            , FN_OD_COM_CDNM('NEW_PRD_REQ_STATS_CD', B.NEW_PRD_REQ_STATS_CD, '1', '2', #{LANG_CD}) AS NEW_PRD_REQ_STATS_NM    /* 신규상품요청상태명 */
            , B.UPDPSN_ID AS PROC_ID                                                                                            /* 수정자 ID */
            , TO_CHAR(B.UPD_DTM, 'YYYY-MM-DD HH24:MI:SS') AS PROC_DTM                                                           /* 수정일시 */
            , FN_CC_GET_MBR_NM(A.CO_CD,A.UPDPSN_ID) AS OPRTR_NM                                                                 /* 수정자명 */
            , '(' || B.UPDPSN_ID || ') ' || FN_CC_GET_MBR_NM(B.CO_CD,B.UPDPSN_ID) AS PROC_NM                                    /* 수정자ID명*/
            , DECODE(
                B.NEW_PRD_REQ_STATS_CD, '42'
                , FN_OD_COM_CDNM('PRD_REG_DIS_TP_CD', A.PRD_REG_DIS_TP_CD, '1', NULL, #{LANG_CD})
            ) AS PRD_REG_DIS_TP_NM                  /* 신규상품요청상태명 */
            , DECODE(
                B.NEW_PRD_REQ_STATS_CD, '42'
                , A.REG_DIS_RSN, B.MEMO_CTS
            ) AS REASON                             /* 사유 */
        FROM TB_PR_NEW_PRD_REQ_PROC A
        LEFT JOIN TB_PR_NEW_PRD_REQ_STATS_DTLS B ON A.CO_CD = B.CO_CD
            AND A.NEW_PRD_REQ_NO = B.NEW_PRD_REQ_NO
        WHERE 0=0
        AND A.CO_CD = #{CO_CD}
        AND A.NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
        AND B.NEW_PRD_REQ_STATS_CD NOT IN ('25')    /* 접수 */
        ORDER BY B.SEQ DESC
    </select>

    <select id="selectCprtcpReqInfoInq" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectCprtcpReqInfoInq 협력사요청정보 조회 */
        <![CDATA[
            SELECT A1.CO_CD                                                                  /*회사코드*/
                 , A1.NEW_PRD_REQ_NO                                                         /*신규상품요청번호*/
                 , A1.REQ_SBJ_CD                                                             /*요청주체코드*/
                 , A1.UPDPSN_ID                   AS CPRTCP_ID                               /*협력사ID*/
                 , A1.UPDPSN_ID         			                                         /*수정자ID*/
                 , A1.REQ_PRD_NM                                                             /*요청상품명*/
                 , A1.MNFR_NO                                                                /*제조사번호*/
                 , NVL(A1.MNFR_NM,A1.MRO_MNFR_NM) AS MRO_MNFR_NM                             /*제조사명*/
                 , A1.ORGPLC_CTRY_CD                                                         /*원산지국가코드*/
                 , A1.HPE_SELL_UNIT_QTY                                                      /*희망판매단위수량*/
                 , A1.HPE_BASIS_UNIT_CD                                                      /*희망기본단위코드*/
                 , A1.HPE_SELL_UNIT_CD                                                       /*희망판매단위코드*/
                 , A1.HPE_BASIS_NM                                                           /*주문단위명*/
                 , A1.PRD_CLCD_NM                                                            /*상품군명*/
                 , A1.CHM_MTL_YN                                                             /*화학물질여부*/
                 , A1.MIN_ODR_QTY                                                            /*최소주문수량*/
                 , A1.REQ_RSN                                                                /*요청사유*/
                 , A1.PRD_CLCD                                                               /*상품분류코드*/
                 , A1.DOC_REG_ID                                                             /*문서등록ID*/
                 , CASE WHEN REQ_SBJ_CD = '30'
                        THEN '(' || A1.UPDPSN_ID || ') ' || A1.CPRTCP_KOR_NM
                        ELSE '(' || A1.UPDPSN_ID || ') ' || A1.MBR_NM
                    END CPRTCP_KOR_NM                                                        /*협력사명 or 회원명 */
                 , A1.CTRY_NM                                                                /*원산지명*/
                 , A1.NEW_PRD_REQ_PRVL_LIST                                                  /*대표규격*/
                 , A1.TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO_ORDER
                 , A1.MBR_NM                                                                 /*회원명*/
                 , A1.BZPLC_ID                                                               /*사업장ID*/
                 , A1.DEPT_ID                                                                /*부서ID*/
                 , A1.OPR_UNIT_ID                                                            /*운영단위ID*/
                 , A1.BZPLC_NM                                                               /*사업장명*/
                 , A1.OPR_UNIT_NM                                                            /*운영단위명*/
                 , A1.PRD_PRPS_SPR_CD                                                        /*상품제안구분코드*/
                 , A1.PRD_PRPS_SPR_YN                                                        /* 제안여부 YN */
                 , A1.PRD_PRPS_STATS_CD                                                      /*상품제안상태코드*/
                 , A1.PRD_PRPS_STATS_NM                                                      /*상품제안상태명*/
                 , A1.ALT_PRPS_RSN                                                           /*대체상품제안사유*/
                 , A1.CUST_RJT_RSN                                                           /*고객거부사유*/
                 , A1.PUB_ONLY_SPR_CD                                                        /*공용전용구분코드*/
                 , A1.PUB_ONLY_SPR_NM                                                        /*공용전용구분명*/
                 , A1.TRSF_PSN_ID                                                            /*이관담당자ID*/
                 , CASE WHEN A1.TRSF_PSN_ID IS NOT NULL
                        THEN '(' || A1.TRSF_PSN_ID || ') ' || B1.OPRTR_NM
                        ELSE ''
                   END                                               AS TRSF_PSN_NM          /*이관담당자명*/
                 , A1.TRSF_DTM                                                               /*이관일시*/
                 , A1.TRSF_RSN                                                               /*이관사유*/
                 , A1.HPE_SELL_UPRC                                                          /*희망판매단가*/
              FROM (
                    SELECT A.CO_CD                                                                                                         /*회사코드*/
                         , A.NEW_PRD_REQ_NO                                                                                                /*신규상품요청번호*/
                         , A.REQ_SBJ_CD                                                                                                    /*요청주체코드*/
                         , A.REGPSN_ID                                                           AS UPDPSN_ID                              /*요청자ID*/
                         , A.REQ_PRD_NM                                                                                                    /*요청상품명*/
                         , A.MNFR_NO                                                                                                       /*제조사번호*/
                         , A.MNFR_NM                                                                                                       /*제조사명*/
                         , A.ORGPLC_CTRY_CD                                                                                                /*원산지국가코드*/
                         , A.HPE_SELL_UNIT_QTY                                                                                             /*희망판매단위수량*/
                         , A.HPE_BASIS_UNIT_CD                                                                                             /*희망기본단위코드*/
                         , CASE WHEN A.HPE_SELL_UNIT_QTY > 1
                                 AND A.HPE_SELL_UNIT_CD IS NOT NULL
                                 AND A.HPE_BASIS_UNIT_CD != A.HPE_SELL_UNIT_CD
                                THEN A.HPE_SELL_UNIT_CD
                           END                                                                   AS HPE_SELL_UNIT_CD                       /*희망판매단위코드*/
                         , TRIM(TO_CHAR(A.HPE_SELL_UNIT_QTY,'999,999,999,999,999'))
                           ||' '
                           ||A.HPE_BASIS_UNIT_CD
                           ||CASE WHEN A.HPE_SELL_UNIT_CD IS NOT NULL
                                   AND A.HPE_BASIS_UNIT_CD != A.HPE_SELL_UNIT_CD
                                  THEN '/'||A.HPE_SELL_UNIT_CD
                           END                                                                   AS HPE_BASIS_NM                           /*주문단위명*/
                         , (
                            SELECT SSP_APP.FN_PR_FULL_CLSF_NM
                                   (
                                     A.CO_CD
                                   , A.PRD_CLCD
                                   )
                              FROM DUAL
                           )                                                                     AS PRD_CLCD_NM                            /*상품군명*/
                         , A.CHM_MTL_YN                                                                                                    /*화학물질여부*/
                         , A.MIN_ODR_QTY                                                                                                   /*최소주문수량*/
                         , A.REQ_RSN                                                                                                       /*요청사유*/
                         , A.PRD_CLCD                                                                                                      /*상품분류코드*/
                         , A.DOC_REG_ID                                                                                                    /*문서등록ID*/
                         , B.CPRTCP_KOR_NM                                                                                                 /*협력사명*/
                         , C.MRO_MNFR_NM                                                                                                   /*제조사명*/
                         , D.CTRY_NM                                                                                                       /*원산지명*/
                         , (
                             SELECT LISTAGG(NEW_PRD_REQ_PRVL,';') WITHIN GROUP (ORDER BY SRT_SO)
                               FROM SSP_APP.TB_PR_NEW_PRD_CUST_REQ_ATTR_INFO S2
                              WHERE S2.CO_CD          = A.CO_CD
                                AND S2.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
                            )                                                                    AS NEW_PRD_REQ_PRVL_LIST                  /*대표규격*/
                         , ROW_NUMBER() OVER (PARTITION BY A.CO_CD, A.NEW_PRD_REQ_NO ORDER BY 1) AS TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO_ORDER
                         , F.MBR_NM                                                                                                        /*회원명*/
                         , F.BZPLC_ID                                                                                                      /*사업장ID*/
                         , F.DEPT_ID                                                                                                       /*부서ID*/
                         , G.OPR_UNIT_ID                                                                                                   /*운영단위ID*/
                         , H.BZPLC_NM                                                                                                      /*사업장명*/
                         , I.OPR_UNIT_NM                                                                                                   /*운영단위명*/
                         , J.PRD_PRPS_SPR_CD                                                                                               /*상품제안구분코드*/
                         , DECODE(J.PRD_PRPS_SPR_CD, 10, 'Y', 20, 'N') AS PRD_PRPS_SPR_YN                                                  /* 제안여부 YN */
                         , J.PRD_PRPS_STATS_CD                                                                                             /*상품제안상태코드*/
                         , L.COM_DTL_CD_NM                                                       AS PRD_PRPS_STATS_NM                      /*상품제안상태명*/
                         , J.ALT_PRPS_RSN                                                                                                  /*대체상품제안사유*/
                         , J.CUST_RJT_RSN                                                                                                  /*고객거부사유*/
                         , A.PUB_ONLY_SPR_CD                                                                                               /*공용전용구분코드*/
                         , M.COM_DTL_CD_NM                                                       AS PUB_ONLY_SPR_NM                        /*공용전용구분명*/
                         , (
                            SELECT /*+ INDEX_DESC(Z TB_PR_NEW_PRD_REQ_STATS_DTLS_PK) */
                                    Z.UPDPSN_ID
                              FROM SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS Z
                             WHERE Z.CO_CD                = A.CO_CD
                               AND Z.NEW_PRD_REQ_NO       = A.NEW_PRD_REQ_NO
                               AND Z.NEW_PRD_REQ_STATS_CD IN ('33', '35')  /*이관*/
                               AND ROWNUM = 1
                           )                                                                     AS TRSF_PSN_ID                            /*이관담당자ID*/
                         , (
                            SELECT /*+ INDEX_DESC(Z TB_PR_NEW_PRD_REQ_STATS_DTLS_PK) */
                                   TO_CHAR(Z.UPD_DTM,'YYYY.MM.DD HH24:MI:SS')
                              FROM SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS Z
                             WHERE Z.CO_CD                = A.CO_CD
                               AND Z.NEW_PRD_REQ_NO       = A.NEW_PRD_REQ_NO
                               AND Z.NEW_PRD_REQ_STATS_CD IN ('33', '35') /*이관*/
                               AND ROWNUM = 1
                           )                                                                     AS TRSF_DTM                               /*이관일자*/
                         , J.TRSF_RSN                                                                                                      /*이관사유*/
                         , A.HPE_SELL_UPRC                                                                                                 /*희망판매단가*/
                      FROM SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO A
                      LEFT JOIN SSP_APP.TB_CP_CPRTCP_BASIS     B
                        ON 0=0
                       AND B.CPRTCP_ID = A.REGPSN_ID
                      LEFT JOIN SSP_APP.TB_PR_MNFR_INFO C
                        ON 0=0
                       AND C.CO_CD   = A.CO_CD
                       AND C.MNFR_NO = A.MNFR_NO
                      LEFT JOIN SSP_APP.TB_CO_CTRY_INFO D
                        ON 0=0
                       AND D.CO_CD       = A.CO_CD
                       AND D.CTRY_SPR_CD = A.ORGPLC_CTRY_CD
                      LEFT JOIN SSP_APP.TB_CC_MBR_BASIS F
                        ON 0=0
                       AND F.CO_CD  = A.CO_CD
                       AND F.MBR_ID = A.REGPSN_ID
                      LEFT JOIN SSP_APP.TB_CC_DEPT_BASIS G
                        ON 1=1
                       AND G.CO_CD   = F.CO_CD
                       AND G.DEPT_ID = F.DEPT_ID
                      LEFT JOIN SSP_APP.TB_CC_BZPLC_BASIS H
                        ON 1=1
                       AND H.CO_CD    = F.CO_CD
                       AND H.BZPLC_ID = F.BZPLC_ID
                      LEFT JOIN SSP_APP.TB_CC_OPR_UNIT_BASIS I
                        ON 1=1
                       AND I.CO_CD       = G.CO_CD
                       AND I.OPR_UNIT_ID = G.OPR_UNIT_ID
                      LEFT JOIN SSP_APP.TB_PR_NEW_PRD_REQ_PROC J
                        ON 1=1
                       AND J.CO_CD          = A.CO_CD
                       AND J.NEW_PRD_REQ_NO = A.NEW_PRD_REQ_NO
                      LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL K
                        ON 0=0
                       AND K.LANG_CD     = #{LANG_CD}
                       AND K.COM_CLSF_CD = 'PRD_PRPS_SPR_CD'
                       AND K.COM_DTL_CD  = J.PRD_PRPS_SPR_CD
                      LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL L
                        ON 0=0
                       AND L.LANG_CD     = #{LANG_CD}
                       AND L.COM_CLSF_CD = 'PRD_PRPS_STATS_CD'
                       AND L.COM_DTL_CD  = J.PRD_PRPS_STATS_CD
                      LEFT JOIN SSP_APP.TB_CO_COM_CD_DTL M
                        ON 0=0
                       AND M.LANG_CD     = #{LANG_CD}
                       AND M.COM_CLSF_CD = 'PUB_ONLY_SPR_CD'
                       AND M.COM_DTL_CD  = A.PUB_ONLY_SPR_CD
                     WHERE 1=1
                       AND A.CO_CD          = #{CO_CD}
                       AND A.NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
                   ) A1
              LEFT JOIN SSP_APP.TB_CO_MBR_OPRTR_INFO B1
                ON 1=1
               AND B1.CO_CD    = A1.CO_CD
               AND B1.OPRTR_ID = A1.TRSF_PSN_ID
             WHERE 1=1
               AND A1.TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO_ORDER = 1
        ]]>
    </select>

    <select id="selectNewPrdCustReqInfo" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectNewPrdCustReqInfo 신규상품고객요청정보 조회 */
        
        SELECT A.CO_CD                                                        AS CO_CD                       /*회사코드*/
             , A.NEW_PRD_REQ_NO                                               AS NEW_PRD_REQ_NO              /*요청번호*/
             , A.UPDPSN_ID                                                    AS CPRTCP_ID                   /*협력사ID*/
             , A.MIN_ODR_QTY                                                  AS MIN_ODR_QTY                 /*최소발주수량*/
             , A.HPE_SELL_UPRC                                                AS HPE_SELL_UPRC               /*매입가*/
             , A.DLV_AMT                                                      AS DLV_AMT                     /*배송비*/
             , A.DLV_LT                                                       AS DLV_LT                      /*평균배송일*/
             , TO_CHAR(TO_DATE(A.VLD_STR_DT,'YYYYMMDD'),'YYYYMMDD')           AS VLD_STR_DT                  /*가격유효시작일자*/
             , TO_CHAR(TO_DATE(A.VLD_END_DT,'YYYYMMDD'),'YYYYMMDD')           AS VLD_END_DT                  /*가격유효종료일자*/
             , TO_CHAR(TO_DATE(A.VLD_STR_DT,'YYYYMMDD'),'YYYYMMDD')
               || ' ~ ' ||
               TO_CHAR(TO_DATE(A.VLD_END_DT,'YYYYMMDD'),'YYYY.MM.DD')         AS VLD_DT_DATE                 /*가격유효기간*/
             , A.KC_CERT_YN                                                   AS KC_CERT_YN                  /*KC인증여부*/
             , TO_CHAR(TO_DATE(A.MSDS_FNL_CHG_DT,'YYYYMMDD'),'YYYY.MM.DD')    AS MSDS_FNL_CHG_DT_VIEW        /*최종개정일뷰*/
             , TO_CHAR(TO_DATE(A.MSDS_FNL_CHG_DT,'YYYYMMDD'),'YYYYMMDD')      AS MSDS_FNL_CHG_DT             /*최종개정일*/
             , TO_CHAR(TO_DATE(A.RND_DC_VLD_STR_DTM,'YYYYMMDD'),'YYYY.MM.DD') AS RND_DC_VLD_STR_DTM          /*기간할인유효시작일자*/
             , TO_CHAR(TO_DATE(A.RND_DC_VLD_END_DTM,'YYYYMMDD'),'YYYY.MM.DD') AS RND_DC_VLD_END_DTM          /*기간할인유효종료일자*/
             , TO_CHAR(TO_DATE(A.RND_DC_VLD_STR_DTM,'YYYYMMDD'),'YYYY.MM.DD')
               || ' ~ ' ||
               TO_CHAR(TO_DATE(A.RND_DC_VLD_END_DTM,'YYYYMMDD'),'YYYY.MM.DD') AS RND_DC_VLD_DATE             /*기간할인유효일자*/
             , A.RND_DC_QTY                                                   AS RND_DC_QTY                  /*할인금액*/
             , A.RND_MSDS_URL                                                 AS RND_MSDS_URL                /*URL*/
             , DECODE(A95.DOC_REG_SEQ, NULL, NULL, A.DOC_REG_ID)              AS DOC_REG_ID                  /*문서등록ID*/
             , A95.ATFL_NM                                                    AS ATFL_NM                     /*첨부파일명*/
             , A95.ATFL_STOR_PATH                                             AS ATFL_STOR_PATH              /*첨부파일길이*/
             , A95.ORI_ATFL_NM                                                AS ORI_ATFL_NM                 /*원첨부파일명*/
             
             <!-- [2023.03.13] sg.park - AI-009 MSDS파일 2년경과 갱신처리 -->
             , DECODE(A9A.DOC_REG_SEQ, NULL, NULL, A.DOC_REG_ID)                              LOC_ATTC_FILEID        /*  레터첨부파일ID          */
             , A9A.DOC_REG_SEQ                                                                LOC_ATTC_FILESEQ       
             , A9A.ATFL_NM                                                                    LOC_ATTC_FILENM        
             , A9A.ATFL_STOR_PATH                                                             LOC_ATTC_FILEPATH      
             , A9A.ORI_ATFL_NM                                                                LOC_ATTC_FILE_ORI_NM   
             , TO_CHAR(TO_DATE(A.LOC_ATFL_FNL_CHG_DT, 'YYYYMMDD'), 'YYYY-MM-DD')              LOC_ATFL_FNL_CHG_DT    /*  레터첨부파일최종변경일  */
             , TO_CHAR(        A.LOC_ATFL_UPD_DTM   , 'YYYY-MM-DD HH24:MI:SS'  )              LOC_ATFL_UPD_DTM       /*  레터첨부파일수정일시    */
             , A.LOC_ATTC_FILE_UPDPSN_ID                                                                             /*  레터첨부파일수정자      */
             , (SELECT FN_CC_GET_MBR_IDNM(A.CO_CD, A.LOC_ATTC_FILE_UPDPSN_ID) FROM DUAL)      LOC_ATTC_FILE_UPDPSN_IDNM
             <!-- /[2023.03.13] sg.park - AI-009 MSDS파일 2년경과 갱신처리 -->
             
          FROM      SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO    A
          LEFT JOIN SSP_APP.TB_CO_ATFL_DTLS              A95  ON  A95.DOC_REG_ID=A.DOC_REG_ID AND A95.ETC_FDS_2='95' AND A95.DOC_REG_SEQ=(SELECT MAX(DOC_REG_SEQ) KEEP(DENSE_RANK LAST OERDER BY REG_DTM) FROM SSP_APP.TB_CO_ATFL_DTLS WHERE DOC_REG_ID=A95.DOC_REG_ID AND ETC_FDS_2=A95.ETC_FDS_2)  /*95:MSDS시트*/
          LEFT JOIN SSP_APP.TB_CO_ATFL_DTLS              A9A  ON  A9A.DOC_REG_ID=A.DOC_REG_ID AND A9A.ETC_FDS_2='9A' AND A9A.DOC_REG_SEQ=(SELECT MAX(DOC_REG_SEQ) KEEP(DENSE_RANK LAST OERDER BY REG_DTM) FROM SSP_APP.TB_CO_ATFL_DTLS WHERE DOC_REG_ID=A9A.DOC_REG_ID AND ETC_FDS_2=A9A.ETC_FDS_2)  /*9A:LOC 시트*/
         WHERE A.CO_CD          = #{CO_CD}
           AND A.NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
           
        /* /NewPrdReqLst.selectNewPrdCustReqInfo 신규상품고객요청정보 조회 */
    </select>

    <select id="selectNewPrdPurgQtyDtls" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectNewPrdPurgQtyDtls 신규상품구매물량내역 조회 */
        <![CDATA[
            SELECT A.CO_CD                   /*회사코드*/
                 , A.NEW_PRD_REQ_NO          /*요청번호*/
                 , A.QTY_SEQ                 /*물량순번*/
                 , A.QTY_ITV_STR             /*물량시작구간*/
                 , A.DC_AMT                  /*물량할인금액*/
              FROM SSP_APP.TB_RD_NEW_PRD_PURG_QTY_DTLS A
             WHERE A.CO_CD          = #{CO_CD}
               AND A.NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
        ]]>
    </select>

    <select id="selectBgListInfoInq" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectBgListInfoInq 배지리스트정보 조회 */
        <![CDATA[
            SELECT BG.CO_CD                                                  AS CO_CD              /*회사코드*/
                 , BG.BG_SEQ                                                 AS BG_SEQ             /*배지순번*/
                 , BG.BG_NM                                                  AS BG_NM              /*배지명*/
                 , '('||BG.BG_SEQ||') '||BG.BG_NM                            AS BG_NM_DETAIL       /*(코드)배지명*/
                 , BG.DOC_REG_ID                                             AS DOC_REG_ID         /*문서등록ID*/
                 , DOC.ATFL_STOR_PATH                                        AS ATFL_STOR_PATH     /*첨부파일저장경로*/
                 , DOC.ORI_ATFL_NM                                           AS ORI_ATFL_NM        /*원첨부파일명*/
                 , DOC.ATFL_NM                                               AS ATFL_NM            /*첨부파일명*/
                 , #{CONTEXT_REAL_PATH}||DOC.ATFL_STOR_PATH||DOC.ORI_ATFL_NM AS BG_IMG             /*배지이미지*/
              FROM SSP_APP.TB_SA_BG_INFO        BG
             INNER JOIN SSP_APP.TB_CO_ATFL_DTLS DOC
                ON BG.DOC_REG_ID = DOC.DOC_REG_ID
             WHERE BG.CO_CD      = #{CO_CD}
               AND BG.USE_YN     = 'Y'
             ORDER BY BG_SEQ
        ]]>
    </select>

    <select id="selectCdChkYnInq" parameterType="HashMap" resultType="HashMap">
        /* NewPrdReqLst.selectCdChkYnInq 코드체크여부 조회 */
        <![CDATA[
            SELECT MAX(CTRY_CD_YN) AS CTRY_CD_YN          /*국가코드존재여부*/
                 , MAX(MNFR_NO_YN) AS MNFR_NO_YN          /*제조원코드존재여부*/
              FROM (
                    SELECT CASE WHEN COUNT(1) > 0
                                THEN 'Y'
                                ELSE 'N'
                           END                     AS CTRY_CD_YN
                         , ''                      AS MNFR_NO_YN
                      FROM SSP_APP.TB_CO_CTRY_INFO
                     WHERE CO_CD       = #{CO_CD}
                       AND CTRY_SPR_CD = #{ORGPLC_CTRY_CD}
                     UNION ALL
                    SELECT ''                      AS CTRY_CD_YN
                         , CASE WHEN COUNT(1) > 0
                                THEN 'Y'
                                ELSE 'N'
                           END                     AS MNFR_NO_YN
                      FROM SSP_APP.TB_PR_MNFR_INFO
                     WHERE CO_CD   = #{CO_CD}
                       AND MNFR_NO = #{MNFR_NO}
                   )
        ]]>
    </select>

	<select id="selectPrdIdExstYn" parameterType="HashMap" resultType="String">
		/* NewPrdReqLst.selectPrdIdExstYn | 상품 ID 존재 여부, 진열 여부 조회 */
		WITH
			CNT AS (
				SELECT COUNT(1) AS CNT
				FROM SSP_APP.TB_PR_PRD_INFO PRD
				WHERE PRD.CO_CD  = #{CO_CD}
				AND PRD.PRD_ID = LPAD(#{PRD_ID}, 18, 0)
			)
			, DISP_STATS AS (
								SELECT 'X'
	                            FROM TB_DP_PRD_DISP_STATS_INFO 
				WHERE CO_CD = #{CO_CD}
	                            AND PRD_ID = LPAD(#{PRD_ID}, 18, 0) 
				AND BZPLC_ID = '*'
				AND OPR_UNIT_ID = '*'
				AND DISP_STATS_CD = '10'    /* 진열 */
							)
		<![CDATA[
		SELECT
			CASE
				WHEN (SELECT * FROM CNT) < 1 THEN 'N'               /* 상품 ID 존재 확인 */
				WHEN (SELECT * FROM DISP_STATS) IS NULL THEN 'I'				/* 진열여부 확인 */
				ELSE 'Y'
			END AS PRD_ID_EXST_YN
		FROM DUAL
		]]>
	</select>

	<select id="selectNewPrdReqNoPKey" parameterType="HashMap" resultType="HashMap">
		/* NewPrdReqLst.selectNewPrdReqNoPKey | 신규 상품 요청번호 PK 생성 */
		<![CDATA[
		SELECT 'RR' || LPAD(SQ_PR_NEW_PRD_CUST_REQ_INFO_01.NEXTVAL,8,'0') AS NEW_PRD_REQ_NO FROM DUAL
		]]>
	</select>

	<select id="selectNewPrdIdPKey" parameterType="HashMap" resultType="HashMap">
		/* NewPrdReqLst.selectNewPrdIdPKey | 신규 상품 ID PK 생성 */
		<![CDATA[
		SELECT LPAD(SQ_PR_PR_PRD_INFO_01.NEXTVAL, 18, '0') AS RND_REQ_PRD_ID FROM DUAL
		]]>
	</select>

    <update id="insertNewPrdReqLst" parameterType="HashMap">
        /* NewPrdReqLst.insertNewPrdReqLst 신규상품요청처리(자사) 저장 */
        BEGIN
        <![CDATA[
            INSERT INTO SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , REQ_PRD_NM                  /*요청상품명*/
            , MNFR_NO                     /*제조사번호*/
            , ORGPLC_CTRY_CD              /*원산지국가코드*/
            , HPE_SELL_UPRC               /*희망판매단가*/
            , HPE_SELL_UNIT_CD            /*희망판매단위코드*/
            , HPE_SELL_UNIT_QTY           /*희망판매단위수량*/
            , PRD_CLCD                    /*상품분류코드*/
            , DOC_REG_ID                  /*문서등록ID*/
            , CHM_MTL_YN                  /*화학물질여부*/
            , PUB_ONLY_SPR_CD             /*공용전용구분코드*/
            , REQ_RSN                     /*요청사유*/
            , RND_TX_CLCD                 /*RND세금분류코드*/
            , RND_HUB_HNL_DIS_TP_CD       /*RND허브취급불가유형코드*/
            , REQ_SBJ_CD                  /*요청주체코드*/
            , DSTRB_STD_PRC               /*유통표준가격*/
            , DLV_AMT                     /*배송금액*/
            , DLV_LT                      /*배송리드타임*/
            , VLD_STR_DT                  /*유효시작일자*/
            , VLD_END_DT                  /*유효종료일자*/
            , KC_CERT_YN                  /*KC인증여부*/
            , MSDS_FNL_CHG_DT             /*MSDS최종변경일자*/
            , RND_DC_QTY                  /*RND할인수량*/
            , RND_DC_SPR_CD               /*RND할인구분코드*/
            , RND_DC_VLD_STR_DTM          /*RND할인유효시작일시*/
            , RND_DC_VLD_END_DTM          /*RND할인유효종료일시*/
            , CONT_NO                     /*계약번호*/
            , CONT_CHG_DGRCNT             /*계약변경차수*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            , MIN_ODR_QTY                 /*최소주문수량*/
            , HPE_BASIS_UNIT_CD           /*희망기본단위코드*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , #{REQ_PRD_NM}
            , #{MNFR_NO}
            , #{ORGPLC_CTRY_CD}
            , #{HPE_SELL_UPRC}
            , NVL(#{SELL_UNIT_CD},#{BASIS_UNIT_CD})
            , #{BASIS_UNIT_QTY}
            , #{PRD_CLCD}
            , #{PPI_DOC_REG_ID}
            , #{CHM_MTL_YN}
            , #{PUB_ONLY_SPR_CD}
            , #{REQ_RSN}
            , #{TX_CLCD}
            , #{RND_HUB_HNL_DIS_TP_CD}
            , #{REQ_SBJ_CD}
            , #{DSTRB_STD_PRC}
            , #{DLV_AMT}
            , #{DLV_LT}
            , #{VLD_STR_DT}
            , #{VLD_END_DT}
            , #{KC_CERT_YN}
            , #{MSDS_FNL_CHG_DT}
            , #{RND_DC_QTY}
            , #{RND_DC_SPR_CD}
            , #{RND_DC_VLD_STR_DTM}
            , #{RND_DC_VLD_END_DTM}
            , #{CONT_NO}
            , #{CONT_CHG_DGRCNT}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            , #{MIN_ODR_QTY}
            , #{BASIS_UNIT_CD}
            );

            INSERT INTO SSP_APP.TB_PR_NEW_PRD_REQ_PROC
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , REQ_PRD_NM                  /*요청상품명*/
            , PRD_CLCD                    /*상품분류코드*/
            , PUB_ONLY_SPR_CD             /*공용전용구분코드*/
            , BASIS_UNIT_CD               /*기본단위코드*/
            , BASIS_UNIT_QTY              /*기본단위수량*/
            , SELL_UNIT_CD                /*판매단위코드*/
            , ORGPLC_CTRY_CD              /*원산지국가코드*/
            , MNFR_NO                     /*제조사번호*/
            , DOC_REG_ID                  /*문서등록ID*/
            , MRO_REQ_NO                  /*MRO요청번호*/
            , MRO_PROC_STATS_CD           /*MRO처리상태코드*/
            , MRO_DUP_PRD_ID              /*MRO중복상품ID*/
            , MRO_PRD_ID                  /*MRO상품ID*/
            , EXCEPT_END_RSN              /*예외종료사유*/
            , PRD_REG_DIS_TP_CD           /*상품등록불가유형코드*/
            , REG_DIS_RSN                 /*등록불가사유*/
            , PRD_PRPS_SPR_CD             /*상품제안구분코드*/
            , PRD_PRPS_STATS_CD           /*상품제안상태코드*/
            , ALT_PRPS_RSN                /*대체제안사유*/
            , CUST_RJT_RSN                /*고객거부사유*/
            , PRPS_PRD_ID                 /*제안상품ID*/
            , TRSF_RSN                    /*이관사유*/
            , MALL_SPR_CD                 /*몰구분코드*/
            , ESTM_REQ_NO                 /*견적요청번호*/
            , UPD_RSN                     /*수정사유*/
            , RND_REQ_PRD_ID              /*RND요청상품ID*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , #{REQ_PRD_NM}
            , #{PRD_CLCD}
            , #{PUB_ONLY_SPR_CD}
            , #{BASIS_UNIT_CD}
            , #{BASIS_UNIT_QTY}
            , NVL(#{SELL_UNIT_CD},#{BASIS_UNIT_CD})
            , #{ORGPLC_CTRY_CD}
            , #{MNFR_NO}
            , #{PPI_DOC_REG_ID}
            , #{MRO_REQ_NO}
            , #{MRO_PROC_STATS_CD}
            , #{MRO_DUP_PRD_ID}
            , #{MRO_PRD_ID}
            , #{EXCEPT_END_RSN}
            , #{PRD_REG_DIS_TP_CD}
            , #{REG_DIS_RSN}
            , #{PRD_PRPS_SPR_CD}
            , #{PRD_PRPS_STATS_CD}
            , #{ALT_PRPS_RSN}
            , #{CUST_RJT_RSN}
            , #{PRPS_PRD_ID}
            , #{TRSF_RSN}
            , #{MALL_SPR_CD}
            , #{ESTM_REQ_NO}
            , #{UPD_RSN}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PR_PRD_INFO
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , PRD_NM                      /*상품명*/
            , MALL_SPR_CD                 /*몰구분코드*/
            , PRC_APLY_SPR_CD             /*가격적용구분코드*/
            , NOTI_ITM_ID                 /*고시품목ID*/
            , BRND_NM                     /*브랜드명*/
            , SSP_REPR_ATTR               /*SSP대표속성*/
            , PRD_CLCD                    /*상품분류코드*/
            , PRD_USE_YN                  /*상품사용여부*/
            , DOC_REG_ID                  /*문서등록ID*/
            , PRD_DTL_DESC                /*상품상세설명*/
            , HASH_TAG                    /*해시태그*/
            , PRD_NUSE_RSN_CD             /*상품미사용사유코드*/
            , BG_SEQ                      /*배지순번*/
            , BG_APLY_STR_DTM             /*배지적용시작일시*/
            , BG_APLY_END_DTM             /*배지적용종료일시*/
            , MRO_CRT_YN                  /*MRO생성여부*/
            , RND_MSDS_URL                /*RNDMSDSURL*/
            , UPD_RSN                     /*수정사유*/
            /* 2023.06.21 이상민 : 재고API사용여부, 협력사ID, 협력사SKU 추가 */
            , INVN_API_USE_YN
            , CPRTCP_ID
            , CPRTCP_PRD_ID
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            , RND_DISP_PRD_YN             /*전시상품여부*/
            )
            VALUES
            (
              #{CO_CD}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , REPLACE(REPLACE(#{REQ_PRD_NM}, CHR(13), ''), CHR(10), '') 
            , #{MALL_SPR_CD}
            , NVL(#{PRC_APLY_SPR_CD},'20')
            , #{NOTI_ITM_ID}
            , #{BRND_NM}
            , #{NEW_PRD_REQ_PRVL_LIST}
            , #{PRD_CLCD}
            , 'Y'
            , #{PPI_DOC_REG_ID}
            , #{PRD_DTL_DESC}
            , #{HASH_TAG}
            , #{PRD_NUSE_RSN_CD}
            , #{BG_SEQ}
            , TO_DATE(#{BG_APLY_STR_DTM},'YYYYMMDD')
            , TO_DATE(#{BG_APLY_END_DTM},'YYYYMMDD')
            , 'C'
            , #{RND_MSDS_URL}
            , #{UPD_RSN}
             /* 2023.06.21 이상민 : 재고API사용여부, 협력사ID, 협력사SKU 추가 */
            , CASE WHEN #{INVN_API_USE_YN} IN ('%', NULL) THEN 'N' ELSE #{INVN_API_USE_YN} END
            , #{CPRTCP_ID}
            , #{CPRTCP_PRD_ID}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            , #{RND_DISP_PRD_YN}
            );

            INSERT INTO SSP_APP.TB_PR_MRO_PRD_INFO
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , PRD_NM                      /*상품명*/
            , ORGPLC_CTRY_CD              /*원산지국가코드*/
            , CHM_MTL_PRD_YN              /*화학물질상품여부*/
            , MSDS_DOC_REG_ID             /*MSDS문서등록ID*/
            , MRO_REPR_ATTR               /*MRO대표속성*/
            , SELL_UNIT_CD                /*판매단위코드*/
            , BASIS_UNIT_CD               /*기본단위코드*/
            , SELL_UNIT_QTY               /*판매단위수량*/
            , BASIS_UNIT_QTY              /*기본단위수량*/
            , MULT_SELL_UNIT_QTY          /*배수판매단위수량*/
            , MNFR_NO                     /*제조사번호*/
            , HUB_HNL_PSB_YN              /*허브취급가능여부*/
            , MRO_PRD_CLCD                /*MRO상품분류코드*/
            , TX_CLCD                     /*세금분류코드*/
            , PURG_CHRPSN_ID              /*구매담당자ID*/
            , MDEL_NO                     /*모델번호*/
            , DLV_LT                      /*배송리드타임*/
            , STPRC                       /*기준가*/
            , MRO_PRD_STATS_CD            /*MRO상품상태코드*/
            , MRO_PRD_DTL_DESC            /*MRO상품상세설명*/
            , MSDS_FST_WRT_DTM            /*MSDS최초작성일시*/
            , MSDS_FNL_CHG_DTM            /*MSDS최종변경일시*/
            , HRM_CHM_MTL_YN              /*유해화학물질여부*/
            , MSDS_FNL_CHG_DT             /*MSDS최종변경일자*/
            , MTL_GRAVITY                 /*물질비중*/
            , DNGR_MTL_NO                 /*위험물질번호*/
            , HUB_HNL_DIS_TP_CD           /*허브취급불가유형코드*/
            , PHASE_SPR_CD                /*성상구분코드*/
            , MALL_SPR_CD                 /*몰구분코드*/
            , PUB_ONLY_SPR_CD             /*공용전용구분코드*/
            , SSP_PRD_REG_REQ_ID          /*SSP상품등록요청ID*/
            , QCK_DLV_YN                  /*퀵배송여부*/
            , TRG_DLV_LT                  /*목표배송리드타임*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , REPLACE(REPLACE(#{REQ_PRD_NM}, CHR(10), ''), CHR(13), '') 
            , #{ORGPLC_CTRY_CD}
            , #{CHM_MTL_YN}
            , #{PPI_DOC_REG_ID}
            , #{MRO_REPR_ATTR}
            , NVL(#{SELL_UNIT_CD},#{BASIS_UNIT_CD})
            , #{BASIS_UNIT_CD}
            , '1'
            , #{BASIS_UNIT_QTY}
            , #{MULT_SELL_UNIT_QTY}
            , #{MNFR_NO}
            , #{HUB_HNL_PSB_YN}
            , (
               SELECT S1.MRO_PRD_CLCD
                 FROM SSP_APP.TB_PR_PRD_CLSF_INFO S1
                WHERE S1.CO_CD    = #{CO_CD}
                  AND S1.PRD_CLCD = #{PRD_CLCD}
              )
            , #{TX_CLCD}
            , #{PURG_CHRPSN_ID}
            , #{MDEL_NO}
            , #{DLV_LT}
            , #{HPE_SELL_UPRC}
            , '00'
            , #{PRD_DTL_DESC}
            , TO_DATE(#{MSDS_FST_WRT_DTM},'YYYYMMDD')
            , TO_DATE(#{MSDS_FNL_CHG_DTM},'YYYYMMDD')
            , #{HRM_CHM_MTL_YN}
            , #{MSDS_FNL_CHG_DT}
            , #{MTL_GRAVITY}
            , #{DNGR_MTL_NO}
            , #{RND_HUB_HNL_DIS_TP_CD}
            , #{PHASE_SPR_CD}
            , #{MALL_SPR_CD}
            , #{PUB_ONLY_SPR_CD}
            , #{NEW_PRD_REQ_NO}
            , #{QCK_DLV_YN}
            , #{TRG_DLV_LT}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PC_PRD_PRC_HST
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , BZPLC_ID                    /*사업장ID*/
            , SEQ                         /*순번*/
            , STPRC                       /*기준가*/
            , DSTRB_STD_PRC               /*유통표준가격*/
            , BSS_SALSPRC_STR_DTM         /*기준판매가시작일시*/
            , BSS_SALSPRC_END_DTM         /*기준판매가종료일시*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , '*'
            , (
               SELECT NVL(MAX(S1.SEQ),0)+1
                 FROM SSP_APP.TB_PC_PRD_PRC_HST S1
                WHERE S1.CO_CD    = #{CO_CD}
                  AND S1.PRD_ID   = LPAD(#{RND_REQ_PRD_ID},18,0)
                  AND S1.BZPLC_ID = '*'
              )
            , #{HPE_SELL_UPRC}
            , #{DSTRB_STD_PRC}
            , TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
            , '99991231235959'
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>

	<insert id="insertNewPrdReqStatsDtls" parameterType="HashMap">
		/* NewPrdReqLst.insertNewPrdReqStatsDtls 신규상품요청상태내역 저장 */
		<![CDATA[
		INSERT INTO SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS (
			CO_CD                       /*회사코드*/
			, NEW_PRD_REQ_NO              /*신규상품요청번호*/
			, SEQ                         /*순번*/
			, NEW_PRD_REQ_STATS_CD        /*신규상품요청상태코드*/
			, MALL_SPR_CD                 /*몰구분코드*/
			, REGPSN_ID                   /*등록자ID*/
			, REG_DTM                     /*등록일시*/
			, UPDPSN_ID                   /*수정자ID*/
			, UPD_DTM                     /*수정일시*/
		) VALUES (
			#{CO_CD}
			, #{NEW_PRD_REQ_NO}
			, (
				SELECT NVL(MAX(TO_NUMBER(SEQ)) + 1, '1')
				FROM SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS
				WHERE CO_CD = #{CO_CD}
				AND NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
			)
			, #{NEW_PRD_REQ_STATS_CD}
			, #{MALL_SPR_CD}
			, #{REGPSN_ID}
			, SYSDATE
			, #{UPDPSN_ID}
			, SYSDATE
		)
		]]>
	</insert>

    <update id="insertNewPrdCustReqAttrInfo" parameterType="HashMap">
        /* NewPrdReqLst.insertNewPrdCustReqAttrInfo 신규상품고객요청속성정보 저장 */
        BEGIN
        <![CDATA[
            INSERT INTO SSP_APP.TB_PR_NEW_PRD_CUST_REQ_ATTR_INFO
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , INTG_ATTR_CD                /*통합속성코드*/
            , NEW_PRD_REQ_PRVL            /*신규상품요청속성값*/
            , INTG_ATTR_SPR_CD            /*통합속성구분코드*/
            , SRT_SO                      /*정렬순서*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , #{PRD_ATTR_CD}
            , #{NEW_PRD_REQ_PRVL}
            , '20'
            , #{SRT_SO}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , INTG_ATTR_CD                /*통합속성코드*/
            , PRD_CLCD                    /*상품분류코드*/
            , NEW_PRD_REQ_PRVL            /*신규상품요청속성값*/
            , INTG_ATTR_SPR_CD            /*통합속성구분코드*/
            , SRT_SO                      /*정렬순서*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , #{PRD_ATTR_CD}
            , #{PRD_CLCD}
            , #{NEW_PRD_REQ_PRVL}
            , '20'
            , #{SRT_SO}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PR_PRD_INFO_ATTR_MAPP
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , PRD_ATTR_CD                 /*상품속성코드*/
            , SRT_SO                      /*정렬순서*/
            , PRVL                        /*속성값*/
            , UPD_RSN                     /*수정사유*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{PRD_ID}
            , #{PRD_ATTR_CD}
            , #{SRT_SO}
            , #{NEW_PRD_REQ_PRVL}
            , #{UPD_RSN}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>

    <update id="insertRegProcPrdNotiItmMapp" parameterType="HashMap">
        /* NewPrdReqLst.insertRegProcPrdNotiItmMapp 등록처리상품고시품목매핑 저장 */
        BEGIN
        <![CDATA[
            INSERT INTO SSP_APP.TB_PR_REG_PROC_PRD_NOTI_ITM_MAPP
            (
              CO_CD                       /*회사코드*/
            , NOTI_ITM_ID                 /*고시품목ID*/
            , NOTI_ITM_DTL_NO             /*고시품목상세번호*/
            , PRD_ID                      /*상품ID*/
            , PRD_NOTI_ITM_MAPP_CTS       /*상품고시품목매핑내용*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NOTI_ITM_ID}
            , #{NOTI_ITM_DTL_NO}
            , #{RND_REQ_PRD_ID}
            , #{PRD_NOTI_ITM_MAPP_CTS}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PR_PRD_NOTI_ITM_MAPP
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , NOTI_ITM_ID                 /*고시품목ID*/
            , NOTI_ITM_DTL_NO             /*고시품목상세번호*/
            , PRD_NOTI_ITM_MAPP_CTS       /*상품고시품목매핑내용*/
            , UPD_RSN                     /*수정사유*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{RND_REQ_PRD_ID}
            , #{NOTI_ITM_ID}
            , #{NOTI_ITM_DTL_NO}
            , #{PRD_NOTI_ITM_MAPP_CTS}
            , #{UPD_RSN}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>

    <update id="updateNewPrdReqRjctProc" parameterType="HashMap">
        /* NewPrdReqLst.updateNewPrdReqRjctProc 신규상품요청반려처리 수정 */
        BEGIN
        <![CDATA[
            UPDATE SSP_APP.TB_PR_NEW_PRD_REQ_PROC
               SET PRD_REG_DIS_TP_CD = #{PRD_REG_DIS_TP_CD}           /*상품등록불가유형코드*/
                 , REG_DIS_RSN       = #{REG_DIS_RSN}                 /*등록불가사유*/
                 , MALL_SPR_CD       = NVL(#{MALL_SPR_CD}, '20')       /*몰구분코드*/
                 , UPDPSN_ID         = #{UPDPSN_ID}                   /*수정자ID*/
                 , UPD_DTM           = SYSDATE                        /*수정일시*/
             WHERE CO_CD             = #{CO_CD}
               AND NEW_PRD_REQ_NO    = #{NEW_PRD_REQ_NO};

            INSERT INTO SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , SEQ                         /*순번*/
            , NEW_PRD_REQ_STATS_CD        /*신규상품요청상태코드*/
            , MALL_SPR_CD                 /*몰구분코드*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , (
               SELECT NVL(MAX(TO_NUMBER(SEQ))+1,'1')
                 FROM SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS
                WHERE CO_CD          = #{CO_CD}
                  AND NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
              )
            , '42'
            , NVL(#{MALL_SPR_CD},'20')
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>

	<update id="insertCprtcpDupPrdProcStor" parameterType="HashMap">
		/* NewPrdReqLst.insertCprtcpDupPrdProcStor | 협력사중복상품처리저장 */
		<![CDATA[
		BEGIN
			INSERT INTO SSP_APP.TB_PC_CPRTCP_PRD_PRC_INFO (
				CO_CD                       /*회사코드*/
				, CPRTCP_ID                   /*협력사ID*/
				, PRD_ID                      /*상품ID*/
				, PRD_PRC_SEQ                 /*상품가격순번*/
				, CURR_UNIT_CD                /*통화단위코드*/
				, PRD_PRC                     /*상품가격*/
				, VLD_STR_DT                  /*유효시작일자*/
				, VLD_END_DT                  /*유효종료일자*/
				, REGPSN_ID                   /*등록자ID*/
				, REG_DTM                     /*등록일시*/
				, UPDPSN_ID                   /*수정자ID*/
				, UPD_DTM                     /*수정일시*/
			) VALUES (
				#{CO_CD}
				, #{CPRTCP_ID}
				, LPAD(#{PRD_ID},18,0)
				, (
					SELECT NVL(MAX(TO_NUMBER(PRD_PRC_SEQ))+1 ,'1')
					FROM SSP_APP.TB_PC_CPRTCP_PRD_PRC_INFO
					WHERE CO_CD = #{CO_CD}
					AND CPRTCP_ID = #{CPRTCP_ID}
					AND PRD_ID = LPAD(#{PRD_ID},18,0)
				)
				, 'KRW'
				, #{HPE_SELL_UPRC}
				, #{VLD_STR_DT}
				, #{VLD_END_DT}
				, #{REGPSN_ID}
				, SYSDATE
				, #{UPDPSN_ID}
				, SYSDATE
			)
			;

			DELETE FROM SSP_APP.TB_PC_CPRTCP_PRD_INFO
			WHERE CO_CD = #{CO_CD}
			AND CPRTCP_ID = #{CPRTCP_ID}
			AND PRD_ID = LPAD(#{PRD_ID}, 18, 0)
			;

			INSERT INTO SSP_APP.TB_PC_CPRTCP_PRD_INFO (
				CO_CD                       /*회사코드*/
				, CPRTCP_ID                   /*협력사ID*/
				, PRD_ID                      /*상품ID*/
				, ORD_CURR_CD                 /*발주통화코드*/
				, MIN_ODR_QTY                 /*최소주문수량*/
				, SPL_PSB_YN                  /*공급가능여부*/
				, PURG_CHRPSN_ID              /*구매담당자ID*/
				, RND_MSDS_URL                /*MSDS URL*/
				, MSDS_ATTC_FILEID            /*MSDS첨부파일ID*/
				, MSDS_FNL_CHG_DT             /*MSDS최종변경일자*/
				, DLV_LT                      /*배송리드타임*/
				, REGPSN_ID                   /*등록자ID*/
				, REG_DTM                     /*등록일시*/
				, UPDPSN_ID                   /*수정자ID*/
				, UPD_DTM                     /*수정일시*/
			) VALUES (
				#{CO_CD}
				, #{CPRTCP_ID}
				, LPAD(#{PRD_ID}, 18, 0)
				, 'KRW'
				, #{MIN_ODR_QTY}
				, 'Y'
				, #{PURG_CHRPSN_ID}
				, #{RND_MSDS_URL}
				, #{DOC_REG_ID}
				, #{MSDS_FNL_CHG_DT}
				, #{DLV_LT}
				, #{REGPSN_ID}
				, SYSDATE
				, #{UPDPSN_ID}
				, SYSDATE
			)
			;

		]]>
			UPDATE SSP_APP.TB_PR_NEW_PRD_REQ_PROC
			SET
				RND_REQ_PRD_ID = LPAD(#{RND_REQ_PRD_ID}, 18, 0)   /* RND요청상품ID */
				<if test="PRD_PRPS_SPR_CD != null and PRD_PRPS_SPR_CD != ''">
					, PRD_PRPS_SPR_CD = #{PRD_PRPS_SPR_CD}               /* 중복상품 제안코드 */
					, PRPS_PRD_ID = LPAD(#{RND_REQ_PRD_ID}, 18, 0)      /* 제안 상품ID */
				</if>
		<![CDATA[
				, UPDPSN_ID = #{UPDPSN_ID}
				, UPD_DTM = SYSDATE
			WHERE CO_CD = #{CO_CD}
			AND NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
			;
		END;
		]]>
	</update>

	<update id="insertCprtcpRegStor" parameterType="HashMap">
        /* NewPrdReqLst.insertCprtcpRegStor 협력사등록저장 */
        BEGIN
        <![CDATA[
            UPDATE SSP_APP.TB_PR_NEW_PRD_REQ_PROC
               SET REQ_PRD_NM      = #{REQ_PRD_NM}                                        /*요청상품명*/
                 , PRD_CLCD        = #{PRD_CLCD}                                          /*상품분류코드*/
                 , PUB_ONLY_SPR_CD = #{PUB_ONLY_SPR_CD}                                   /*공용전용구분코드*/
                 , BASIS_UNIT_CD   = #{BASIS_UNIT_CD}                                     /*기본단위코드*/
                 , BASIS_UNIT_QTY  = #{BASIS_UNIT_QTY}                                    /*기본단위수량*/
                 , SELL_UNIT_CD    = NVL(#{SELL_UNIT_CD},#{BASIS_UNIT_CD})                /*판매단위코드*/
                 , ORGPLC_CTRY_CD  = #{ORGPLC_CTRY_CD}                                    /*원산지국가코드*/
                 , MNFR_NO         = #{MNFR_NO}                                           /*제조사번호*/
                 , DOC_REG_ID      = #{PPI_DOC_REG_ID}                                    /*문서등록ID*/
                 , RND_REQ_PRD_ID  = #{RND_REQ_PRD_ID}                                    /*RND요청상품ID*/
                 , UPDPSN_ID       = #{UPDPSN_ID}                                         /*수정자ID*/
                 , UPD_DTM         = SYSDATE                                              /*수정일시*/
             WHERE CO_CD           = #{CO_CD}
               AND NEW_PRD_REQ_NO  = #{NEW_PRD_REQ_NO};

            UPDATE SSP_APP.TB_PR_NEW_PRD_CUST_REQ_INFO
               SET RND_HUB_HNL_DIS_TP_CD = #{RND_HUB_HNL_DIS_TP_CD}       /*RND허브취급불가유형코드*/
                 , UPDPSN_ID             = #{UPDPSN_ID}                   /*수정자ID*/
                 , UPD_DTM               = SYSDATE                        /*수정일시*/
             WHERE CO_CD                 = #{CO_CD}
               AND NEW_PRD_REQ_NO        = #{NEW_PRD_REQ_NO};

            INSERT INTO SSP_APP.TB_PR_PRD_INFO
            (
              CO_CD                     /* 회사코드		*/
            , PRD_ID                    /* 상품ID			*/
            , PRD_NM                    /* 상품명			*/
            , MALL_SPR_CD               /* 몰구분코드		*/
            , PRC_APLY_SPR_CD           /* 가격적용구분코드	*/
            , NOTI_ITM_ID               /* 고시품목ID		*/
            , BRND_NM                   /* 브랜드명		*/
            , SSP_REPR_ATTR             /* SSP대표속성		*/
            , PRD_CLCD                  /* 상품분류코드		*/
            , PRD_USE_YN                /* 상품사용여부		*/
            , DOC_REG_ID                /* 문서등록ID		*/
            , PRD_DTL_DESC              /* 상품상세설명		*/
            , HASH_TAG                  /* 해시태그		*/
            , PRD_NUSE_RSN_CD           /* 상품미사용사유코드	*/
            , BG_SEQ                    /* 배지순번		*/
            , BG_APLY_STR_DTM           /* 배지적용시작일시	*/
            , BG_APLY_END_DTM           /* 배지적용종료일시	*/
            , MRO_CRT_YN                /* MRO생성여부		*/
            , RND_MSDS_URL              /* RNDMSDSURL	*/
            , UPD_RSN                   /* 수정사유		*/
            /* 2023.06.21 이상민 : 재고API사용여부, 협력사ID, 협력사SKU 추가 */
            , INVN_API_USE_YN			/* 재고API사용여부	*/
            , CPRTCP_ID					/* 협력사ID		*/
            , CPRTCP_PRD_ID				/* 협력사SKU		*/
            , REGPSN_ID                 /* 등록자ID		*/
            , REG_DTM                   /* 등록일시		*/
            , UPDPSN_ID                 /* 수정자ID		*/
            , UPD_DTM                   /* 수정일시		*/
            , RND_DISP_PRD_YN           /* 전시상품여부   */
            )
            VALUES
            (
              #{CO_CD}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , REPLACE(REPLACE(#{REQ_PRD_NM}, CHR(10), ''), CHR(13), '') 
            , #{MALL_SPR_CD}
            , NVL(#{PRC_APLY_SPR_CD},'20')
            , #{NOTI_ITM_ID}
            , #{BRND_NM}
            , #{NEW_PRD_REQ_PRVL_LIST}
            , #{PRD_CLCD}
            , 'Y'
            , #{PPI_DOC_REG_ID}
            , #{PRD_DTL_DESC}
            , #{HASH_TAG}
            , #{PRD_NUSE_RSN_CD}
            , #{BG_SEQ}
            , TO_DATE(#{BG_APLY_STR_DTM},'YYYYMMDD')
            , TO_DATE(#{BG_APLY_END_DTM},'YYYYMMDD')
            , 'C'
            , #{RND_MSDS_URL}            
            , #{UPD_RSN}
            /* 2023.06.21 이상민 : 재고API사용여부, 협력사ID, 협력사SKU 추가 */
            , CASE WHEN #{INVN_API_USE_YN} IN ('%', NULL) THEN 'N' ELSE #{INVN_API_USE_YN} END
            , #{CPRTCP_ID}
            , #{CPRTCP_PRD_ID}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            , #{RND_DISP_PRD_YN}
            );

            INSERT INTO SSP_APP.TB_PR_MRO_PRD_INFO
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , PRD_NM                      /*상품명*/
            , ORGPLC_CTRY_CD              /*원산지국가코드*/
            , CHM_MTL_PRD_YN              /*화학물질상품여부*/
            , MSDS_DOC_REG_ID             /*MSDS문서등록ID*/
            , MRO_REPR_ATTR               /*MRO대표속성*/
            , SELL_UNIT_CD                /*판매단위코드*/
            , BASIS_UNIT_CD               /*기본단위코드*/
            , SELL_UNIT_QTY               /*판매단위수량*/
            , BASIS_UNIT_QTY              /*기본단위수량*/
            , MULT_SELL_UNIT_QTY          /*배수판매단위수량*/
            , MNFR_NO                     /*제조사번호*/
            , HUB_HNL_PSB_YN              /*허브취급가능여부*/
            , MRO_PRD_CLCD                /*MRO상품분류코드*/
            , TX_CLCD                     /*세금분류코드*/
            , PURG_CHRPSN_ID              /*구매담당자ID*/
            , MDEL_NO                     /*모델번호*/
            , DLV_LT                      /*배송리드타임*/
            , STPRC                       /*기준가*/
            , MRO_PRD_STATS_CD            /*MRO상품상태코드*/
            , MRO_PRD_DTL_DESC            /*MRO상품상세설명*/
            , MSDS_FST_WRT_DTM            /*MSDS최초작성일시*/
            , MSDS_FNL_CHG_DTM            /*MSDS최종변경일시*/
            , HRM_CHM_MTL_YN              /*유해화학물질여부*/
            , MSDS_FNL_CHG_DT             /*MSDS최종변경일자*/
            , MTL_GRAVITY                 /*물질비중*/
            , DNGR_MTL_NO                 /*위험물질번호*/
            , HUB_HNL_DIS_TP_CD           /*허브취급불가유형코드*/
            , PHASE_SPR_CD                /*성상구분코드*/
            , MALL_SPR_CD                 /*몰구분코드*/
            , PUB_ONLY_SPR_CD             /*공용전용구분코드*/
            , SSP_PRD_REG_REQ_ID          /*SSP상품등록요청ID*/
            , QCK_DLV_YN                  /*퀵배송여부*/
            , TRG_DLV_LT                  /*목표배송리드타임*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , REPLACE(REPLACE(#{REQ_PRD_NM}, CHR(10), ''), CHR(13), '') 
            , #{ORGPLC_CTRY_CD}
            , #{CHM_MTL_YN}
            , #{PPI_DOC_REG_ID}
            , #{MRO_REPR_ATTR}
            , NVL(#{SELL_UNIT_CD},#{BASIS_UNIT_CD})
            , #{BASIS_UNIT_CD}
            , '1'
            , #{BASIS_UNIT_QTY}
            , #{MULT_SELL_UNIT_QTY}
            , #{MNFR_NO}
            , #{HUB_HNL_PSB_YN}
            , (
               SELECT S1.MRO_PRD_CLCD
                 FROM SSP_APP.TB_PR_PRD_CLSF_INFO S1
                WHERE S1.CO_CD    = #{CO_CD}
                  AND S1.PRD_CLCD = #{PRD_CLCD}
              )
            , #{TX_CLCD}
            , #{PURG_CHRPSN_ID}
            , #{MDEL_NO}
            , #{DLV_LT}
            , #{HPE_SELL_UPRC}
            , '00'
            , #{PRD_DTL_DESC}
            , TO_DATE(#{MSDS_FST_WRT_DTM},'YYYYMMDD')
            , TO_DATE(#{MSDS_FNL_CHG_DTM},'YYYYMMDD')
            , #{HRM_CHM_MTL_YN}
            , #{MSDS_FNL_CHG_DT}
            , #{MTL_GRAVITY}
            , #{DNGR_MTL_NO}
            , #{RND_HUB_HNL_DIS_TP_CD}
            , #{PHASE_SPR_CD}
            , #{MALL_SPR_CD}
            , #{PUB_ONLY_SPR_CD}
            , #{NEW_PRD_REQ_NO}
            , #{QCK_DLV_YN}
            , #{TRG_DLV_LT}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PC_PRD_PRC_HST
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , BZPLC_ID                    /*사업장ID*/
            , SEQ                         /*순번*/
            , STPRC                       /*기준가*/
            , DSTRB_STD_PRC               /*유통표준가격*/
            , BSS_SALSPRC_STR_DTM         /*기준판매가시작일시*/
            , BSS_SALSPRC_END_DTM         /*기준판매가종료일시*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , LPAD(#{RND_REQ_PRD_ID},18,0)
            , '*'
            , (
               SELECT NVL(MAX(S1.SEQ),0)+1
                 FROM SSP_APP.TB_PC_PRD_PRC_HST S1
                WHERE S1.CO_CD    = #{CO_CD}
                  AND S1.PRD_ID   = LPAD(#{RND_REQ_PRD_ID},18,0)
                  AND S1.BZPLC_ID = '*'
              )
            , #{HPE_SELL_UPRC}
            , #{DSTRB_STD_PRC}
            , TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS')
            , '99991231235959'
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>

    <delete id="deletePrcCondDtls" parameterType="HashMap">
        /* NewPrdReqLst.deletePrcCondDtls 가격조건내역 삭제 */
        <![CDATA[
            DELETE FROM SSP_APP.TB_PC_PRC_COND_DTLS
             WHERE 1=1
               AND CO_CD     = #{CO_CD}
               AND CPRTCP_ID = #{CPRTCP_ID}
               AND PRD_ID    = LPAD(#{PRD_ID},18,0)
        ]]>
    </delete>

	<insert id="insertPrcCondDtls" parameterType="HashMap">
		/* NewPrdReqLst.insertPrcCondDtls | 가격조건내역 저장 */
		<![CDATA[
		INSERT INTO SSP_APP.TB_PC_PRC_COND_DTLS (
			CO_CD /*회사코드*/
			, CPRTCP_ID /*협력사ID*/
			, PRD_ID /*상품ID*/
			, PRC_COND_SEQ /*가격조건순번*/
			, STR_QTY_CNT /*시작물량개수*/
			, END_QTY_CNT /*종료물량개수*/
			, PERD_STR_DT /*기간시작일자*/
			, PERD_END_DT /*기간종료일자*/
			, DC_AMT /*할인금액*/
			, DC_EXTR_CD /*할인할증코드*/
			, AREA_CD /*지역코드*/
			, DCRT /*할인율*/
			, DLV_COST_AMT /*배송비용금액*/
			, PRC_COND_SPR_CD /*가격조건구분코드*/
			, APLY_BSS_CD /*적용기준코드*/
			, MNFR_NO /*제조사번호*/
			, BZPLC_ID /*사업장ID*/
			, CURR_UNIT_CD /*통화단위코드*/
			, REGPSN_ID /*등록자ID*/
			, REG_DTM /*등록일시*/
			, UPDPSN_ID /*수정자ID*/
			, UPD_DTM /*수정일시*/
		) VALUES (
              #{CO_CD}
            , #{CPRTCP_ID}
            , LPAD(#{PRD_ID},18,0)
            , (
               SELECT NVL(MAX(TO_NUMBER(PRC_COND_SEQ))+1,'1')
                 FROM SSP_APP.TB_PC_PRC_COND_DTLS
                WHERE CO_CD           = #{CO_CD}
                  AND CPRTCP_ID       = #{CPRTCP_ID}
                  AND PRD_ID          = LPAD(#{PRD_ID},18,0)
              )
            , #{QTY_ITV_STR}
            , #{END_QTY_CNT}
            , #{VLD_STR_DT}
            , #{VLD_END_DT}
            , #{DC_AMT}
            , 'X'
            , #{AREA_CD}
            , 0
            , #{DLV_COST_AMT}
            , NVL(#{PRC_COND_SPR_CD}, 'ZM01')
            , 1
            , #{MNFR_NO}
            , #{BZPLC_ID}
            , 'KRW'
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            )
        ]]>
    </insert>

    <update id="insertNewPrdReqProcAttrInfoStor" parameterType="HashMap">
        /* NewPrdReqLst.insertNewPrdReqProcAttrInfoStor 신규상품요청처리속성정보 저장 */
        BEGIN
        <![CDATA[
            INSERT INTO SSP_APP.TB_PR_NEW_PRD_REQ_PROC_ATTR_INFO
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , INTG_ATTR_CD                /*통합속성코드*/
            , PRD_CLCD                    /*상품분류코드*/
            , NEW_PRD_REQ_PRVL            /*신규상품요청속성값*/
            , INTG_ATTR_SPR_CD            /*통합속성구분코드*/
            , SRT_SO                      /*정렬순서*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , #{PRD_ATTR_CD}
            , #{PRD_CLCD}
            , #{NEW_PRD_REQ_PRVL}
            , '20'
            , #{SRT_SO}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );

            INSERT INTO SSP_APP.TB_PR_PRD_INFO_ATTR_MAPP
            (
              CO_CD                       /*회사코드*/
            , PRD_ID                      /*상품ID*/
            , PRD_ATTR_CD                 /*상품속성코드*/
            , SRT_SO                      /*정렬순서*/
            , PRVL                        /*속성값*/
            , UPD_RSN                     /*수정사유*/
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{PRD_ID}
            , #{PRD_ATTR_CD}
            , #{SRT_SO}
            , #{NEW_PRD_REQ_PRVL}
            , #{UPD_RSN}
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>

    <update id="updateCustReqProc" parameterType="HashMap">
        /* NewPrdReqLst.updateCustReqProc 고객요청처리 수정 */
        BEGIN
        <![CDATA[
            UPDATE SSP_APP.TB_PR_NEW_PRD_REQ_PROC
               SET TRSF_RSN          = NVL(#{TRSF_RSN},TRSF_RSN)                                              /*이관사유*/
                 , MALL_SPR_CD       = NVL(#{MALL_SPR_CD},MALL_SPR_CD)                                        /*몰구분코드*/
                 , ALT_PRPS_RSN      = NVL(#{ALT_PRPS_RSN},ALT_PRPS_RSN)                                      /*대체제안사유*/
                 , RND_REQ_PRD_ID    = NVL(LPAD(#{RND_REQ_PRD_ID},18,0),RND_REQ_PRD_ID)                       /*RND요청상품ID*/
                 , PRPS_PRD_ID       = NVL(LPAD(#{RND_REQ_PRD_ID},18,0),PRPS_PRD_ID)                          /*제안상품ID*/
                 , MRO_PROC_STATS_CD = DECODE(#{NEW_PRD_REQ_STATS_CD},'30','10',MRO_PROC_STATS_CD)            /*대체상품제안이 경우에만 MRO처리상태코드[10:완료] */
                 , PRD_PRPS_SPR_CD   = CASE WHEN #{NEW_PRD_REQ_STATS_CD} = '56' THEN '20'		/* SSP-2623 */
                 						    WHEN #{NEW_PRD_REQ_STATS_CD} = '29' THEN '20'
                 						    WHEN #{NEW_PRD_REQ_STATS_CD} = '30' THEN '10'
                 						    ELSE ''
                 					   END 																	  /*상품제안구분코드[중복제안인 경우:[20:중복상품제안],대체상품제안인 경우:[10:대표상품제안]*/                					
                 , PRD_PRPS_STATS_CD = NVL(#{PRD_PRPS_STATS_CD},PRD_PRPS_STATS_CD)                            /**/
                 , PUB_ONLY_SPR_CD   = #{PUB_ONLY_SPR_CD}                                   				  /*공용전용구분코드*/                
                 , UPDPSN_ID         = #{UPDPSN_ID}                                                           /*수정자ID*/
                 , UPD_DTM           = SYSDATE                                                                /*수정일시*/
             WHERE CO_CD             = #{CO_CD}
               AND NEW_PRD_REQ_NO    = #{NEW_PRD_REQ_NO};

            INSERT INTO SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS
            (
              CO_CD                       /*회사코드*/
            , NEW_PRD_REQ_NO              /*신규상품요청번호*/
            , SEQ                         /*순번*/
            , NEW_PRD_REQ_STATS_CD        /*신규상품요청상태코드*/
            , MALL_SPR_CD                 /*몰구분코드*/
            , MEMO_CTS                    /* 사유  */
            , REGPSN_ID                   /*등록자ID*/
            , REG_DTM                     /*등록일시*/
            , UPDPSN_ID                   /*수정자ID*/
            , UPD_DTM                     /*수정일시*/
            )
            VALUES
            (
              #{CO_CD}
            , #{NEW_PRD_REQ_NO}
            , (
               SELECT NVL(MAX(TO_NUMBER(SEQ))+1,'1')
                 FROM SSP_APP.TB_PR_NEW_PRD_REQ_STATS_DTLS
                WHERE CO_CD          = #{CO_CD}
                  AND NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
              )
            , #{NEW_PRD_REQ_STATS_CD}
            , #{MALL_SPR_CD}
            , DECODE(#{NEW_PRD_REQ_STATS_CD}, '30', #{ALT_PRPS_RSN}, NVL(#{TRSF_RSN},''))
            , #{REGPSN_ID}
            , SYSDATE
            , #{UPDPSN_ID}
            , SYSDATE
            );
        ]]>
        END;
    </update>
    

    <select id = "validatePurgInfo" parameterType = "HashMap" resultType = "Integer">
    	/* NewPrdReqLst.validatePurgInfo | 상품 구매정보,진열 유무 검증 */
    	SELECT COUNT(1)
		  FROM TB_PC_CPRTCP_PRD_INFO A
		  JOIN TB_PC_CPRTCP_PRD_PRC_INFO B
		    ON B.CO_CD = A.CO_CD 
		   AND B.PRD_ID = A.PRD_ID 
		   AND B.CPRTCP_ID = A.CPRTCP_ID   
		  JOIN TB_PC_PRD_PRC_HST C
		    ON C.CO_CD = A.CO_CD
		   AND C.PRD_ID = A.PRD_ID
		   AND C.LWST_BUY_CPRTCP_ID = A.CPRTCP_ID
		  JOIN TB_DP_PRD_DISP_STATS_INFO D
		    ON D.CO_CD = A.CO_CD
		   AND D.PRD_ID = A.PRD_ID
		 WHERE A.CO_CD = '1000'
		   AND A.PRD_ID = LPAD(#{RND_REQ_PRD_ID}, 18, 0)
		   AND A.SPL_PSB_YN = 'Y'
		   AND D.DISP_STATS_CD = '10'
		   AND D.PUB_ONLY_SPR_CD = 'P'
		   AND TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') BETWEEN C.BSS_SALSPRC_STR_DTM AND C.BSS_SALSPRC_END_DTM
		   AND TO_CHAR(SYSDATE,'YYYYMMDDHH24MISS') BETWEEN B.VLD_STR_DT AND B.VLD_END_DT
    </select>
    
    <select id = "validateDispInfo" parameterType = "HashMap" resultType = "Integer">
    	/* NewPrdReqLst.validateDispInfo | 해당사업장, 운영단위 진열정보유무 검증 */
    	SELECT COUNT(1)
		FROM TB_DP_PRD_DISP_STATS_INFO A
		WHERE A.CO_CD = #{CO_CD}
		AND A.PRD_ID = LPAD(#{RND_REQ_PRD_ID}, 18, 0)
		AND A.DISP_STATS_CD = '10'
		AND A.PUB_ONLY_SPR_CD = 'E'
		AND A.BZPLC_ID = #{BZPLC_ID}
		AND A.OPR_UNIT_ID = #{OPR_UNIT_ID}
    </select>
    
    <select id = "selectValidReqInfo" parameterType = "HashMap" resultType = "Integer">
    	/* NewPrdReqLst.selectValidReqInfo | 협력사 신규상품요청 검증 */
    	SELECT COUNT(1) 
		FROM TB_PR_NEW_PRD_CUST_REQ_INFO 
		WHERE 1=1
        AND CO_CD = #{CO_CD}
		AND NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
		AND TO_CHAR(SYSDATE,'YYYYMMDD') BETWEEN VLD_STR_DT AND VLD_END_DT
      
    </select>

    <select id = "selectCustMailRcvAgreYn" parameterType= "HashMap" resultType = "String">
    	/* NewPrdReqLst.selectCustMailRcvAgreYn | 고객의 업무용메일수신동의여부 검증 */
    	SELECT B.MAIL_RCV_AGRE_YN
		FROM TB_PR_NEW_PRD_CUST_REQ_INFO A
		INNER JOIN TB_CC_MBR_BASIS B
		ON B.CO_CD = A.CO_CD
		AND B.MBR_ID = A.REGPSN_ID
		WHERE A.CO_CD = #{CO_CD}
		AND A.NEW_PRD_REQ_NO = #{NEW_PRD_REQ_NO}
    </select>

</mapper>