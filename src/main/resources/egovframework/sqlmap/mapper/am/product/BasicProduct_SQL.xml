<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="BasicProduct">

    <!-- 상품 검색 조건 -->
    <sql id="productWhere">
        <if test="searchPrdMstCd != null and searchPrdMstCd != ''">
            AND PM.PRD_MST_CD LIKE '%'||UPPER(#{searchPrdMstCd})||'%'
        </if>
        <if test="searchPrdMstNm != null and searchPrdMstNm != ''">
            AND UPPER(PM.PRD_MST_NM) LIKE '%'||UPPER(#{searchPrdMstNm})||'%'
        </if>
        <if test="searchPrdMstSellState != null and searchPrdMstSellState != ''">
            AND PM.PRD_MST_SEL_STATE = #{searchPrdMstSellState}
        </if>
        <if test="searchPrdMstDplState != null and searchPrdMstDplState != ''">
            AND PM.PRD_MST_DPL_STATE = #{searchPrdMstDplState}
        </if>
        <if test="searchPrdMstMdId != null and searchPrdMstMdId != ''">
            AND UPPER(PM.PRD_MST_MD_ID) LIKE '%'||UPPER(#{searchPrdMstMdId})||'%'
        </if>
        <if test="searchPrdMstBrand != null and searchPrdMstBrand != ''">
            AND PM.PRD_MST_BRD_IDX = #{searchPrdMstBrand}
        </if>
        <if test="searchPrdMstVdrYn != null and searchPrdMstVdrYn != ''">
            AND PM.PRD_MST_VDR_YN = #{searchPrdMstVdrYn}
        </if>
        <if test="searchPrdMstVdrIdx != null and searchPrdMstVdrIdx != ''">
            AND PM.PRD_MST_VDR_IDX = #{searchPrdMstVdrIdx}
        </if>
        <if test="searchPrdMstApvState != null and searchPrdMstApvState != ''">
            AND PM.PRD_MST_APV_STATE = #{searchPrdMstApvState}
        </if>
        <if test="searchStartDate != null and searchStartDate != '' and searchEndDate != null and searchEndDate != ''">
            AND PM.PRD_MST_REG_DT BETWEEN REPLACE(#{searchStartDate},'-', '')||'000000' AND REPLACE(#{searchEndDate},'-', '')||'235959'
        </if>
        <if test="searchPrdMstChannelType != null and searchPrdMstChannelType != ''">
            <choose>
                <when test="searchPrdMstChannelType.equals('P'.toString())">
                    AND PM.PRD_MST_CNL_PC_YN = 'Y'
                </when>
                <when test="searchPrdMstChannelType.equals('M'.toString())">
                    AND PM.PRD_MST_CNL_MB_YN = 'Y'
                </when>
            </choose>
        </if>
        <if test="searchCategoryYn != null and searchCategoryYn != ''">
            <if test="searchCategoryYn.equals('Y'.toString())">
                AND PM.PRD_MST_CD IN ( 
                                          SELECT DSP_PRD_MST_CD
                                          FROM T_DSP_CTG, WT1
                                          WHERE
                                            T_DSP_CTG.DSP_PRD_CTG_IDX = WT1.PRD_CTG_IDX
                                      )
            </if>
        </if>
        <if test="searchCategoryYn != null and searchPrdMstVdrYn != 'Y'">
            AND NOT EXISTS(
                                SELECT PRD_MST_CD
                                FROM T_PRD_MST PM2
                                WHERE PM.PRD_MST_CD = PM2.PRD_MST_CD
                                AND PM2.PRD_MST_VDR_YN = 'Y'
                                AND PM2.PRD_MST_VDR_IDX > 0
                                AND PM2.PRD_MST_APV_STATE = 'D'
                                AND PM2.PRD_MST_DEL_YN  <![CDATA[ <> ]]>  'Y'      
                            )
        </if>        
        <if test="searchVdrApvApvState != null and searchVdrApvApvState != ''">
            <if test="searchPrdMstVdrYn.equals('Y'.toString())">
                AND EXISTS(
                                SELECT PRD_MST_CD
                                FROM T_VDR_APV VAV
                                WHERE PM.PRD_MST_CD = VAV.PRD_MST_CD
                                AND VAV.VDR_APV_APV_STATE = #{searchVdrApvApvState}
                          )
            </if>
        </if>
    </sql>
    
    <!-- 상품 카테고리 검색 조건 -->
    <sql id="productCategoryWhere">
        <where>
            <if test="searchPrdCtgEnv != null and searchPrdCtgEnv != ''">
                AND PC.PRD_CTG_ENV = #{searchPrdCtgEnv}
            </if>
        </where>
        <if test="searchPrdCtgIdx != null and searchPrdCtgIdx !=''">
            START WITH PC.PRD_CTG_IDX = #{searchPrdCtgIdx}
            CONNECT BY PRIOR PC.PRD_CTG_IDX = PC.PRD_CTG_UP_IDX
        </if>
    </sql>
       
    <!-- 상품 리스트 갯수 -->
    <select id="selectBasicProductCount" parameterType="hashMap" resultType="integer">
        /* BasicProduct.selectBasicProductCount */
        WITH WT1 AS(
            SELECT PC.PRD_CTG_IDX, PC.PRD_CTG_NM, PC.PRD_CTG_TOP_IDX, PC.PRD_CTG_ENV
            FROM T_PRD_CTG PC
            <include refid="productCategoryWhere"/>
        )
        SELECT
            COUNT(0)
        FROM
             T_PRD_MST PM
        WHERE
            PM.PRD_MST_DEL_YN <![CDATA[ <> ]]> 'Y'
            <include refid="productWhere"/>           
    </select> 
    
    <!-- 입점업체 수정요청 수 -->
    <select id="selectBasicProductVdrCount" parameterType="hashMap" resultType="integer">
        /* BasicProduct.selectBasicProductVdrCount */
        SELECT 
            COUNT(0)
        FROM T_VDR_APV
        WHERE
            VDR_MST_IDX = #{VDR_MST_IDX}
        AND
            PRD_MST_CD = #{PRD_MST_CD}
        AND
            VDR_APV_APV_STATE = 'D'
    </select> 
 
    <!-- 상품 리스트 조회 2015.04.09 jesong -->
    <select id="selectBasicProductList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicProductList */
        
        WITH WT1 AS (SELECT PC.PRD_CTG_IDX,  
                                   PC.PRD_CTG_NM,
                                   PC.PRD_CTG_TOP_IDX,
                                   PC.PRD_CTG_ENV
                         FROM T_PRD_CTG PC
                     <include refid="productCategoryWhere"/>
                     )
        SELECT  RNUM,
                PRD_MST_CD,
                PRD_MST_NM,
                PRD_MST_CNL_PC_YN,
                PRD_MST_CNL_MB_YN,
                PRD_MST_SEL_CNT,
                PRD_MST_SEL_STATE,
                PRD_MST_DPL_STATE,
                PRD_MST_APV_STATE, 
                PRD_MST_APV_STATE_NM,
                PRD_MST_REG_DT,
                PRD_MST_UPD_DT,
                PRD_MST_PRC,
                PRD_MST_SCH_PRC,
                PRD_MST_DLV_FEE,
                DSP_PRD_CTG_IDX,
                (
                    SELECT SUBSTR(SYS_CONNECT_BY_PATH(PRD_CTG_NM, '>'),2)
                    FROM T_PRD_CTG
                    WHERE PRD_CTG_IDX = DSP_PRD_CTG_IDX
                    START WITH PRD_CTG_UP_IDX = -1
                     CONNECT BY PRIOR PRD_CTG_IDX = PRD_CTG_UP_IDX
                ) AS PRD_CTG_LVL_NM
                ,
                PRD_MST_PC_CPN_UNT,
                PRD_MST_PC_CPN_PRC,
                PRD_MST_MB_CPN_UNT,
                PRD_MST_MB_CPN_PRC,
                PRD_MST_VDR_NM,
                PRD_MST_VDR_YN ,
                PRD_MST_VDR_IDX ,
                PRD_MST_OPT_EST_CNT,
                PRD_MST_CPN_OWN
      FROM (
                SELECT  ROWNUM RNUM,
                        PRD_MST_CD,
                        PRD_MST_NM,
                        PRD_MST_CNL_PC_YN,
                        PRD_MST_CNL_MB_YN,
                        PRD_MST_SEL_CNT,
                        PRD_MST_SEL_STATE,
                        PRD_MST_DPL_STATE,
                        PRD_MST_APV_STATE, 
                        PRD_MST_APV_STATE_NM,
                        PRD_MST_REG_DT,
                        PRD_MST_UPD_DT,
                        PRD_MST_PRC,
                        PRD_MST_SCH_PRC,
                        PRD_MST_DLV_FEE,
                        DSP_PRD_CTG_IDX,
                        PRD_MST_PC_CPN_UNT,
                        PRD_MST_PC_CPN_PRC,
                        PRD_MST_MB_CPN_UNT,
                        PRD_MST_MB_CPN_PRC,
                        PRD_MST_VDR_NM,
                        PRD_MST_VDR_YN ,
                        PRD_MST_VDR_IDX ,
                        PRD_MST_OPT_EST_CNT,
                        PRD_MST_CPN_OWN
              FROM (  
                            SELECT  PM.PRD_MST_CD,  /* 온라인 상품코드 */
                                    PM.PRD_MST_NM, /* 상품명 */
                                    PM.PRD_MST_CNL_PC_YN, /* 쇼핑 채널 PC여부 */
                                    PM.PRD_MST_CNL_MB_YN, /* 쇼핑 채널 MOBILE여부 */
                                    PM.PRD_MST_SEL_CNT, /* 판매가능 수량 */
                                    PM.PRD_MST_SEL_STATE, /* 판매상태 */
                                    PM.PRD_MST_DPL_STATE, /* 진열여부 */
                                    PM.PRD_MST_APV_STATE, /* 승인여부 */
                                    <![CDATA[CASE PM.PRD_MST_APV_STATE
                                        WHEN 'A' THEN '승인'
                                        WHEN 'D' THEN '대기'
                                        WHEN 'C' THEN '거절'
                                    ELSE
                                        '상태값 없음'
                                    END]]> AS PRD_MST_APV_STATE_NM , /* 승인여부_STR */ 
                                    PM.PRD_MST_REG_DT, /* 최초 등록일 */
                                    PM.PRD_MST_UPD_DT, /* 최종 수정일 */
                                    PM.PRD_MST_PRC, /* 상품가격 */
                                    PM.PRD_MST_SCH_PRC, /* 검색가 */
                                    PM.PRD_MST_DLV_FEE, /* 배송비 */
                                    (SELECT DSP_PRD_CTG_IDX FROM T_DSP_CTG WHERE DSP_PRD_MST_CD = PM.PRD_MST_CD AND ROWNUM = 1) AS DSP_PRD_CTG_IDX, /* 카테고리 IDX */
                                    PM.PRD_MST_PC_CPN_UNT, /* PC즉시쿠폰 정율/정액 */
                                    PM.PRD_MST_PC_CPN_PRC, /* PC즉시쿠폰 정율금액/정액금액 */
                                    PM.PRD_MST_MB_CPN_UNT, /* MOBILE즉시쿠폰 정율/정액 */
                                    PM.PRD_MST_MB_CPN_PRC, /* MOBILE즉시쿠폰 정율금액/정액금액 */
                                    <![CDATA[CASE WHEN PM.PRD_MST_VDR_YN = 'N' AND PM.PRD_MST_VDR_IDX = -1 
                                                THEN '-' 
                                                ELSE (SELECT VDR_MST_NM FROM T_VDR_MST VDT WHERE VDT.VDR_MST_IDX = PM.PRD_MST_VDR_IDX) END]]> AS PRD_MST_VDR_NM,
                                    PM.PRD_MST_VDR_YN ,
                                    PM.PRD_MST_VDR_IDX ,
                                    (
                                        SELECT COUNT(0) 
                                        FROM T_PRD_OPT PRP
                                        WHERE PRP.PRD_MST_CD = PM.PRD_MST_CD 
                                        AND PRP.PRD_OPT_EST_YN = 'Y' 
                                        AND EXISTS (
                                            SELECT COUNT(*)
                                            FROM T_OPT_DTL OPD
                                            WHERE OPD.PRD_OPT_IDX = PRP.PRD_OPT_IDX
                                            AND OPD.OPT_DTL_USE_YN = 'Y'
                                            AND TO_CHAR(SYSDATE,'YYYYMMDDHH24MI') BETWEEN OPD.OPT_DTL_ST_DT||'000000' AND OPD.OPT_DTL_ED_DT||'235959' 
                                        )
                                    ) AS PRD_MST_OPT_EST_CNT,
                                    PM.PRD_MST_CPN_OWN
                               FROM T_PRD_MST PM
                             WHERE
                                PM.PRD_MST_DEL_YN <![CDATA[ <> ]]> 'Y'
                                 <include refid="productWhere"/>
                           ORDER BY PRD_MST_REG_DT DESC, PM.PRD_MST_CD ASC
                           ) IV1
               ) IV2
        <if test="excelDown == null or !excelDown.equals('Y'.toString())">
            WHERE RNUM BETWEEN #{startNum} AND #{endNum}
        </if>
        ORDER BY RNUM
    </select>
    
    <!-- 상품 상세 조회 -->
    <resultMap type="java.util.HashMap" id="resultProduct">
        <result column="PRD_MST_CD"     property="PRD_MST_CD"/>
        <result column="PRD_MST_VDR_YN"     property="PRD_MST_VDR_YN"/>
        <result column="PRD_MST_VDR_IDX"    property="PRD_MST_VDR_IDX"/>
        <result column="PRD_MST_TYPE"       property="PRD_MST_TYPE"/>
        <result column="PRD_MST_BUY_TP"     property="PRD_MST_BUY_TP"/>
        <result column="PRD_MST_NM"     property="PRD_MST_NM"/>
        <result column="PRD_MST_NM_SUB"     property="PRD_MST_NM_SUB"/>
        <result column="PRD_MST_LNG_DIV_YN" property="PRD_MST_LNG_DIV_YN"/>
        <result column="PRD_MST_LNG_DIV_MNT1"   property="PRD_MST_LNG_DIV_MNT1"/>
        <result column="PRD_MST_LNG_DIV_MNT2"   property="PRD_MST_LNG_DIV_MNT2"/>
        <result column="PRD_MST_MD_ID"      property="PRD_MST_MD_ID"/>
        <result column="PRD_MST_DLV_FEE"    property="PRD_MST_DLV_FEE"/>
        <result column="PRD_MST_CPS_YN"     property="PRD_MST_CPS_YN"/>
        <result column="PRD_MST_CPS_MDL"    property="PRD_MST_CPS_MDL"/>
        <result column="PRD_MST_CPN_YN"     property="PRD_MST_CPN_YN"/>
        <result column="PRD_MST_SEL_CNT"    property="PRD_MST_SEL_CNT"/>
        <result column="PRD_MST_PC_CPN_UNT" property="PRD_MST_PC_CPN_UNT"/>
        <result column="PRD_MST_PC_CPN_PRC" property="PRD_MST_PC_CPN_PRC"/>
        <result column="PRD_MST_MB_CPN_UNT" property="PRD_MST_MB_CPN_UNT"/>
        <result column="PRD_MST_MB_CPN_PRC" property="PRD_MST_MB_CPN_PRC"/>
        <result column="PRD_MST_ADD_MIL"    property="PRD_MST_ADD_MIL"/>
        <result column="PRD_MST_SRC_YN"     property="PRD_MST_SRC_YN"/>
        <result column="PRD_MST_O2O_YN"     property="PRD_MST_O2O_YN"/>
        <result column="PRD_MST_DLV_BND"    property="PRD_MST_DLV_BND"/>
        <result column="PRD_MST_IVB_YN"     property="PRD_MST_IVB_YN"/>
        <result column="PRD_MST_DLV_DSN_YN" property="PRD_MST_DLV_DSN_YN"/>
        <result column="PRD_MST_DLV_DT"     property="PRD_MST_DLV_DT"/>
        <result column="PRD_MST_PRC"        property="PRD_MST_PRC"/>
        <result column="PRD_MST_SCH_PRC"    property="PRD_MST_SCH_PRC"/>
        <result column="PRD_MST_CPR_PRC1"   property="PRD_MST_CPR_PRC1"/>
        <result column="PRD_MST_CPR_PRC2"   property="PRD_MST_CPR_PRC2"/>
        <result column="PRD_MST_PKG_PRC"    property="PRD_MST_PKG_PRC"/>
        <result column="PRD_MST_CNL_PC_YN"  property="PRD_MST_CNL_PC_YN"/>
        <result column="PRD_MST_CNL_MB_YN"  property="PRD_MST_CNL_MB_YN"/>
        <result column="PRD_MST_SEL_STATE"  property="PRD_MST_SEL_STATE"/>
        <result column="PRD_MST_DPL_STATE"  property="PRD_MST_DPL_STATE"/>
        <result column="PRD_MST_APV_STATE"  property="PRD_MST_APV_STATE"/>
        <result column="PRD_MST_APV_STATE_NM"   property="PRD_MST_APV_STATE_NM"/>
        <result column="PRD_MST_PC_DTL_DSC" property="PRD_MST_PC_DTL_DSC" jdbcType="CLOB" javaType="java.lang.String"/>
        <result column="PRD_MST_MB_DTL_DSC" property="PRD_MST_MB_DTL_DSC" jdbcType="CLOB" javaType="java.lang.String"/>
        <result column="PRD_MST_NFI_IDX"    property="PRD_MST_NFI_IDX"/>
        <result column="PRD_MST_BRD_IDX"    property="PRD_MST_BRD_IDX"/>
        <result column="PRD_MST_MRK_IDX"    property="PRD_MST_MRK_IDX"/>
        <result column="PRD_MST_NFI_INF1"   property="PRD_MST_NFI_INF1"/>
        <result column="PRD_MST_NFI_INF2"   property="PRD_MST_NFI_INF2"/>
        <result column="PRD_MST_NFI_INF3"   property="PRD_MST_NFI_INF3"/>
        <result column="PRD_MST_NFI_INF4"   property="PRD_MST_NFI_INF4"/>
        <result column="PRD_MST_NFI_INF5"   property="PRD_MST_NFI_INF5"/>
        <result column="PRD_MST_NFI_INF6"   property="PRD_MST_NFI_INF6"/>
        <result column="PRD_MST_NFI_INF7"   property="PRD_MST_NFI_INF7"/>
        <result column="PRD_MST_NFI_INF8"   property="PRD_MST_NFI_INF8"/>
        <result column="PRD_MST_NFI_INF9"   property="PRD_MST_NFI_INF9"/>
        <result column="PRD_MST_NFI_INF10"  property="PRD_MST_NFI_INF10"/>
        <result column="PRD_MST_NFI_INF11"  property="PRD_MST_NFI_INF11"/>
        <result column="PRD_MST_NFI_INF12"  property="PRD_MST_NFI_INF12"/>
        <result column="PRD_MST_NFI_INF13"  property="PRD_MST_NFI_INF13"/>
        <result column="PRD_MST_NFI_INF14"  property="PRD_MST_NFI_INF14"/>
        <result column="PRD_MST_MTA_TAG1"   property="PRD_MST_MTA_TAG1"/>
        <result column="PRD_MST_MTA_TAG2"   property="PRD_MST_MTA_TAG2"/>
        <result column="PRD_MST_MTA_TAG3"   property="PRD_MST_MTA_TAG3"/>
        <result column="PRD_MST_MEMO"       property="PRD_MST_MEMO"/>
        <result column="PRD_MST_RED_CNT"    property="PRD_MST_RED_CNT"/>
        <result column="PRD_MST_ICN_YN1"    property="PRD_MST_ICN_YN1"/>
        <result column="PRD_MST_ICN_ST_DT1" property="PRD_MST_ICN_ST_DT1"/>
        <result column="PRD_MST_ICN_ED_DT1" property="PRD_MST_ICN_ED_DT1"/>
        <result column="PRD_MST_ICN_YN2"    property="PRD_MST_ICN_YN2"/>
        <result column="PRD_MST_ICN_ST_DT2" property="PRD_MST_ICN_ST_DT2"/>
        <result column="PRD_MST_ICN_ED_DT2" property="PRD_MST_ICN_ED_DT2"/>
        <result column="PRD_MST_ICN_YN3"    property="PRD_MST_ICN_YN3"/>
        <result column="PRD_MST_ICN_ST_DT3" property="PRD_MST_ICN_ST_DT3"/>
        <result column="PRD_MST_ICN_ED_DT3" property="PRD_MST_ICN_ED_DT3"/>
        <result column="PRD_MST_ICN_YN4"    property="PRD_MST_ICN_YN4"/>
        <result column="PRD_MST_ICN_ST_DT4" property="PRD_MST_ICN_ST_DT4"/>
        <result column="PRD_MST_ICN_ED_DT4" property="PRD_MST_ICN_ED_DT4"/>
        <result column="PRD_MST_ICN_YN5"    property="PRD_MST_ICN_YN5"/>
        <result column="PRD_MST_ICN_ST_DT5" property="PRD_MST_ICN_ST_DT5"/>
        <result column="PRD_MST_ICN_ED_DT5" property="PRD_MST_ICN_ED_DT5"/>
        <result column="PRD_MST_DEL_YN"     property="PRD_MST_DEL_YN"/>
        <result column="PRD_MST_REG_DT"     property="PRD_MST_REG_DT"/>
        <result column="PRD_MST_REG_IP"     property="PRD_MST_REG_IP"/>
        <result column="PRD_MST_REG_ID"     property="PRD_MST_REG_ID"/>
        <result column="PRD_MST_UPD_DT"     property="PRD_MST_UPD_DT"/>
        <result column="PRD_MST_UPD_IP"     property="PRD_MST_UPD_IP"/>
        <result column="PRD_MST_UPD_ID"     property="PRD_MST_UPD_ID"/>
        <result column="PRD_MST_REG_NM"     property="PRD_MST_REG_NM"/>
        <result column="PRD_MST_UPD_NM"     property="PRD_MST_UPD_NM"/>
        <result column="PRD_MST_SEL_STATE_NM"       property="PRD_MST_SEL_STATE_NM"/>
        <result column="PRD_MST_NFI_NM"     property="PRD_MST_NFI_NM"/>
        <result column="PRD_MST_BRAND_NM"       property="PRD_MST_BRAND_NM"/>
        <result column="PRD_MST_MRK_NM"     property="PRD_MST_MRK_NM"/>
        <result column="PRD_MST_BRD_SERV"       property="PRD_MST_BRD_SERV"/>
        <result column="PRD_CPN_PC_DST_PRICE"       property="PRD_CPN_PC_DST_PRICE"/>
        <result column="PRD_CPN_ML_DST_PRICE"       property="PRD_CPN_ML_DST_PRICE"/>
        <result column="PRD_BRD_PC_CPN_CNT"     property="PRD_BRD_PC_CPN_CNT"/>
        <result column="PRD_BRD_ML_CPN_CNT"     property="PRD_BRD_ML_CPN_CNT"/>
        <result column="PRD_MST_BUY_PRC"        property="PRD_MST_BUY_PRC"/>
        <result column="PRD_MST_CRD_YN"     property="PRD_MST_CRD_YN"/>
        <result column="PRD_MST_CPN_OWN"        property="PRD_MST_CPN_OWN"/>
    </resultMap>

    <!-- 상품 상세 내역  --> 
    <select id="selectBasicProductInfo" parameterType="hashMap" resultMap="resultProduct">
        /* BasicProduct.selectBasicProductInfo */
        SELECT
            PM.PRD_MST_CD ,
            PM.PRD_MST_VDR_YN ,
            PM.PRD_MST_VDR_IDX ,
            PM.PRD_MST_TYPE ,
            PM.PRD_MST_BUY_TP ,
            PM.PRD_MST_NM ,
            PM.PRD_MST_NM_SUB ,
            PM.PRD_MST_LNG_DIV_YN ,
            PM.PRD_MST_LNG_DIV_MNT1 ,
            PM.PRD_MST_LNG_DIV_MNT2 ,
            PM.PRD_MST_MD_ID ,
            PM.PRD_MST_DLV_FEE ,
            PM.PRD_MST_CPS_YN ,
            PM.PRD_MST_CPS_MDL ,
            PM.PRD_MST_CPN_YN ,
            PM.PRD_MST_SEL_CNT ,
            PM.PRD_MST_PC_CPN_UNT ,
            PM.PRD_MST_PC_CPN_PRC ,
            PM.PRD_MST_MB_CPN_UNT ,
            PM.PRD_MST_MB_CPN_PRC ,
            PM.PRD_MST_ADD_MIL ,
            PM.PRD_MST_SRC_YN ,
            PM.PRD_MST_O2O_YN ,
            PM.PRD_MST_DLV_BND ,
            PM.PRD_MST_IVB_YN ,
            PM.PRD_MST_DLV_DSN_YN ,
            PM.PRD_MST_DLV_DT ,
            PM.PRD_MST_PRC ,
            PM.PRD_MST_SCH_PRC ,
            PM.PRD_MST_CPR_PRC1 ,
            PM.PRD_MST_CPR_PRC2 ,
            PM.PRD_MST_PKG_PRC ,
            PM.PRD_MST_CNL_PC_YN ,
            PM.PRD_MST_CNL_MB_YN ,
            PM.PRD_MST_SEL_STATE ,
            PM.PRD_MST_DPL_STATE ,
            PM.PRD_MST_APV_STATE ,
            <![CDATA[CASE PM.PRD_MST_APV_STATE
                WHEN 'A' THEN '승인'
                WHEN 'D' THEN '대기'
                WHEN 'C' THEN '거절'
            ELSE
                '상태값 없음'
            END]]> AS PRD_MST_APV_STATE_NM ,
            PM.PRD_MST_PC_DTL_DSC ,
            PM.PRD_MST_MB_DTL_DSC ,
            PM.PRD_MST_NFI_IDX ,
            PM.PRD_MST_BRD_IDX ,
            PM.PRD_MST_MRK_IDX ,
            PM.PRD_MST_NFI_INF1 ,
            PM.PRD_MST_NFI_INF2 ,
            PM.PRD_MST_NFI_INF3 ,
            PM.PRD_MST_NFI_INF4 ,
            PM.PRD_MST_NFI_INF5 ,
            PM.PRD_MST_NFI_INF6 ,
            PM.PRD_MST_NFI_INF7 ,
            PM.PRD_MST_NFI_INF8 ,
            PM.PRD_MST_NFI_INF9 ,
            PM.PRD_MST_NFI_INF10 ,
            PM.PRD_MST_NFI_INF11 ,
            PM.PRD_MST_NFI_INF12 ,
            PM.PRD_MST_NFI_INF13 ,
            PM.PRD_MST_NFI_INF14 ,
            PM.PRD_MST_MTA_TAG1 ,
            PM.PRD_MST_MTA_TAG2 ,
            PM.PRD_MST_MTA_TAG3 ,
            PM.PRD_MST_MEMO ,
            PM.PRD_MST_RED_CNT ,
            PM.PRD_MST_ICN_YN1 ,
            PM.PRD_MST_ICN_ST_DT1 ,
            PM.PRD_MST_ICN_ED_DT1 ,
            PM.PRD_MST_ICN_YN2 ,
            PM.PRD_MST_ICN_ST_DT2 ,
            PM.PRD_MST_ICN_ED_DT2 ,
            PM.PRD_MST_ICN_YN3 ,
            PM.PRD_MST_ICN_ST_DT3 ,
            PM.PRD_MST_ICN_ED_DT3 ,
            PM.PRD_MST_ICN_YN4 ,
            PM.PRD_MST_ICN_ST_DT4 ,
            PM.PRD_MST_ICN_ED_DT4 ,
            PM.PRD_MST_ICN_YN5 ,
            PM.PRD_MST_ICN_ST_DT5 ,
            PM.PRD_MST_ICN_ED_DT5 ,
            PM.PRD_MST_DEL_YN ,
            PM.PRD_MST_REG_DT ,
            PM.PRD_MST_REG_IP ,
            PM.PRD_MST_REG_ID ,
            PM.PRD_MST_UPD_DT ,
            PM.PRD_MST_UPD_IP ,
            PM.PRD_MST_UPD_ID   
            , (
                SELECT
                    ADM_MST_NM
                FROM
                    T_ADM_MST
                WHERE
                    ADM_MST_ID = PM.PRD_MST_REG_ID
            ) AS PRD_MST_REG_NM
            , (
                SELECT
                    ADM_MST_NM
                FROM
                    T_ADM_MST
                WHERE
                    ADM_MST_ID = PM.PRD_MST_UPD_ID
            ) AS PRD_MST_UPD_NM
            , <![CDATA[
                CASE PM.PRD_MST_SEL_STATE 
                    WHEN 'I' THEN '판매중'
                    WHEN 'O' THEN '일시품절'
                    WHEN 'T' THEN '품절상품'
                ELSE '미판매' END]]> AS PRD_MST_SEL_STATE_NM
            , (SELECT PRD_NFI_NM FROM T_PRD_NFI WHERE PRD_NFI_IDX = PM.PRD_MST_NFI_IDX ) AS PRD_MST_NFI_NM
            , (SELECT BND_MST_BRAND_NM FROM T_BND_MST WHERE BND_MST_IDX = PM.PRD_MST_BRD_IDX ) AS PRD_MST_BRAND_NM
            , (SELECT MRK_MST_BRAND_NM FROM T_MRK_MST WHERE MRK_MST_IDX = PM.PRD_MST_MRK_IDX ) AS PRD_MST_MRK_NM
            , (SELECT BND_MST_SERV FROM T_BND_MST WHERE BND_MST_IDX = PM.PRD_MST_BRD_IDX) AS PRD_MST_BRD_SERV
            , FN_PRODUCT_DETAIL_PRICE('S2015121110290511588','P','','C',null) AS PRD_CPN_PC_DST_PRICE
            , FN_PRODUCT_DETAIL_PRICE('S2015121110290511588','M','','C',null) AS PRD_CPN_ML_DST_PRICE
            , FN_PRODUCT_DETAIL_PRICE('S2015121110290511588','P','','B',null) AS PRD_BRD_PC_CPN_CNT
            , FN_PRODUCT_DETAIL_PRICE('S2015121110290511588','M','','B',null) AS PRD_BRD_ML_CPN_CNT
            , NVL(PM.PRD_MST_BUY_PRC,0) AS PRD_MST_BUY_PRC
            , PM.PRD_MST_CRD_YN
            , PM.PRD_MST_CPN_OWN
        FROM
            T_PRD_MST PM  
        WHERE
            PM.PRD_MST_CD = #{PRD_MST_CD}    
    </select>
     
    <!-- 온라인 상품 상세 옵션 정보 조회 -->
    <select id="selectBasicOnlineProductOptionList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicOnlineProductOptionList */
        SELECT 
                PRP.PRD_OPT_IDX,
                PRP.PRD_MST_CD, 
                PRP.PRD_OPT_NM, 
                PRP.PRD_OPT_EST_YN, 
                PRP.PRD_OPT_CNT_YN,
                (SELECT COUNT(*) FROM T_OPT_DTL WHERE PRD_OPT_IDX = PRP. PRD_OPT_IDX) AS DTL_CNT
        FROM T_PRD_OPT PRP
        WHERE PRP.PRD_MST_CD = #{PRD_MST_CD}
        ORDER BY PRP.PRD_OPT_IDX
    </select>
    
    <!-- 온라인 상품 상세 옵션 상세 정보 조회 -->
    <select id="selectBasicOnlineProductOptionDetailList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicOnlineProductOptionDetailList */
        SELECT 
                OPD.OPT_DTL_IDX,
                OPD.PRD_OPT_IDX, 
                OPD.OPT_DTL_NM, 
                OPD.OPT_DTL_ADD_PRC,
                OPD.OPT_DTL_STK_CNT,
                OPD.OPT_DTL_ST_DT,
                OPD.OPT_DTL_ED_DT,
                OPD.OPT_DTL_USE_YN
        FROM T_OPT_DTL OPD 
        INNER JOIN T_PRD_OPT PRP ON OPD.PRD_OPT_IDX = PRP.PRD_OPT_IDX
        AND PRP.PRD_MST_CD = #{PRD_MST_CD}
     ORDER BY OPD.PRD_OPT_IDX , OPD.OPT_DTL_IDX ASC
    </select>
    
    
    <!-- 상품상세 브랜드 조회 -->
    <select id="selectBasicProductBrandList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicProductBrandList */
        SELECT      
            BND_MST_IDX,
            BND_MST_BRAND_NM,
            BND_MST_SERV
        FROM T_BND_MST
        WHERE
            BND_MST_USE_YN = 'Y'
    </select>
    
    <!-- 입점업체 조회 -->
    <select id="selectVendorList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectVendorList */
        SELECT 
            VDR_MST_IDX,
            VDR_MST_NM
        FROM
            T_VDR_MST
        WHERE
            VDR_MST_IDX <![CDATA[ <> ]]> -1
        ORDER BY VDR_MST_REG_DT DESC
    </select>
    
    <!-- 상품상세 제조사 조회 -->
    <select id="selectBasicProductMakerList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicProductMakerList */
        SELECT
            MRK_MST_IDX,
            MRK_MST_BRAND_NM
        FROM
            T_MRK_MST
        WHERE
            MRK_MST_USE_YN = 'Y'
    </select>
    
    <!-- 상품 마스터 키 검색 ERP 제품코드 + SEQ 8자리 -->
    <select id="selectBasicProductMasterCd" parameterType="hashMap" resultType="String">
        /* BasicProduct.selectBasicProductMasterCd */
        SELECT #{SET_PRD_MST_CD} || LPAD(SEQ_PRD_MST_CD.NEXTVAL ,7,'0')
          FROM DUAL
    </select> 
    
    <!-- 상품 마스터 입력 (직영몰관리자) -->
    <insert id="insertProductMaster" parameterType="hashmap" >
        /* BasicProduct.insertProductMaster */
        INSERT INTO T_PRD_MST (
                                PRD_MST_CD ,
                                PRD_MST_VDR_YN ,
                                PRD_MST_VDR_IDX ,
                                PRD_MST_TYPE ,
                                PRD_MST_BUY_TP ,
                                PRD_MST_NM ,
                                PRD_MST_NM_SUB ,
                                PRD_MST_LNG_DIV_YN ,
                                PRD_MST_LNG_DIV_MNT1 ,
                                PRD_MST_LNG_DIV_MNT2 ,
                                PRD_MST_MD_ID ,
                                PRD_MST_DLV_FEE ,
                                PRD_MST_CPS_YN ,
                                PRD_MST_CPS_MDL ,
                                PRD_MST_CPN_YN ,
                                PRD_MST_SEL_CNT ,
                                PRD_MST_PC_CPN_UNT ,
                                <if test="PRD_MST_PC_CPN_PRC != null and PRD_MST_PC_CPN_PRC != ''">
                                    PRD_MST_PC_CPN_PRC ,   
                                </if>
                                PRD_MST_MB_CPN_UNT ,
                                <if test="PRD_MST_MB_CPN_PRC != null and PRD_MST_MB_CPN_PRC != ''">
                                    PRD_MST_MB_CPN_PRC ,
                                </if>
                                <if test="PRD_MST_ADD_MIL != null and PRD_MST_ADD_MIL != ''">
                                    PRD_MST_ADD_MIL ,
                                </if>
                                PRD_MST_SRC_YN ,
                                PRD_MST_O2O_YN ,
                                PRD_MST_DLV_BND ,
                                PRD_MST_IVB_YN ,
                                PRD_MST_DLV_DSN_YN ,
                                <if test="PRD_MST_DLV_DSN_YN != null and PRD_MST_DLV_DSN_YN.equals('Y'.toString())">
                                    PRD_MST_DLV_DT ,
                                </if>
                                PRD_MST_PRC ,
                                PRD_MST_SCH_PRC ,
                                PRD_MST_CPR_PRC1 ,
                                PRD_MST_CPR_PRC2 ,
                                <if test="PRD_MST_PKG_PRC != null and PRD_MST_PKG_PRC != ''">
                                    PRD_MST_PKG_PRC ,
                                </if>
                                PRD_MST_CNL_PC_YN ,
                                PRD_MST_CNL_MB_YN ,
                                PRD_MST_SEL_STATE ,
                                PRD_MST_DPL_STATE ,
                                PRD_MST_APV_STATE ,
                                PRD_MST_PC_DTL_DSC ,
                                PRD_MST_MB_DTL_DSC ,
                                <if test="PRD_MST_NFI_IDX != null and PRD_MST_NFI_IDX != ''">
                                    PRD_MST_NFI_IDX ,
                                </if>
                                <if test="PRD_MST_BRD_IDX != null and PRD_MST_BRD_IDX != ''">
                                    PRD_MST_BRD_IDX ,    
                                </if>
                                <if test="PRD_MST_MRK_IDX != null and PRD_MST_MRK_IDX != ''">
                                    PRD_MST_MRK_IDX ,
                                </if>
                                PRD_MST_NFI_INF1 ,
                                PRD_MST_NFI_INF2 ,
                                PRD_MST_NFI_INF3 ,
                                PRD_MST_NFI_INF4 ,
                                PRD_MST_NFI_INF5 ,
                                PRD_MST_NFI_INF6 ,
                                PRD_MST_NFI_INF7 ,
                                PRD_MST_NFI_INF8 ,
                                PRD_MST_NFI_INF9 ,
                                PRD_MST_NFI_INF10 ,
                                PRD_MST_NFI_INF11 ,
                                PRD_MST_NFI_INF12 ,
                                PRD_MST_NFI_INF13 ,
                                PRD_MST_NFI_INF14 ,
                                PRD_MST_MTA_TAG1 ,
                                PRD_MST_MTA_TAG2 ,
                                PRD_MST_MTA_TAG3 ,
                                PRD_MST_MEMO ,
                                PRD_MST_RED_CNT ,
                                PRD_MST_ICN_YN1 ,
                                PRD_MST_ICN_ST_DT1 ,
                                PRD_MST_ICN_ED_DT1 ,
                                PRD_MST_ICN_YN2 ,
                                PRD_MST_ICN_ST_DT2 ,
                                PRD_MST_ICN_ED_DT2 ,
                                PRD_MST_ICN_YN3 ,
                                PRD_MST_ICN_ST_DT3 ,
                                PRD_MST_ICN_ED_DT3 ,
                                PRD_MST_ICN_YN4 ,
                                PRD_MST_ICN_ST_DT4 ,
                                PRD_MST_ICN_ED_DT4 ,
                                PRD_MST_ICN_YN5 ,
                                PRD_MST_ICN_ST_DT5 ,
                                PRD_MST_ICN_ED_DT5 ,
                                PRD_MST_DEL_YN ,
                                PRD_MST_REG_DT ,
                                PRD_MST_REG_IP ,
                                PRD_MST_REG_ID ,
                                PRD_MST_BUY_PRC ,
                                PRD_MST_CRD_YN ,
                                PRD_MST_CPN_OWN
                               ) 
        VALUES(
                #{PRD_MST_CD} ,
                #{PRD_MST_VDR_YN} ,
                #{PRD_MST_VDR_IDX},
                #{PRD_MST_TYPE} ,
                #{PRD_MST_BUY_TP} ,
                #{PRD_MST_NM} ,
                #{PRD_MST_NM_SUB} ,
                #{PRD_MST_LNG_DIV_YN} ,
                NVL(#{PRD_MST_LNG_DIV_MNT1},0) ,
                NVL(#{PRD_MST_LNG_DIV_MNT2},0) ,
                #{PRD_MST_MD_ID} ,
                #{PRD_MST_DLV_FEE} ,
                #{PRD_MST_CPS_YN} ,
                #{PRD_MST_CPS_MDL} ,
                #{PRD_MST_CPN_YN} ,
                #{PRD_MST_SEL_CNT} ,
                #{PRD_MST_PC_CPN_UNT} ,
                <if test="PRD_MST_PC_CPN_PRC != null and PRD_MST_PC_CPN_PRC != ''">
                    #{PRD_MST_PC_CPN_PRC} ,
                </if>
                #{PRD_MST_MB_CPN_UNT} ,
                <if test="PRD_MST_MB_CPN_PRC != null and PRD_MST_MB_CPN_PRC != ''">
                    #{PRD_MST_MB_CPN_PRC} ,
                </if>
                <if test="PRD_MST_ADD_MIL != null and PRD_MST_ADD_MIL != ''">
                    #{PRD_MST_ADD_MIL} ,
                </if>
                #{PRD_MST_SRC_YN} ,
                #{PRD_MST_O2O_YN} ,
                #{PRD_MST_DLV_BND} ,
                #{PRD_MST_IVB_YN} ,
                #{PRD_MST_DLV_DSN_YN} ,
                <if test="PRD_MST_DLV_DSN_YN != null and PRD_MST_DLV_DSN_YN.equals('Y'.toString())">
                    #{PRD_MST_DLV_DT} ,    
                </if>
                #{PRD_MST_PRC} ,
                #{PRD_MST_SCH_PRC} ,
                #{PRD_MST_CPR_PRC1} ,
                #{PRD_MST_CPR_PRC2} ,
                <if test="PRD_MST_PKG_PRC != null and PRD_MST_PKG_PRC != ''">
                    #{PRD_MST_PKG_PRC} ,
                </if>
                #{PRD_MST_CNL_PC_YN} ,
                #{PRD_MST_CNL_MB_YN} ,
                #{PRD_MST_SEL_STATE} ,
                #{PRD_MST_DPL_STATE} ,
                #{PRD_MST_APV_STATE} ,
                #{PRD_MST_DETAIL_DESC} ,
                #{PRD_MST_DETAIL_DESC2} ,
                <if test="PRD_MST_NFI_IDX != null and PRD_MST_NFI_IDX != ''">
                    #{PRD_MST_NFI_IDX} ,
                </if>
                <if test="PRD_MST_BRD_IDX != null and PRD_MST_BRD_IDX != ''">
                    #{PRD_MST_BRD_IDX} ,
                </if>
                <if test="PRD_MST_MRK_IDX != null and PRD_MST_MRK_IDX != ''">
                    #{PRD_MST_MRK_IDX} ,
                </if>
                #{PRD_MST_NFI_INF1} ,
                #{PRD_MST_NFI_INF2} ,
                #{PRD_MST_NFI_INF3} ,
                #{PRD_MST_NFI_INF4} ,
                #{PRD_MST_NFI_INF5} ,
                #{PRD_MST_NFI_INF6} ,
                #{PRD_MST_NFI_INF7} ,
                #{PRD_MST_NFI_INF8} ,
                #{PRD_MST_NFI_INF9} ,
                #{PRD_MST_NFI_INF10} ,
                #{PRD_MST_NFI_INF11} ,
                #{PRD_MST_NFI_INF12} ,
                #{PRD_MST_NFI_INF13} ,
                #{PRD_MST_NFI_INF14} ,
                #{PRD_MST_MTA_TAG1} ,
                #{PRD_MST_MTA_TAG2} ,
                #{PRD_MST_MTA_TAG3} ,
                #{PRD_MST_MEMO} ,
                0,
                #{PRD_MST_ICN_YN1} ,
                REPLACE(#{PRD_MST_ICN_ST_DT1},'-', '') ,
                REPLACE(#{PRD_MST_ICN_ED_DT1},'-', '') ,
                #{PRD_MST_ICN_YN2} ,
                REPLACE(#{PRD_MST_ICN_ST_DT2},'-', '') ,
                REPLACE(#{PRD_MST_ICN_ED_DT2},'-', '') ,
                #{PRD_MST_ICN_YN3} ,
                REPLACE(#{PRD_MST_ICN_ST_DT3},'-', '') ,
                REPLACE(#{PRD_MST_ICN_ED_DT3},'-', '') ,
                #{PRD_MST_ICN_YN4} ,
                REPLACE(#{PRD_MST_ICN_ST_DT4},'-', '') ,
                REPLACE(#{PRD_MST_ICN_ED_DT4},'-', '') ,
                #{PRD_MST_ICN_YN5} ,
                REPLACE(#{PRD_MST_ICN_ST_DT5},'-', '') ,
                REPLACE(#{PRD_MST_ICN_ED_DT5},'-', '') ,
                'N' ,
                TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS') ,
                #{PRD_MST_REG_IP} ,
                #{PRD_MST_REG_ID} ,
                NVL(#{PRD_MST_BUY_PRC},0)  ,
                #{PRD_MST_CRD_YN} ,
                #{PRD_MST_CPN_OWN}
            )
    </insert>
    
    <!-- 입점업체 상품 수정 요청 등록 -->
    <insert id="insertProductVdr" parameterType="hashmap" >
        INSERT INTO T_VDR_APV
        (
            VDR_APV_IDX,
            PRD_MST_CD,
            VDR_MST_IDX,
            PRD_MST_PRC,
            PRD_MST_SCH_PRC,
            PRD_MST_SEL_STATE,
            PRD_MST_SEL_CNT,
            PRD_MST_PC_CPN_UNT,
            <if test="PRD_MST_PC_CPN_PRC != null and PRD_MST_PC_CPN_PRC != ''">
                PRD_MST_PC_CPN_PRC,    
            </if>
            PRD_MST_MB_CPN_UNT,
            <if test="PRD_MST_MB_CPN_PRC != null and PRD_MST_MB_CPN_PRC != ''">
                PRD_MST_MB_CPN_PRC,
            </if>
            VDR_APV_REG_DT,
            VDR_APV_REG_IP,
            VDR_APV_APV_STATE,
            VDR_APV_CPN_OWN
        )
        VALUES
        (
            SEQ_VDR_APV_IDX.NEXTVAL,
            #{PRD_MST_CD},
            #{VDR_MST_IDX},
            #{PRD_MST_PRC},
            #{PRD_MST_SCH_PRC},
            #{PRD_MST_SEL_STATE},
            #{PRD_MST_SEL_CNT},
            #{PRD_MST_PC_CPN_UNT},
            <if test="PRD_MST_PC_CPN_PRC != null and PRD_MST_PC_CPN_PRC != ''">
                #{PRD_MST_PC_CPN_PRC},
            </if>
            #{PRD_MST_MB_CPN_UNT},
            <if test="PRD_MST_MB_CPN_PRC != null and PRD_MST_MB_CPN_PRC != ''">
                #{PRD_MST_MB_CPN_PRC},
            </if>
            TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'),
            #{VDR_APV_REG_IP},
            'D',
            #{VDR_APV_CPN_OWN}
        )
    </insert>
        
    <!-- 상품 마스터 수정  -->
    <update id="updateProductMaster" parameterType="hashmap" >
        /* BasicProduct.updateProductMaster */
        UPDATE 
            T_PRD_MST
        SET
            PRD_MST_NM = #{PRD_MST_NM}
            , PRD_MST_NM_SUB = #{PRD_MST_NM_SUB}
            , PRD_MST_LNG_DIV_YN = #{PRD_MST_LNG_DIV_YN}
            , PRD_MST_LNG_DIV_MNT1 = NVL(#{PRD_MST_LNG_DIV_MNT1},0)
            , PRD_MST_LNG_DIV_MNT2 = NVL(#{PRD_MST_LNG_DIV_MNT2},0)
            , PRD_MST_MD_ID = #{PRD_MST_MD_ID}
            , PRD_MST_DLV_FEE = #{PRD_MST_DLV_FEE}
            , PRD_MST_CPS_YN = #{PRD_MST_CPS_YN}
            , PRD_MST_CPS_MDL = #{PRD_MST_CPS_MDL}
            , PRD_MST_CPN_YN = #{PRD_MST_CPN_YN}
            , PRD_MST_SEL_CNT = #{PRD_MST_SEL_CNT}
            , PRD_MST_PC_CPN_UNT = #{PRD_MST_PC_CPN_UNT}
            , PRD_MST_PC_CPN_PRC = #{PRD_MST_PC_CPN_PRC}
            , PRD_MST_MB_CPN_UNT = #{PRD_MST_MB_CPN_UNT}
            , PRD_MST_MB_CPN_PRC = #{PRD_MST_MB_CPN_PRC}
            <if test="PRD_MST_ADD_MIL != null and PRD_MST_ADD_MIL != ''">
                , PRD_MST_ADD_MIL = #{PRD_MST_ADD_MIL}
            </if>
            , PRD_MST_SRC_YN = #{PRD_MST_SRC_YN}
            , PRD_MST_O2O_YN = #{PRD_MST_O2O_YN}
            , PRD_MST_DLV_BND = #{PRD_MST_DLV_BND}
            , PRD_MST_IVB_YN = #{PRD_MST_IVB_YN}
            , PRD_MST_DLV_DSN_YN = #{PRD_MST_DLV_DSN_YN}
            <if test="PRD_MST_DLV_DSN_YN != null and PRD_MST_DLV_DSN_YN.equals('Y'.toString())">
                , PRD_MST_DLV_DT = #{PRD_MST_DLV_DT}    
            </if>
            , PRD_MST_PRC = #{PRD_MST_PRC}
            , PRD_MST_SCH_PRC = #{PRD_MST_SCH_PRC}
            , PRD_MST_CPR_PRC1 = #{PRD_MST_CPR_PRC1}
            , PRD_MST_CPR_PRC2 = #{PRD_MST_CPR_PRC2}
            <if test="PRD_MST_PKG_PRC != null and PRD_MST_PKG_PRC != ''">
                , PRD_MST_PKG_PRC = #{PRD_MST_PKG_PRC}
            </if>
            , PRD_MST_CNL_PC_YN = NVL(#{PRD_MST_CNL_PC_YN},'N')          /* 쇼핑채널 PC*/
            , PRD_MST_CNL_MB_YN = NVL(#{PRD_MST_CNL_MB_YN},'N')  /* 쇼핑채널 MOBILE*/
            , PRD_MST_DPL_STATE = #{PRD_MST_DPL_STATE}
            , PRD_MST_SEL_STATE = #{PRD_MST_SEL_STATE}
            , PRD_MST_APV_STATE = #{PRD_MST_APV_STATE}
            , PRD_MST_ICN_YN1 = #{PRD_MST_ICN_YN1}
            , PRD_MST_ICN_ST_DT1 = REPLACE(#{PRD_MST_ICN_ST_DT1},'-', '')
            , PRD_MST_ICN_ED_DT1 = REPLACE(#{PRD_MST_ICN_ED_DT1},'-', '')
            , PRD_MST_ICN_YN2 = #{PRD_MST_ICN_YN2}
            , PRD_MST_ICN_ST_DT2 = REPLACE(#{PRD_MST_ICN_ST_DT2},'-', '')
            , PRD_MST_ICN_ED_DT2 = REPLACE(#{PRD_MST_ICN_ED_DT2},'-', '')
            , PRD_MST_ICN_YN3 = #{PRD_MST_ICN_YN3}
            , PRD_MST_ICN_ST_DT3 = REPLACE(#{PRD_MST_ICN_ST_DT3},'-', '')
            , PRD_MST_ICN_ED_DT3 = REPLACE(#{PRD_MST_ICN_ED_DT3},'-', '')
            , PRD_MST_ICN_YN4 = #{PRD_MST_ICN_YN4}
            , PRD_MST_ICN_ST_DT4 = REPLACE(#{PRD_MST_ICN_ST_DT4},'-', '')
            , PRD_MST_ICN_ED_DT4 = REPLACE(#{PRD_MST_ICN_ED_DT4},'-', '')
            , PRD_MST_ICN_YN5 = #{PRD_MST_ICN_YN5}
            , PRD_MST_ICN_ST_DT5 = REPLACE(#{PRD_MST_ICN_ST_DT5},'-', '')
            , PRD_MST_ICN_ED_DT5 = REPLACE(#{PRD_MST_ICN_ED_DT5},'-', '')
            , PRD_MST_PC_DTL_DSC = #{PRD_MST_DETAIL_DESC}         /* 상품_상세설명 */
            , PRD_MST_MB_DTL_DSC = #{PRD_MST_DETAIL_DESC2}         /* 상품_상세설명 */
            <if test="PRD_MST_NFI_IDX != null and PRD_MST_NFI_IDX != ''">
                , PRD_MST_NFI_IDX = #{PRD_MST_NFI_IDX}    
            </if>
            <if test="PRD_MST_BRD_IDX != null and PRD_MST_BRD_IDX != ''">
                , PRD_MST_BRD_IDX = #{PRD_MST_BRD_IDX}    
            </if>
            <if test="PRD_MST_MRK_IDX != null and PRD_MST_MRK_IDX != ''">
                , PRD_MST_MRK_IDX = #{PRD_MST_MRK_IDX}    
            </if>
            , PRD_MST_NFI_INF1 = #{PRD_MST_NFI_INF1}
            , PRD_MST_NFI_INF2 = #{PRD_MST_NFI_INF2}
            , PRD_MST_NFI_INF3 = #{PRD_MST_NFI_INF3}
            , PRD_MST_NFI_INF4 = #{PRD_MST_NFI_INF4}
            , PRD_MST_NFI_INF5 = #{PRD_MST_NFI_INF5}
            , PRD_MST_NFI_INF6 = #{PRD_MST_NFI_INF6}
            , PRD_MST_NFI_INF7 = #{PRD_MST_NFI_INF7}
            , PRD_MST_NFI_INF8 = #{PRD_MST_NFI_INF8}
            , PRD_MST_NFI_INF9 = #{PRD_MST_NFI_INF9}
            , PRD_MST_NFI_INF10 = #{PRD_MST_NFI_INF10}
            , PRD_MST_NFI_INF11 = #{PRD_MST_NFI_INF11}
            , PRD_MST_NFI_INF12 = #{PRD_MST_NFI_INF12}
            , PRD_MST_NFI_INF13 = #{PRD_MST_NFI_INF13}
            , PRD_MST_NFI_INF14 = #{PRD_MST_NFI_INF14}
            , PRD_MST_MTA_TAG1 = #{PRD_MST_MTA_TAG1}
            , PRD_MST_MTA_TAG2 = #{PRD_MST_MTA_TAG2}
            , PRD_MST_MTA_TAG3 = #{PRD_MST_MTA_TAG3}
            , PRD_MST_MEMO = #{PRD_MST_MEMO}
            , PRD_MST_UPD_DT = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , PRD_MST_UPD_ID = #{PRD_MST_UPD_ID}
            , PRD_MST_UPD_IP = #{PRD_MST_UPD_IP}
            , PRD_MST_CRD_YN = #{PRD_MST_CRD_YN}
            , PRD_MST_CPN_OWN = #{PRD_MST_CPN_OWN}
        WHERE
            PRD_MST_CD = #{PRD_MST_CD}
    </update>
    
    <!-- 상품 다중 수정  -->
    <update id="updateProductListMaster" parameterType="hashmap" >
        /* BasicProduct.updateProductListMaster */
        UPDATE 
            T_PRD_MST
        SET
            PRD_MST_NM = #{PRD_MST_NM}
            , PRD_MST_PRC = #{PRD_MST_PRC}
            , PRD_MST_SCH_PRC = #{PRD_MST_SCH_PRC}
            , PRD_MST_DLV_FEE = #{PRD_MST_DLV_FEE}
            , PRD_MST_DPL_STATE = #{PRD_MST_DPL_STATE}
            , PRD_MST_SEL_STATE = #{PRD_MST_SEL_STATE}
            , PRD_MST_APV_STATE = #{PRD_MST_APV_STATE}
            , PRD_MST_SEL_CNT = #{PRD_MST_SEL_CNT}
            , PRD_MST_PC_CPN_UNT = #{PRD_MST_PC_CPN_UNT}
            , PRD_MST_PC_CPN_PRC = #{PRD_MST_PC_CPN_PRC}
            , PRD_MST_MB_CPN_UNT = #{PRD_MST_MB_CPN_UNT}
            , PRD_MST_MB_CPN_PRC = #{PRD_MST_MB_CPN_PRC}
            , PRD_MST_CPN_OWN = #{PRD_MST_CPN_OWN}
            , PRD_MST_UPD_DT = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , PRD_MST_UPD_ID = #{PRD_MST_UPD_ID}
            , PRD_MST_UPD_IP = #{PRD_MST_UPD_IP}
        WHERE
            PRD_MST_CD = #{PRD_MST_CD}
    </update>
    
    <!-- 입점업체 상품 승인처리  -->
    <update id="updateBasicProductApv" parameterType="hashmap" >
        /* BasicProduct.updateBasicProductApv */
        UPDATE 
            T_PRD_MST
        SET
            PRD_MST_APV_STATE = 'A'
            , PRD_MST_UPD_DT = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , PRD_MST_UPD_ID = #{PRD_MST_UPD_ID}
            , PRD_MST_UPD_IP = #{PRD_MST_UPD_IP}
        WHERE
            PRD_MST_CD = #{PRD_MST_CD}
    </update>
    
    <!-- 상품 옵션 등록 -->
    <insert id="insertBasicProductOption" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.insertBasicProductOption */
        INSERT INTO T_PRD_OPT (
            PRD_OPT_IDX, PRD_OPT_NM, PRD_PRD_MST_CD, PRD_OPT_STOCK_CNT, PRD_OPT_ORDER_CNT
        ) VALUES (
            SEQ_PRD_OPT_IDX.NEXTVAL, #{PRD_OPT_NM}, #{PRD_MST_CD}, #{PRD_OPT_STOCK_CNT}, #{PRD_OPT_ORDER_CNT}
        )
        ]]>
    </insert>    
    
    <!-- 상품 전시 카테고리 등록 -->
    <insert id="insertDisplayCategory" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.insertDisplayCategory */
        INSERT INTO T_DSP_CTG (
            DSP_CTG_IDX, DSP_PRD_CTG_IDX, DSP_PRD_MST_CD
        ) VALUES (
            SEQ_DSP_CTG_IDX.NEXTVAL, #{PRD_CTG_IDX}, #{PRD_MST_CD}
        )
        ]]>
    </insert>
    
    <!-- 상품 전시 카테고리 삭제 -->
    <delete id="deleteDisplayCategory" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteDisplayCategory */
        DELETE FROM T_DSP_CTG WHERE DSP_PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </delete>
    
    <!-- 상품 스펙 삭제 -->
    <delete id="deleteDisplaySpec" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteDisplaySpec */
        DELETE FROM T_DSP_CTG WHERE DSP_PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </delete>

    <!-- 상품 카테고리 리스트 조회 -->
    <select id="selectBasicProductCategoryList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicProductCategoryList */
        SELECT 
            DSP_PRD_CTG_IDX,
            DSP_CTG_IDX,
            PRD_CTG_ENV,
            FN_CATEGORY_PATH(DSP_PRD_CTG_IDX) PRD_CTG_PATH
        FROM 
         T_DSP_CTG, T_PRD_CTG
        WHERE 
         T_DSP_CTG.DSP_PRD_CTG_IDX = T_PRD_CTG.PRD_CTG_IDX
            AND DSP_PRD_MST_CD = #{PRD_MST_CD}
        <if test="PRD_CTG_ENV != null and PRD_CTG_ENV != ''">
            AND T_PRD_CTG.PRD_CTG_ENV = #{PRD_CTG_ENV}
        </if>
        ORDER BY T_DSP_CTG.DSP_CTG_IDX
    </select>
    
    <!-- 상품 이미지 등록 -->
    <insert id="insertProductImage" parameterType="hashMap" >
        /* BasicProduct.insertProductImage */
        INSERT INTO T_PRD_IMG (
            PRD_PRD_MST_CD, PRD_IMG_IDX, PRD_IMG_SORT, PRD_IMG_ATT_PATH, PRD_IMG_SYS_NM, 
            PRD_IMG_ATT_SIZE, PRD_IMG_URL_PATH, PRD_IMG_ORG_NM, PRD_IMG_REG_DT, PRD_IMG_ALT_TEXT 
        )VALUES (
            #{PRD_MST_CD}, #{PRD_IMG_IDX}, #{PRD_IMG_SORT}, #{PRD_IMG_ATT_PATH}, #{PRD_IMG_SYS_NM}, 
            #{PRD_IMG_ATT_SIZE}, #{PRD_IMG_URL_PATH}, #{PRD_IMG_ORG_NM}, TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS'), #{PRD_IMG_ALT_TEXT}
        )
    </insert>
    
    <!-- 상품 이미지 삭제 -->
    <insert id="deleteProductImage" parameterType="hashMap" >
        /* BasicProduct.deleteProductImage */
        DELETE FROM 
         T_PRD_IMG 
        WHERE 
            PRD_PRD_MST_CD = #{PRD_MST_CD}
    </insert>
    
    <!-- 상품 이미지 리스트 조회 -->
    <select id="selectProductImageList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectProductImageList */
        SELECT
            PRD_IMG_IDX, 
            PRD_IMG_SORT,
            PRD_IMG_ATT_PATH, 
            PRD_IMG_SYS_NM, 
            PRD_IMG_ATT_SIZE, 
            PRD_IMG_URL_PATH, 
            PRD_IMG_ORG_NM,
            PRD_IMG_ALT_TEXT
        FROM 
         T_PRD_IMG
        WHERE 
            PRD_PRD_MST_CD = #{PRD_MST_CD}
        ORDER BY PRD_IMG_SORT ASC, PRD_IMG_IDX ASC      
    </select>  
    
    <!-- 엑셀 업로드 상품마스터 수정 -->
    <update id="updateProductInfoByExcel" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.updateProductInfoByExcel */
        UPDATE 
            T_PRD_MST
        SET
            PRD_MST_UPD_DT = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , PRD_MST_UPD_ID = #{PRD_MST_UPD_ID}
            , PRD_MST_UPD_IP = #{PRD_MST_UPD_IP}
            ]]>
            <if test="PRD_MST_CHANNEL_TYPE != null and PRD_MST_CHANNEL_TYPE != ''">
                , PRD_MST_CHANNEL_TYPE = #{PRD_MST_CHANNEL_TYPE}       /* 쇼핑채널 */
            </if>
            <if test="PRD_MST_SEL_STATE != null and PRD_MST_SEL_STATE != ''">
                , PRD_MST_SEL_STATE = #{PRD_MST_SEL_STATE}
            </if>
            <if test="PRD_MST_DETAIL_DESC != null and PRD_MST_DETAIL_DESC != ''">
                , PRD_MST_DETAIL_DESC = #{PRD_MST_DETAIL_DESC}         /* 상품_상세설명 */  
            </if>
            <if test="PRD_MST_DETAIL_TXT != null and PRD_MST_DETAIL_TXT != ''">
                , PRD_MST_DETAIL_TXT = #{PRD_MST_DETAIL_TXT}             /* 상품_대체텍스트 */
            </if>
            <if test="PRD_MST_DETAIL_IMG_YN != null and PRD_MST_DETAIL_IMG_YN != ''">
                , PRD_MST_DETAIL_IMG_YN = #{PRD_MST_DETAIL_IMG_YN}   /* 상품이미지 설명노출 여부 */
            </if>
            <![CDATA[    
        WHERE
            PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </update>
    
    <!-- 상품 개수(일괄 업로드용) -->             
    <select id="selectProductCountByPrdMstCd" parameterType="hashMap" resultType="integer">
        SELECT COUNT(1) FROM T_PRD_MST WHERE PRD_MST_CD = #{PRD_MST_CD}
    </select>
    

    <!-- 관리자 > 상품관리 > MD회원리스트 -->
    <select id="selectBasicMdList" parameterType="hashMap" resultType="hashMap">
       /* BasicProduct.selectBasicMdList */  
        SELECT
            ADM_MST_ID,
            ADM_MST_NM
        FROM
            T_ADM_MST AM
        WHERE
            AM.AUT_MST_IDX = #{AUT_MST_IDX}
    </select> 
    
    <!-- 옵션 마스터 등록 -->
    <insert id="insertProductOptionMaster" parameterType="hashmap" >
        <selectKey keyProperty="PRD_OPT_IDX" resultType="int" order="BEFORE">
            SELECT SEQ_PRD_OPT_IDX.NEXTVAL AS PRD_OPT_IDX FROM DUAL
        </selectKey>
        /* BasicProduct.insertProductOptionMaster */
        INSERT INTO T_PRD_OPT (
            PRD_OPT_IDX, PRD_MST_CD, PRD_OPT_NM, PRD_OPT_EST_YN, PRD_OPT_CNT_YN
        )VALUES (
            #{PRD_OPT_IDX}, #{PRD_MST_CD}, #{PRD_OPT_NM}, #{PRD_OPT_EST_YN}, #{PRD_OPT_CNT_YN}
        )
    </insert>
    
    <!-- 옵션 상세 등록 -->
    <insert id="insertProductOptionDetail" parameterType="hashmap" >
        /* BasicProduct.insertProductOptionDetail */
        INSERT INTO T_OPT_DTL (
            OPT_DTL_IDX
            , PRD_OPT_IDX
            , OPT_DTL_NM
            , OPT_DTL_ADD_PRC
            , OPT_DTL_STK_CNT
            , OPT_DTL_ST_DT
            , OPT_DTL_ED_DT
            , OPT_DTL_USE_YN
        )VALUES (
            SEQ_OPT_DTL_IDX.NEXTVAL
            , #{PRD_OPT_IDX}
            , #{OPT_DTL_NM}
            , NVL(#{OPT_DTL_ADD_PRC},0)
            , NVL(#{OPT_DTL_STK_CNT},0)
            , NVL(#{OPT_DTL_ST_DT},TO_CHAR(SYSDATE, 'YYYYMMDD'))
            , NVL(#{OPT_DTL_ED_DT},'99991231')
            , #{OPT_DTL_USE_YN}
        )
    </insert>
    
    <!-- 옵션 마스터 수정 -->
    <update id="updateProductOptionMaster" parameterType="hashmap">
        /* BasicProduct.updateProductOptionMaster */
        UPDATE T_PRD_OPT
        SET PRD_OPT_NM = #{PRD_OPT_NM}
        , PRD_OPT_EST_YN = #{PRD_OPT_EST_YN}
        , PRD_OPT_CNT_YN = #{PRD_OPT_CNT_YN}
        WHERE PRD_OPT_IDX = #{PRD_OPT_IDX}
        AND PRD_MST_CD = #{PRD_MST_CD}
        
    </update>
    
    <!-- 옵션 상세 수정 -->
    <update id="updateProductOptionDetail" parameterType="hashmap">
        /* BasicProduct.updateProductOptionDetail */
        UPDATE T_OPT_DTL
        SET OPT_DTL_NM = #{OPT_DTL_NM}
        , OPT_DTL_ADD_PRC = NVL(#{OPT_DTL_ADD_PRC},0)
        , OPT_DTL_STK_CNT = NVL(#{OPT_DTL_STK_CNT},0)
        , OPT_DTL_ST_DT = NVL(#{OPT_DTL_ST_DT},TO_CHAR(SYSDATE, 'YYYYMMDD'))
        , OPT_DTL_ED_DT = NVL(#{OPT_DTL_ED_DT},'99991231')
        , OPT_DTL_USE_YN = #{OPT_DTL_USE_YN}
        WHERE OPT_DTL_IDX = #{OPT_DTL_IDX}
        AND PRD_OPT_IDX = #{PRD_OPT_IDX}
    </update>
    
    <!-- 옵션 마스터 삭제 -->
    <delete id="deleteProductOptionMaster" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteProductOptionMaster */
        DELETE FROM T_PRD_OPT WHERE PRD_OPT_IDX = #{PRD_OPT_IDX} AND PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </delete>
    
    <!-- 옵션 상세 마스터키로 삭제 -->
    <delete id="deleteProductOptionDetailMasterKey" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteProductOptionDetailMasterKey */
        DELETE FROM T_OPT_DTL WHERE PRD_OPT_IDX = #{PRD_OPT_IDX}
        ]]>
    </delete>
    
    <!-- 옵션 상세 삭제 -->
    <delete id="deleteProductOptionDetail" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteProductOptionDetail */
        DELETE FROM T_OPT_DTL WHERE OPT_DTL_IDX = #{OPT_DTL_IDX}
        ]]>
    </delete>
    
    <!-- 상품 스펙 등록 -->
    <insert id="insertDisplaySpec" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.insertDisplaySpec */
        INSERT INTO T_PRD_SPC (
            PRD_SPC_IDX, SPC_MST_IDX, PRD_MST_CD
        ) VALUES (
            SEQ_PRD_SPC_IDX.NEXTVAL, #{SPC_MST_IDX}, #{PRD_MST_CD}
        )
        ]]>
    </insert>
    
    <!-- 상품 스펙 삭제 -->
    <delete id="deleteDisplaySpecAll" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteDisplaySpec */
        DELETE FROM T_PRD_SPC WHERE PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </delete>
    
    <!-- 상품 카테고리 리스트 조회 -->
    <select id="selectBasicProductSpecList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicProductSpecList */
        SELECT 
            T_PRD_SPC.PRD_SPC_IDX,
            T_PRD_SPC.SPC_MST_IDX,
            T_SPC_MST.SPC_MST_ENV,
            FN_SPEC_PATH(T_PRD_SPC.SPC_MST_IDX) SPC_MST_PATH
        FROM 
         T_PRD_SPC, T_SPC_MST
        WHERE 
         T_PRD_SPC.SPC_MST_IDX = T_SPC_MST.SPC_MST_IDX
            AND T_PRD_SPC.PRD_MST_CD = #{PRD_MST_CD}
        <if test="SPC_MST_ENV != null and SPC_MST_ENV != ''">
            AND T_SPC_MST.SPC_MST_ENV = #{SPC_MST_ENV}
        </if>
        ORDER BY T_PRD_SPC.SPC_MST_IDX
    </select>
    
    <!-- 상품 다중 삭제  -->
    <update id="deleteProductMaster" parameterType="hashmap" >
        /* BasicProduct.deleteProductMaster */
        UPDATE 
            T_PRD_MST
        SET
            PRD_MST_DEL_YN = 'Y'
            , PRD_MST_UPD_DT = TO_CHAR(SYSDATE, 'YYYYMMDDHH24MISS')
            , PRD_MST_UPD_ID = #{PRD_MST_UPD_ID}
            , PRD_MST_UPD_IP = #{PRD_MST_UPD_IP}
        WHERE
            PRD_MST_CD = #{PRD_MST_CD}
    </update>
    
    <!-- 상품 관련 콘텐츠 삭제 -->
    <delete id="deleteDisplayEmagazine" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteDisplayEmagazine */
        DELETE FROM T_PRD_MGZ WHERE PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </delete>
    
    <!-- 상품 관련콘텐츠 등록 -->
    <insert id="insertDisplayEmagazine" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.insertDisplayEmagazine */
        INSERT INTO T_PRD_MGZ (
            PRD_MGZ_IDX, PRD_MST_CD, MGZ_MST_IDX
        ) VALUES (
            SEQ_PRD_MGZ_IDX.NEXTVAL, #{PRD_MST_CD} , #{MGZ_MST_IDX}
        )
        ]]>
    </insert>
    
    <!-- 상품상세 관련콘텐츠 조회 -->
    <select id="selectBasicProductEmagazineList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectBasicProductEmagazineList */
        SELECT
            MGZ.MGZ_MST_IDX,
            (SELECT CMN_COM_NM FROM T_CMM_COM WHERE CMN_COM_IDX =  MGZ.MGZ_MST_CTG) AS MGZ_MST_CTG,
            MGZ.MGZ_MST_TITLE
        FROM
            T_PRD_MGZ PMZ
            INNER JOIN T_MGZ_MST MGZ ON MGZ.MGZ_MST_IDX = PMZ.MGZ_MST_IDX
        WHERE
            PMZ.PRD_MST_CD = #{PRD_MST_CD}
    </select>
    
    <!-- 상품 검색채널 마스터 등록 -->
    <insert id="insertChannelMaster" parameterType="hashmap" >
        <selectKey keyProperty="PRD_CHN_IDX" resultType="int" order="BEFORE"> 
            SELECT SEQ_PRD_CHN_IDX.NEXTVAL FROM DUAL 
        </selectKey> 
        <![CDATA[
        /* BasicProduct.insertChannelMaster */
        INSERT INTO T_PRD_CHN (
            PRD_CHN_IDX, PRD_MST_CD, PRD_CHN_DPT2, PRD_CHN_ECH_PRC
        ) VALUES (
            #{PRD_CHN_IDX}, #{PRD_MST_CD}, #{PRD_CHN_DPT2}, #{PRD_CHN_ECH_PRC}
        )
        ]]>
    </insert>
    
    <!-- 상품 검색채널 상세 등록 -->
    <insert id="insertChannelDetail" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.insertChannelDetail */
        INSERT INTO T_PRD_CHN_DTL (
            PRD_CHN_DTL_IDX, PRD_CHN_IDX, CHN_DTL_CD, PRD_CHN_PRC
        ) VALUES (
            SEQ_PRD_CHN_DTL_IDX.NEXTVAL, #{PRD_CHN_IDX}, #{CHN_DTL_CD}, #{PRD_CHN_PRC}
        )
        ]]>
    </insert>
    
    <!-- 채널 마스터 정보 -->
    <select id="selectbasicChnMstList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectbasicChnMstList */
        SELECT 
            CMT.CHN_MST_IDX
            , CMT.CHN_MST_NM
            , CMT.CHN_MST_LEVEL
            , CMT.CHN_MST_UP_IDX
            , PCN.PRD_MST_CD
            , PCN.PRD_CHN_IDX
            , PCN.PRD_CHN_DPT2
            , PCN.PRD_CHN_ECH_PRC
            , CASE WHEN ( SELECT COUNT(*) FROM T_PRD_CHN_DTL WHERE PRD_CHN_IDX = PCN.PRD_CHN_IDX) > 0 THEN 'Y' ELSE 'N' END AS PRD_CHN_YN
        FROM T_CHN_MST CMT
        LEFT OUTER JOIN T_PRD_CHN PCN ON CMT.CHN_MST_IDX = PCN.PRD_CHN_DPT2 AND PCN.PRD_MST_CD = #{PRD_MST_CD}
        WHERE CMT.CHN_MST_UP_IDX IN
            <foreach collection="arrCHN_MST_UP_IDX" item="CHN_MST_UP_IDX" open="(" close=")" separator=",">#{CHN_MST_UP_IDX}</foreach>
        AND CMT.CHN_MST_LEVEL = 3
        ORDER BY CMT.CHN_MST_IDX ASC
    </select>
    
    <!-- 채널 마스터 정보 -->
    <select id="selectbasicChnDtlList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectbasicChnDtlList */
        SELECT 
            CDL.CHN_DTL_CD
            , CDL.CHN_MST_IDX
            , CDL.CHN_DTL_NM
            , PDT.PRD_CHN_IDX
            , PDT.CHN_DTL_CD AS PRD_CHN_DTL_CD
            , PDT.PRD_CHN_PRC
            , CASE WHEN CDL.CHN_DTL_CD = PDT.CHN_DTL_CD THEN 'Y' ELSE 'N' END AS PRD_CHN_DTL_YN
        FROM T_CHN_DTL CDL
        INNER JOIN T_CHN_MST CMT 
            ON CDL.CHN_MST_IDX = CMT.CHN_MST_IDX 
            AND CHN_MST_UP_IDX IN
                <foreach collection="arrCHN_MST_UP_IDX" item="CHN_MST_UP_IDX" open="(" close=")" separator=",">#{CHN_MST_UP_IDX}</foreach>
        LEFT OUTER JOIN (
                SELECT 
                PCD.PRD_CHN_DTL_IDX
                , PCD.PRD_CHN_IDX
                , PCD.CHN_DTL_CD
                , PCD.PRD_CHN_PRC
                FROM T_PRD_CHN_DTL PCD
                INNER JOIN T_PRD_CHN PCN ON PCD.PRD_CHN_IDX = PCN.PRD_CHN_IDX AND PRD_MST_CD = #{PRD_MST_CD}
                ORDER BY PCD.PRD_CHN_IDX , PCD.PRD_CHN_DTL_IDX ASC
                        ) PDT
            ON CDL.CHN_DTL_CD = PDT.CHN_DTL_CD
        WHERE CDL.CHN_DTL_USE_YN = 'Y'
        ORDER BY CDL.CHN_MST_IDX , CDL.CHN_DTL_CD ASC
    </select>
    
    <!-- 제휴채널 정보 -->
    <select id="selectbasicChnAlliListList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectbasicChnAlliListList */
        SELECT 
            CHN_MST_IDX
            , CHN_MST_NM
            , CHN_MST_LEVEL
            , CHN_MST_UP_IDX
        FROM T_CHN_MST 
        WHERE CHN_MST_UP_IDX = 1
        AND CHN_MST_LEVEL = 3
        ORDER BY CHN_MST_IDX ASC
    </select>
    
    <!-- 제휴채널 하위뎁스 정보 -->
    <select id="selectSubChannelList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectSubChannelList */
        SELECT 
            CDL.CHN_DTL_CD
            , CDL.CHN_MST_IDX
            , CDL.CHN_DTL_NM
        FROM T_CHN_DTL CDL
        INNER JOIN T_CHN_MST CMT 
            ON CDL.CHN_MST_IDX = CMT.CHN_MST_IDX AND CMT.CHN_MST_UP_IDX = 1
        WHERE CDL.CHN_DTL_USE_YN = 'Y'
        AND CDL.CHN_MST_IDX = #{CHN_MST_IDX}
        ORDER BY CDL.CHN_MST_IDX , CDL.CHN_DTL_CD ASC
    </select>
    
    <!-- 상품에 속한 채널 마스터 -->
    <select id="selectbasicProductChnAlliList" parameterType="hashMap" resultType="hashMap">
        /* BasicProduct.selectbasicProductChnAlliList */
        SELECT 
            PCD.PRD_CHN_DTL_IDX
            , PCD.PRD_CHN_IDX
            , PCD.CHN_DTL_CD
            , PCD.PRD_CHN_PRC
            , (SELECT CHN_DTL_NM FROM T_CHN_DTL WHERE CHN_DTL_CD = PCD.CHN_DTL_CD) AS CHN_DTL_NM
            , PCN.PRD_CHN_DPT2
        FROM T_PRD_CHN_DTL PCD
        INNER JOIN T_PRD_CHN PCN ON PCN.PRD_CHN_IDX = PCD.PRD_CHN_IDX 
        WHERE PCN.PRD_MST_CD = #{PRD_MST_CD}
        AND PCN.PRD_CHN_DPT2 IN (       
                                SELECT 
                                    CHN_MST_IDX
                                FROM T_CHN_MST 
                                WHERE CHN_MST_UP_IDX = 1
                                AND CHN_MST_LEVEL = 3
                            )
    </select>
    
    <!-- 상품 채널 상세 삭제 -->
    <delete id="deleteChannelDetail" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteChannelDetail */
        DELETE FROM T_PRD_CHN_DTL
        WHERE PRD_CHN_IDX IN (
                                SELECT PRD_CHN_IDX FROM  T_PRD_CHN WHERE PRD_MST_CD = #{PRD_MST_CD}
                            )
        ]]>
    </delete>
    
    <!-- 상품 채널 마스터 삭제 -->
    <delete id="deleteChannelMaster" parameterType="hashmap" >
        <![CDATA[
        /* BasicProduct.deleteChannelMaster */
        DELETE FROM T_PRD_CHN WHERE PRD_MST_CD = #{PRD_MST_CD}
        ]]>
    </delete>
    
    <!-- 상품 마스터 수정  -->
    <update id="updateProductMstVdr" parameterType="hashmap" >
        /* BasicProduct.updateProductMstVdr */
        UPDATE 
            T_PRD_MST
        SET
             PRD_MST_SEL_STATE = #{PRD_MST_SEL_STATE}
        WHERE
            PRD_MST_CD = #{PRD_MST_CD}
    </update>
</mapper>