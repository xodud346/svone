<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="StockNoHst">

    <select id="stockNoHstList" parameterType="HashMap" resultType="SspMap">
        /* stockNoHst 리스트 조회 */
        <include refid="stockNoHstQuery" />
--         OFFSET TO_NUMBER(#{startNum}) - 1 ROWS FETCH FIRST TO_NUMBER(#{pageSize}) ROWS ONLY
    </select>

    <select id="stockNoHstListCount" parameterType="HashMap" resultType="Integer">
        /* stockNoHst 리스트 수량 조회 */
        SELECT COUNT(*) AS TOTAL_COUNT
        FROM (<include refid="stockNoHstQuery" />) SC
    </select>

    <insert id="insertStockNoHst" parameterType="HashMap">
        INSERT INTO
            TB_SG_PRD_STOCK_HST TSPSH ( TSPSH.CO_CD
                                      , TSPSH.BZPLC_ID
                                      , TSPSH.PRD_ID
                                      , TSPSH.STK_NO
                                      , TSPSH.USE_YN
                                      , TSPSH.REG_DTM
                                      , TSPSH.REGPSN_ID)
        VALUES ( #{coCd}
               , #{bzplcId}
               , #{prdId}
               , #{stkNo}
               , UPPER(#{useYn})
               , SYSDATE
               , #{admMstId})
    </insert>

    <select id="getStockNoHst" parameterType="HashMap" resultType="SspMap">
        <include refid="stockNoHstQuery" />
    </select>

    <sql id="stockNoHstQuery">
        SELECT TSPSH.BZPLC_ID           AS BZPLC_ID /**/
             , TSPSH.PRD_ID             AS PRD_ID /**/
             , TSPSH.CHGF_STK_NO        AS CHGF_STK_NO /**/
             , TSPSH.CHGA_STK_NO        AS CHGA_STK_NO /**/
             , TSPSH.REPR_SPEC          AS REPR_SPEC /**/
             , TSPSH.CHG_RSN            AS CHG_RSN /**/
             , TSPSH.USE_YN             AS USE_YN /**/
             , TSPSH.REQR_ID            AS REQR_ID /**/
             , TSPSH.REQR_NM            AS REQR_NM /**/
             , TSPSH.UPD_DTM            AS UPD_DTM /**/
        FROM TB_SG_PRD_STOCK_HST TSPSH
        WHERE TSPSH.CO_CD = #{coCd}
          AND TSPSH.BZPLC_ID = #{bzplcId}
          AND TSPSH.PRD_ID = #{prdId}
    </sql>

</mapper>
