<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.ssp.bo.sa.pmtPopup">

<!--
	******************************************************************************
	* SELECT : 프로모션 팝업
	* 작성자 : 87minho
	* 작성 일자 : 2023-01-26
	******************************************************************************
	-->
	<select id="selectPmtPopupList" parameterType="HashMap" resultType="HashMap">
		/* 프로모션 팝업 목록 조회 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.selectPmtPopupList */
		
		SELECT S.CO_CD
				, S.PMT_POPUP_SEQ
				, S.PMT_POPUP_NM
				, S.EXPS_NOTIC_SPR_CD
				, FN_COM_DTL_CDNM_NVL('KO', 'EXPS_NOTIC_SPR_CD', S.EXPS_NOTIC_SPR_CD, '-') AS EXPS_NOTIC_SPR_CD_NM
				, S.DOC_REG_ID
				, S.URL_CNSOL_SPR_CD
				, S.URL_ADDR
				, S.CPN_EVT_NO
				, S.DISP_SO
				, S.DISP_STR_DTM
				, S.DISP_END_DTM
				, S.DISP_STR_DT
				, S.DISP_END_DT
				, S.TOP_PST
                , S.LEFT_PST
                , S.FLTG_YN
                , S.NLOOK_SET_YN
                , S.CLOSE_SET_YN
                , S.PMT_POPUP_DESC
                , S.EXPS_PAGE_SPR_CD
                , FN_COM_DTL_CDNM('KO', 'PMT_POPUP_EXPS_PAGE_SPR_CD', S.EXPS_PAGE_SPR_CD) AS EXPS_PAGE_SPR_CD_NM
                , S.EXCPT_PAGE_SET_YN
                , S.PRM_SET_YN
				, S.USE_YN
				, S.REGPSN_ID
				, FN_CC_GET_MBR_NM(S.CO_CD, S.REGPSN_ID) AS REGPSN_NM
				, S.REG_DTM
				, S.UPDPSN_ID
				, S.UPD_DTM
				, S.OPR_UNIT_NM
				, S.PMT_POPUP_STATS
        FROM (            
			SELECT A.CO_CD
					, A.PMT_POPUP_SEQ
					, MIN(A.PMT_POPUP_NM) AS PMT_POPUP_NM
					, MIN(A.EXPS_NOTIC_SPR_CD) AS EXPS_NOTIC_SPR_CD
                    , MIN(A.DOC_REG_ID) AS DOC_REG_ID
                    , MIN(A.URL_CNSOL_SPR_CD) AS URL_CNSOL_SPR_CD
                    , MIN(A.URL_ADDR) AS URL_ADDR
                    , MIN(A.CPN_EVT_NO) AS CPN_EVT_NO
                    , MIN(A.DISP_SO) AS DISP_SO
                    , TO_CHAR(MIN(A.DISP_STR_DTM), 'YYYYMMDDHH24MI') AS DISP_STR_DTM
                    , TO_CHAR(MIN(A.DISP_END_DTM), 'YYYYMMDDHH24MI') AS DISP_END_DTM
                    , TO_CHAR(MIN(A.DISP_STR_DTM), 'YYYY.MM.DD') AS DISP_STR_DT
                    , TO_CHAR(MIN(A.DISP_END_DTM), 'YYYY.MM.DD') AS DISP_END_DT
                    , MIN(A.TOP_PST) AS TOP_PST
                    , MIN(A.LEFT_PST) AS LEFT_PST
                    , MIN(A.FLTG_YN) AS FLTG_YN
                    , MIN(A.NLOOK_SET_YN) AS NLOOK_SET_YN
                    , MIN(A.CLOSE_SET_YN) AS CLOSE_SET_YN                    
                    , MIN(A.PMT_POPUP_DESC) AS PMT_POPUP_DESC
                    , MIN(A.EXPS_PAGE_SPR_CD) AS EXPS_PAGE_SPR_CD
                    , MIN(A.EXCPT_PAGE_SET_YN) AS EXCPT_PAGE_SET_YN
                    , MIN(A.PRM_SET_YN) AS PRM_SET_YN
                    , MIN(A.USE_YN) AS USE_YN
                    , MIN(A.REGPSN_ID) AS REGPSN_ID
                    , TO_CHAR(MIN(A.REG_DTM), 'YYYY.MM.DD') AS REG_DTM
                    , MIN(A.UPDPSN_ID) AS UPDPSN_ID
                    , TO_CHAR(MIN(A.UPD_DTM), 'YYYY.MM.DD') AS UPD_DTM
                    , CASE WHEN COUNT(C.OPR_UNIT_ID) > 0 THEN MIN(C.OPR_UNIT_NM) || '(' || COUNT(C.OPR_UNIT_ID) || ')'
                           ELSE MIN(C.OPR_UNIT_NM)
                      END OPR_UNIT_NM
					, CASE WHEN SYSDATE >= MIN(A.DISP_STR_DTM) AND SYSDATE <![CDATA[<=]]> MIN(A.DISP_END_DTM)
                                THEN 'ING'
                           WHEN MIN(A.DISP_STR_DTM) > SYSDATE
                                THEN 'READY'
                           ELSE 'END'
                      END PMT_POPUP_STATS
			FROM TB_SA_PMT_POPUP_INFO A
			       , TB_SA_PMT_POPUP_OPR_UNIT_DTL B
			       , TB_CC_OPR_UNIT_BASIS C
                   <if test="oprUnitId != null and oprUnitId > 0 ">
                   	   , TB_OD_ODR_INQ_TGT_DTLS   T1
                       , TB_OD_ODR_INQ_TGT_DTLS   T2
                   </if>
            WHERE A.CO_CD = B.CO_CD(+)
                AND A.PMT_POPUP_SEQ = B.PMT_POPUP_SEQ(+)
                AND B.CO_CD = C.CO_CD(+)
                AND B.BZPLC_ID = C.BZPLC_ID(+)
                AND B.OPR_UNIT_ID = C.OPR_UNIT_ID(+)
                AND A.CO_CD = #{coCd}
                <if test="useYn != null and !useYn.equals('') ">
                    AND A.USE_YN = #{useYn}
                </if>
                <if test="prmSetYn != null and !prmSetYn.equals('') ">
                    AND A.PRM_SET_YN = #{prmSetYn}
                </if>
                <if test="pmtPopupNm != null and !pmtPopupNm.equals('') ">
                    AND A.PMT_POPUP_NM LIKE '%' || #{pmtPopupNm} || '%'
                </if>
                <if test="fromDate != null and !fromDate.equals('') and toDate != null and !toDate.equals('') ">
                    AND A.REG_DTM >=  TO_DATE(#{fromDate}, 'YYYYMMDD')
                    AND A.REG_DTM - 1 <![CDATA[ < ]]> TO_DATE(#{toDate}, 'YYYYMMDD')
                </if>
                <if test="expsNoticSprCd != null and !expsNoticSprCd.equals('') ">
                    AND A.EXPS_NOTIC_SPR_CD = #{expsNoticSprCd}
                </if>
                <if test="oprUnitId != null and oprUnitId > 0 ">
                    AND T1.SES_ID = #{sesId}
                    AND T1.INQ_COND_DTLS = #{inqCondDtls}
                    AND T1.COL_ITM = 'OPR_UNIT_ID'
                    AND T1.COND_DATA_VAL = B.OPR_UNIT_ID
                    AND T2.SES_ID = #{sesId}
                    AND T2.INQ_COND_DTLS = #{inqCondDtls}
                    AND T2.COL_ITM = 'BZPLC_ID'
                    AND T2.COND_DATA_VAL = B.BZPLC_ID
                </if>
                GROUP BY A.CO_CD, A.PMT_POPUP_SEQ 
        ) S
        <if test="pmtPopupStats != null and pmtPopupStats != '' ">
            WHERE S.PMT_POPUP_STATS = #{pmtPopupStats}
        </if>
        <if test="sortColumn != null and sortColumn != ''">
            ORDER BY ${sortColumn} ${sortType}
        </if>
        <if test="sortColumn == null or sortColumn == ''">
            ORDER BY S.USE_YN DESC, S.PMT_POPUP_STATS DESC, S.EXPS_NOTIC_SPR_CD, NVL(S.DISP_SO, 0), S.REG_DTM DESC
        </if>
        OFFSET #{startNum} ROWS FETCH FIRST #{rowCount} ROWS ONLY
	</select>

	<select id="selectPmtPopupListCnt" parameterType="HashMap" resultType="Integer">
		/* 프로모션 팝업 목록 총 합계 조회 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.selectPmtPopupListCnt */
		
        SELECT COUNT(S.PMT_POPUP_SEQ)
        FROM (            
            SELECT A.CO_CD
                    , A.PMT_POPUP_SEQ
                    , CASE WHEN SYSDATE >= MIN(A.DISP_STR_DTM) AND SYSDATE <![CDATA[<=]]> MIN(A.DISP_END_DTM)
                                THEN 'ING'
                           WHEN MIN(A.DISP_STR_DTM) > SYSDATE
                                THEN 'READY'
                           ELSE 'END'
                      END PMT_POPUP_STATS
            FROM TB_SA_PMT_POPUP_INFO A
                   , TB_SA_PMT_POPUP_OPR_UNIT_DTL B
                   , TB_CC_OPR_UNIT_BASIS C
                <if test="oprUnitId != null and oprUnitId > 0 ">
                    , TB_OD_ODR_INQ_TGT_DTLS   T1
                    , TB_OD_ODR_INQ_TGT_DTLS   T2
                </if>
            WHERE A.CO_CD = B.CO_CD(+)
                AND A.PMT_POPUP_SEQ = B.PMT_POPUP_SEQ(+)
                AND B.CO_CD = C.CO_CD(+)
                AND B.BZPLC_ID = C.BZPLC_ID(+)
                AND B.OPR_UNIT_ID = C.OPR_UNIT_ID(+)
                AND A.CO_CD = #{coCd}
                <if test="useYn != null and !useYn.equals('') ">
                    AND A.USE_YN = #{useYn}
                </if>
                <if test="prmSetYn != null and !prmSetYn.equals('') ">
                    AND A.PRM_SET_YN = #{prmSetYn}
                </if>
                <if test="pmtPopupNm != null and !pmtPopupNm.equals('') ">
                    AND A.PMT_POPUP_NM LIKE '%' || #{pmtPopupNm} || '%'
                </if>
                <if test="fromDate != null and !fromDate.equals('') and toDate != null and !toDate.equals('') ">
                    AND A.REG_DTM >=  TO_DATE(#{fromDate}, 'YYYYMMDD')
                    AND A.REG_DTM - 1 <![CDATA[ < ]]> TO_DATE(#{toDate}, 'YYYYMMDD')
                </if>
                <if test="expsNoticSprCd != null and !expsNoticSprCd.equals('') ">
                    AND A.EXPS_NOTIC_SPR_CD = #{expsNoticSprCd}
                </if>
                <if test="oprUnitId != null and oprUnitId > 0 ">
                    AND T1.SES_ID = #{sesId}
                    AND T1.INQ_COND_DTLS = #{inqCondDtls}
                    AND T1.COL_ITM = 'OPR_UNIT_ID'
                    AND T1.COND_DATA_VAL = B.OPR_UNIT_ID
                    AND T2.SES_ID = #{sesId}
                    AND T2.INQ_COND_DTLS = #{inqCondDtls}
                    AND T2.COL_ITM = 'BZPLC_ID'
                    AND T2.COND_DATA_VAL = B.BZPLC_ID
                </if>
                GROUP BY A.CO_CD, A.PMT_POPUP_SEQ 
        ) S
        <if test="pmtPopupStats != null and pmtPopupStats != '' ">
            WHERE S.PMT_POPUP_STATS = #{pmtPopupStats}
        </if>
	</select>
	
	<update id="updatePmtPopupDispSo" parameterType="HashMap">
        /* 프로모션 팝업 순서 저장 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.updatePmtPopupDispSo */
        
        UPDATE TB_SA_PMT_POPUP_INFO
        SET DISP_SO = #{dispSo}
            , UPDPSN_ID = #{updpsnId}
            , UPD_DTM = SYSDATE
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
    </update>
    
	<select id="selectPmtPopupInfo" parameterType="HashMap" resultType="HashMap">
        /* 프로모션 팝업 상세 조회 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.selectPmtPopupInfo */
        
        SELECT A.CO_CD
				, A.PMT_POPUP_SEQ
				, A.PMT_POPUP_NM
				, A.EXPS_NOTIC_SPR_CD
				, A.DOC_REG_ID
				, A.URL_CNSOL_SPR_CD
				, A.URL_ADDR
				, A.CPN_EVT_NO
				, A.DISP_SO
				, TO_CHAR(A.DISP_STR_DTM, 'YYYYMMDDHH24MI') AS DISP_STR_DTM
				, TO_CHAR(A.DISP_END_DTM, 'YYYYMMDDHH24MI') AS DISP_END_DTM
				, TO_CHAR(A.DISP_STR_DTM, 'YYYYMMDD') AS DISP_STR_DT
				, TO_CHAR(A.DISP_END_DTM, 'YYYYMMDD') AS DISP_END_DT
				, TO_CHAR(A.DISP_STR_DTM, 'HH24') AS DISP_STR_HR
                , TO_CHAR(A.DISP_END_DTM, 'HH24') AS DISP_END_HR
                , TO_CHAR(A.DISP_STR_DTM, 'MI') AS DISP_STR_MN
                , TO_CHAR(A.DISP_END_DTM, 'MI') AS DISP_END_MN
				, A.TOP_PST
                , A.LEFT_PST
                , A.FLTG_YN
                , A.NLOOK_SET_YN
                , A.CLOSE_SET_YN
                , A.PMT_POPUP_DESC
                , A.EXPS_PAGE_SPR_CD
                , A.EXCPT_PAGE_SET_YN
                , A.PRM_SET_YN
				, A.USE_YN
				, A.NOTLOGN_INC_YN		
				, A.REGPSN_ID
				, A.REG_DTM
				, A.UPDPSN_ID
				, A.UPD_DTM
                , B.DOC_REG_SEQ
                , B.ATFL_NM
                , B.ATFL_STOR_PATH
                , B.ORI_ATFL_NM
                , C.CPN_NM AS CPN_EVT_NM
                , A.POPUP_SPR_CD				/* SSP-3399 */
                , A.YTUBE_URL_ADDR
                , A.WDT_LEN
        FROM TB_SA_PMT_POPUP_INFO A
            , TB_CO_ATFL_DTLS B
            , TB_SA_CPN_INFO C
        WHERE A.DOC_REG_ID = B.DOC_REG_ID(+)
        AND A.CO_CD = C.CO_CD(+)
        AND A.CPN_EVT_NO = C.CPN_EVT_NO(+)
        AND A.CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
    </select>

    <select id="selectPmtPopupOprUnitList" parameterType="HashMap" resultType="HashMap">
        /* 프로모션 팝업 운영단위 리스트 조회 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.selectPmtPopupOprUnitList */
        
        SELECT A.CO_CD
                , A.PMT_POPUP_SEQ
                , A.BZPLC_ID
                , A.OPR_UNIT_ID
                , B.OPR_UNIT_NM
        FROM TB_SA_PMT_POPUP_OPR_UNIT_DTL A
            , TB_CC_OPR_UNIT_BASIS B
        WHERE A.CO_CD = B.CO_CD
        AND A.BZPLC_ID = B.BZPLC_ID
        AND A.OPR_UNIT_ID = B.OPR_UNIT_ID
        AND A.CO_CD = #{coCd}
        AND A.PMT_POPUP_SEQ = #{pmtPopupSeq}
    </select>


    <select id="selectPmtPopupAplyDtlList" parameterType="HashMap" resultType="HashMap">
        /* 프로모션 팝업 적용 상세 리스트 조회 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.selectPmtPopupAplyDtlList */
        
        SELECT '0' AS COL_CHK
	            , CO_CD
				, PMT_POPUP_SEQ
				, PMT_POPUP_APLY_DTL_SEQ
				, PMT_POPUP_PROC_TYPE_CD
				, PMT_POPUP_PROC_TXT
        FROM TB_SA_PMT_POPUP_APLY_DTL
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
    </select>

    <select id="selectPmtPopupSeq" parameterType="HashMap" resultType="String">
        /* 프로모션 시퀀스 값 조회 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.selectPmtPopupSeq */
        
        SELECT SQ_SA_PMT_POPUP_INFO_01.NEXTVAL
        FROM DUAL
    </select>
    
    <insert id="insertPmtPopupDtl" parameterType="HashMap">
        /* 프로모션 팝업 등록 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.insertPmtPopupDtl */
        
        INSERT INTO TB_SA_PMT_POPUP_INFO
        	( CO_CD
			, PMT_POPUP_SEQ
			, PMT_POPUP_NM
			, EXPS_NOTIC_SPR_CD
			, DOC_REG_ID
			, URL_CNSOL_SPR_CD
			, URL_ADDR
			, CPN_EVT_NO
			, DISP_SO
			, DISP_STR_DTM
			, DISP_END_DTM
			, TOP_PST
            , LEFT_PST
            , FLTG_YN
            , NLOOK_SET_YN
            , CLOSE_SET_YN
            , PMT_POPUP_DESC
            , EXPS_PAGE_SPR_CD
            , EXCPT_PAGE_SET_YN
            , PRM_SET_YN
			, USE_YN
			, NOTLOGN_INC_YN		
			, REGPSN_ID
			, REG_DTM
			, UPDPSN_ID
			, UPD_DTM
			, POPUP_SPR_CD		/* SSP-3399 */	
			, YTUBE_URL_ADDR
			, WDT_LEN
        	) 
        VALUES 
        	( #{coCd}
            , #{pmtPopupSeq}
            , #{pmtPopupNm}
            , #{expsNoticSprCd}
            , #{docRegId}
            , #{urlCnsolSprCd}
            , #{urlAddr}
            , #{cpnEvtNo}
            , #{dispSo}
            , TO_DATE(#{dispStrDtm}, 'YYYYMMDDHH24MI')
            , TO_DATE(#{dispEndDtm}, 'YYYYMMDDHH24MI')
            , #{topPst}
            , #{leftPst} 
            , #{fltgYn}
            , #{nlookSetYn}
            , #{closeSetYn}
            , #{pmtPopupDesc}
            , #{expsPageSprCd}
            , #{excptPageSetYn}
            , #{prmSetYn}
            , #{useYn}
            , #{notlognIncYn}		
            , #{regpsnId}
            , SYSDATE
            , #{updpsnId}
            , SYSDATE
            , #{popupSprCd}			/* SSP-3399 */		
            , #{ytubeUrlAddr}
            , #{wdtLen}
            )
    </insert>

    <update id="updatePmtPopupDtl" parameterType="HashMap">
        /* 프로모션 팝업 수정 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.updatePmtPopupDtl */
        
        UPDATE TB_SA_PMT_POPUP_INFO
        SET PMT_POPUP_NM = #{pmtPopupNm}
            , EXPS_NOTIC_SPR_CD = #{expsNoticSprCd}
            , DOC_REG_ID = #{docRegId}
            , URL_CNSOL_SPR_CD = #{urlCnsolSprCd}
            , URL_ADDR = #{urlAddr}
            , CPN_EVT_NO = #{cpnEvtNo}
            , DISP_SO = #{dispSo}
            , DISP_STR_DTM = TO_DATE(#{dispStrDtm}, 'YYYYMMDDHH24MI')
            , DISP_END_DTM = TO_DATE(#{dispEndDtm}, 'YYYYMMDDHH24MI')
            , TOP_PST = #{topPst}
            , LEFT_PST = #{leftPst} 
            , FLTG_YN = #{fltgYn}
            , NLOOK_SET_YN = #{nlookSetYn}
            , CLOSE_SET_YN = #{closeSetYn}
            , PMT_POPUP_DESC = #{pmtPopupDesc}
            , EXPS_PAGE_SPR_CD = #{expsPageSprCd}
            , EXCPT_PAGE_SET_YN = #{excptPageSetYn}
            , PRM_SET_YN = #{prmSetYn}
            , USE_YN = #{useYn}
            , NOTLOGN_INC_YN = #{notlognIncYn}		
            , UPDPSN_ID = #{updpsnId}
            , UPD_DTM = SYSDATE
            , POPUP_SPR_CD = #{popupSprCd}   		/* SSP-3399 */
			, YTUBE_URL_ADDR = #{ytubeUrlAddr} 
			, WDT_LEN = #{wdtLen}       
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
    </update>

    <insert id="insertPmtPopupOprUnit" parameterType="HashMap">
        /* 프로모션 팝업 운영단위 등록 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.insertPmtPopupOprUnit */
        
        INSERT INTO TB_SA_PMT_POPUP_OPR_UNIT_DTL
        	( CO_CD
            , PMT_POPUP_SEQ
            , BZPLC_ID
            , OPR_UNIT_ID
            , REGPSN_ID
            , REG_DTM
            , UPDPSN_ID
            , UPD_DTM
        	) 
        VALUES
        	( #{coCd}
            , #{pmtPopupSeq}
            , #{bzplcId}
            , #{oprUnitId}
            , #{regpsnId}
            , SYSDATE
            , #{updpsnId}
            , SYSDATE
        	)
    </insert>

    <delete id="deletePmtPopupInfo" parameterType="HashMap">
        /* 프로모션 팝업 삭제 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.deletePmtPopupInfo */
        
        DELETE FROM TB_SA_PMT_POPUP_INFO
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
    </delete>
    
    <delete id="deletePmtPopupOprUnit" parameterType="HashMap">
        /* 프로모션 팝업 운영단위 삭제 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.deletePmtPopupOprUnit */
        
        DELETE FROM TB_SA_PMT_POPUP_OPR_UNIT_DTL
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
        <if test="bzplcId != null and !bzplcId.equals('') and oprUnitId != null and !oprUnitId.equals('') ">
            AND BZPLC_ID = #{bzplcId}
            AND OPR_UNIT_ID = #{oprUnitId}
        </if>
    </delete>
    
    <delete id="deletePmtPopupAplyDtl" parameterType="HashMap">
        /* 프로모션 팝업 적용 상세 삭제 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.deletePmtPopupAplyDtl */
        
        DELETE FROM TB_SA_PMT_POPUP_APLY_DTL
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
        <if test="pmtPopupAplyDtlSeq != null and pmtPopupAplyDtlSeq != '' ">
            AND PMT_POPUP_APLY_DTL_SEQ = #{pmtPopupAplyDtlSeq}
        </if>            
    </delete>
    
    <insert id="insertPmtPopupAplyDtl" parameterType="HashMap">
        /* 프로모션 팝업 적용 상세 등록 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup."insertPmtPopupAplyDtl" */
        
        <selectKey keyProperty="pmtPopupAplyDtlSeq" resultType="Integer" order="BEFORE">
            SELECT SQ_SA_PMT_POPUP_APLY_DTL_01.NEXTVAL
            FROM DUAL
        </selectKey>
        INSERT INTO TB_SA_PMT_POPUP_APLY_DTL
        	( CO_CD
            , PMT_POPUP_SEQ
            , PMT_POPUP_APLY_DTL_SEQ
			, PMT_POPUP_PROC_TYPE_CD
			, PMT_POPUP_PROC_TXT
			, REGPSN_ID
			, REG_DTM
			, UPDPSN_ID
			, UPD_DTM
        	) 
        VALUES
        	( #{coCd}
            , #{pmtPopupSeq}
            , #{pmtPopupAplyDtlSeq}
            , #{pmtPopupProcTypeCd}
            , #{pmtPopupProcTxt}
            , #{regpsnId}
            , SYSDATE
            , #{updpsnId}
            , SYSDATE
        	)
    </insert>
    
    <update id="updatePmtPopupAplyDtl" parameterType="HashMap">
        /* 프로모션 팝업 적용 상세 수정 - PmtPopup_SQL.com.ssp.bo.sa.pmtPopup.updatePmtPopupAplyDtl */
        
        UPDATE TB_SA_PMT_POPUP_APLY_DTL
        SET PMT_POPUP_PROC_TXT = #{pmtPopupProcTxt}
            , UPDPSN_ID = #{updpsnId}
            , UPD_DTM = SYSDATE
        WHERE CO_CD = #{coCd}
        AND PMT_POPUP_SEQ = #{pmtPopupSeq}
        AND PMT_POPUP_APLY_DTL_SEQ = #{pmtPopupAplyDtlSeq}
    </update>
    
</mapper>