<?xml version="1.0" encoding="utf-8"?>
<FDL version="2.1">
  <Form id="SSP_BO_NA_14" width="1336" height="846" titletext="PNB스토리 - 목록" onload="fn_onLoad" onkeyup="fn_onkeyup">
    <Layouts>
      <Layout height="846" mobileorientation="landscape" width="1336">
        <Div id="div_dtl1" taborder="3" left="600" top="0" right="0" text="" height="800">
          <Layouts>
            <Layout>
              <Static id="sta_thmItmBack" taborder="4" left="10" top="42" cssclass="sta_cm_box02L" right="10" text="" height="80" maxheight="443" minheight=""/>
              <Static id="Static00" taborder="0" text="테마 상세" left="10" top="10" height="20" cssclass="sta_WF_title01" onclick="Static00_onclick" width="130"/>
              <Static id="sta_thmItm" taborder="1" text="테마 아이템&#13;&#10;순서 정렬" left="10" top="42" width="130" height="80" textAlign="left" padding="0px 0px 0px 10px" cssclass="sta_cm_box01L" maxheight="443" minheight=""/>
              <Grid id="grd_pnbStoryList" taborder="2" left="141" top="77" autofittype="col" scrollbartype="none auto" binddataset="ds_grdPnbStoryList" right="10" autoenter="select" autosizingtype="none" extendsizetype="none" cssclass="grd_WF_list" height="33" nodatatext="조회된 결과가 없습니다." maxheight="395" minheight="" ondrop="grd_pnbStoryList_ondrop" ondragmove="grd_pnbStoryList_ondragmove" ondrag="grd_pnbStoryList_ondrag">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="182"/>
                      <Column size="30"/>
                    </Columns>
                    <Rows>
                      <Row size="31"/>
                    </Rows>
                    <Band id="body">
                      <Cell text="bind:TTL" textAlign="left"/>
                      <Cell col="1" displaytype="normal" edittype="none" text="☰"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static28" taborder="3" text="※ 테마 아이템의 순서를 변경할 수 있습니다." left="149" top="54" width="255" height="15"/>
              <Button id="btn_saveThmDispSo" taborder="5" text="순서저장" top="9" width="81" height="28" right="8" onclick="btn_saveThmDispSo_onclick"/>
            </Layout>
          </Layouts>
          <InitValue/>
        </Div>
        <Div id="div_mst" taborder="14" left="0" top="0" bottom="0" text="" width="560">
          <Layouts>
            <Layout>
              <Grid id="grd_pnbStoryThmList" taborder="0" left="20" top="69" binddataset="ds_grdPnbStoryThmList" scrollbartype="auto auto" treeusecheckbox="false" autofittype="col" treeinitstatus="collapse,all" cellmovingtype="none" scrolltype="both" right="9" bottom="40" oncellclick="grd_pnbStoryThmList_oncellclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="317"/>
                      <Column size="0"/>
                    </Columns>
                    <Rows>
                      <Row size="31"/>
                    </Rows>
                    <Band id="body">
                      <Cell text="bind:TTL" edittype="tree" displaytype="treeitemcontrol" treelevel="bind:PNB_LVL" tooltiptext="bind:TTL" cssclass="expr:PNB_LVL ==  '2' ? 'expsLeafColor' : ''"/>
                      <Cell col="1"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Edit id="edt_searchNm" taborder="1" left="20" top="40" height="24" onkeyup="edt_searchNm_onkeyup" right="40"/>
              <Static id="Static01" taborder="2" text="매거진 테마 목록" left="20" top="10" height="20" cssclass="sta_WF_title01" width="130"/>
              <Button id="btn_find" taborder="3" top="40" height="24" cssclass="btn_WF_search02" width="24" onclick="btn_find_onclick" right="10" text=""/>
              <Button id="btn_itmAdd" taborder="4" text="테마 아이템 추가" height="24" onclick="btn_itmAdd_onclick" width="129" left="20" bottom="10"/>
              <Button id="btn_largeExcel" taborder="5" text="대용량다운로드" top="9" height="26" right="12" width="118" onclick="btn_largeExcel_onclick" cssclass="btn_WF_excel"/>
              <Button id="btn_thmAdd" taborder="6" text="테마 추가" height="28" onclick="btn_thmAdd_onclick" width="81" left="340" top="7"/>
            </Layout>
          </Layouts>
        </Div>
        <Div id="div_dtl2" taborder="1" left="600" top="233" right="10" text="" height="800" visible="false">
          <Layouts>
            <Layout>
              <Static id="sta_thmItmBack" taborder="31" left="10" top="418" cssclass="sta_cm_box02L" right="10" text="" height="80" maxheight="363" minheight=""/>
              <Static id="Static03_00_01_00_01_00" taborder="27" left="10" top="262" height="32" cssclass="sta_cm_box02L" text="" right="10"/>
              <Static id="Static00" taborder="0" text="테마 상세" left="10" top="10" height="20" cssclass="sta_WF_title01" onclick="Static00_onclick" width="130"/>
              <Static id="Static12" taborder="1" left="10" top="387" height="32" cssclass="sta_cm_box02L" text="" right="10"/>
              <Static id="Static04" taborder="2" left="10" top="47" height="32" cssclass="sta_cm_box02L" text="" right="10"/>
              <Edit id="edt_ttl" taborder="3" left="150" top="51" height="24" right="126" onkeyup="edt_thmNm_onkeyup"/>
              <Static id="sta_useYn" taborder="4" text="사용여부" left="10" top="387" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Radio id="rdo_useYn" taborder="5" left="150" top="391" width="150" height="24" direction="vertical" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">Y</Col>
                      <Col id="datacolumn">사용</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">N</Col>
                      <Col id="datacolumn">미사용</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Static id="sta_ttl" taborder="6" text="테마 명" left="10" top="47" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_ttlSize" taborder="7" text="(0 / 300 Byte)" left="edt_ttl:4" top="51" height="24" textAlign="right" width="88" usedecorate="true"/>
              <Static id="Static05" taborder="8" top="201" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="Static10" taborder="9" top="109" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_regpsnId" taborder="10" left="156" top="109" width="300" height="32" text="등록자사번"/>
              <Static id="sta_regpsnIdSta" taborder="11" text="등록자 사번" left="10" top="109" width="130" height="32" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="sta_updpsnId" taborder="12" text="수정자사번" left="156" top="200" width="300" height="32"/>
              <Static id="sta_updpsnIdSta" taborder="13" text="수정자 사번" left="10" top="201" width="130" height="32" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="Static08" taborder="14" top="170" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="Static09" taborder="15" top="78" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_regDtmSta" taborder="16" text="등록일" left="10" top="78" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_regDtm" taborder="17" text="등록일시" left="156" top="78" height="32" right="226"/>
              <Static id="sta_updDtmSta" taborder="18" text="수정일" left="10" top="170" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_updDtm" taborder="19" text="수정일시" left="156" top="169" height="32" right="226"/>
              <Static id="Static07" taborder="20" top="140" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_regpsnNm" taborder="21" text="등록자" left="156" top="140" width="300" height="32"/>
              <Static id="sta_regpsnNmSta" taborder="22" text="등록자" left="10" top="140" width="130" height="32" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="Static06" taborder="23" top="231" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_updpsnNm" taborder="24" text="수정자" left="156" top="230" width="300" height="32"/>
              <Static id="sta_updpsnNmSta" taborder="25" text="수정자" left="10" top="231" width="130" height="32" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="sta_expsCnt" taborder="26" text="노출개수설정" left="10" top="262" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_thmItm" taborder="28" text="테마 아이템&#13;&#10;순서 정렬" left="10" top="418" width="130" height="80" textAlign="left" padding="0px 0px 0px 10px" cssclass="sta_cm_box01L" maxheight="363" minheight=""/>
              <Grid id="grd_pnbStoryList" taborder="29" left="141" top="453" autofittype="col" scrollbartype="none auto" binddataset="ds_grdPnbStoryList" right="10" autoenter="select" autosizingtype="none" extendsizetype="none" cssclass="grd_WF_list" height="33" nodatatext="조회된 결과가 없습니다." maxheight="315" minheight="" ondrag="grd_pnbStoryList_ondrag" ondragmove="grd_pnbStoryList_ondragmove" ondrop="grd_pnbStoryList_ondrop">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="182"/>
                      <Column size="30"/>
                    </Columns>
                    <Rows>
                      <Row size="31"/>
                    </Rows>
                    <Band id="body">
                      <Cell text="bind:TTL" textAlign="left"/>
                      <Cell col="1" displaytype="normal" edittype="none" text="☰"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static28" taborder="30" text="※ 테마 아이템의 순서를 변경할 수 있습니다." left="149" top="430" width="255" height="15"/>
              <Button id="btn_saveThm" taborder="32" text="저장" top="9" width="81" height="28" right="8" onclick="btn_saveThm_onclick"/>
              <Button id="btn_deleteThm" taborder="33" text="삭제" top="9" width="81" height="28" right="94" onclick="btn_deleteThm_onclick"/>
              <Static id="Static15" taborder="34" left="10" top="293" height="48" cssclass="sta_cm_box02L" text="" right="10"/>
              <Static id="sta_pcImg" taborder="35" text="PC 공통&#13;&#10;표지 이미지" left="10" top="293" width="130" height="48" cssclass="sta_cm_box01L"/>
              <Edit id="edt_pcAtflNm" taborder="36" left="sta_pcImg:10" top="297" height="24" readonly="true" oneditclick="edt_atflNm_onclick" onmouseenter="edt_atflNm_onmouseenter" onmouseleave="edt_atflNm_onmouseleave" width="440"/>
              <Button id="btn_pcImgAdd" taborder="37" text="파일찾기" top="297" width="60" height="24" left="602" onclick="btn_imgAdd_onclick"/>
              <Button id="btn_pcImgDelete" taborder="38" left="666" top="297" height="24" text="X" visible="true" width="24" onclick="btn_imgDelete_onclick"/>
              <Static id="Static16" taborder="39" left="10" top="340" height="48" cssclass="sta_cm_box02L" text="" right="10"/>
              <Static id="sta_mblImg" taborder="40" text="모바일 공통&#13;&#10;표지 이미지" left="10" top="340" width="130" height="48" cssclass="sta_cm_box01L"/>
              <Edit id="edt_mblAtflNm" taborder="41" left="sta_mblImg:10" top="344" height="24" readonly="true" oneditclick="edt_atflNm_onclick" onmouseenter="edt_atflNm_onmouseenter" onmouseleave="edt_atflNm_onmouseleave" width="440"/>
              <Button id="btn_mblImgAdd" taborder="42" text="파일찾기" top="344" width="60" height="24" left="602" onclick="btn_imgAdd_onclick"/>
              <Button id="btn_mblImgDelete" taborder="43" left="666" top="344" height="24" text="X" visible="true" width="24" onclick="btn_imgDelete_onclick"/>
              <Static id="sta_pcImgSizeRef" taborder="44" text="용량 : 10M 미만 / 형식 : PNG, JPG(최적 사이즈 : 60*420)" left="150" top="318" height="24" textAlign="left" width="334"/>
              <Static id="sta_mblImgSizeRef" taborder="45" text="용량 : 10M 미만 / 형식 : PNG, JPG(최적 사이즈 : 25*175)" left="150" top="365" height="24" textAlign="left" width="334"/>
              <Static id="sta_pcExpsCnt" taborder="46" text="PC" left="154" top="265" height="24" textAlign="left" width="33"/>
              <Combo id="cbo_pcExpsCnt" taborder="47" text="1주일" left="180" top="266" height="24" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn" index="0" value="2" width="120">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">0</Col>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">3</Col>
                      <Col id="datacolumn">3</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">6</Col>
                      <Col id="datacolumn">6</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">9</Col>
                      <Col id="datacolumn">9</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">12</Col>
                      <Col id="datacolumn">12</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">24</Col>
                      <Col id="datacolumn">24</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
              <Static id="sta_mblExpsCnt" taborder="48" text="Mobile" left="316" top="265" height="24" textAlign="left" width="49"/>
              <Combo id="cbo_mblExpsCnt" taborder="49" text="1주일" left="360" top="266" height="24" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn" index="0" value="2" width="120">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">0</Col>
                      <Col id="datacolumn">전체</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">2</Col>
                      <Col id="datacolumn">2</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">4</Col>
                      <Col id="datacolumn">4</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">6</Col>
                      <Col id="datacolumn">6</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">12</Col>
                      <Col id="datacolumn">12</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">24</Col>
                      <Col id="datacolumn">24</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Combo>
            </Layout>
          </Layouts>
          <InitValue>
            <Radio id="rdo_useYn" innerdataset="ds_useYn" datacolumn="USE_YN_NM" codecolumn="USE_YN"/>
          </InitValue>
        </Div>
        <Div id="div_dtl3" taborder="4" left="1400" top="10" right="-790" text="" height="800" visible="false">
          <Layouts>
            <Layout>
              <Button id="btn_cancelThmItm" taborder="56" text="취소" top="9" width="81" height="28" right="94" onclick="btn_cancelThmItm_onclick"/>
              <Static id="sta_itmInfo" taborder="0" text="아이템 상세" left="10" top="10" height="20" cssclass="sta_WF_title01" onclick="Static00_onclick" width="130"/>
              <Static id="Static12" taborder="1" left="10" top="326" height="32" cssclass="sta_cm_box02L" text="" right="10"/>
              <Static id="Static04" taborder="2" left="10" top="47" height="32" cssclass="sta_cm_box02L" text="" right="10"/>
              <Edit id="edt_ttl" taborder="3" left="150" top="51" height="24" right="126" onkeyup="edt_ttl_onkeyup"/>
              <Static id="sta_useYn" taborder="4" text="사용여부" left="10" top="326" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Radio id="rdo_useYn" taborder="5" left="150" top="330" width="150" height="24" direction="vertical" innerdataset="innerdataset" codecolumn="codecolumn" datacolumn="datacolumn">
                <Dataset id="innerdataset">
                  <ColumnInfo>
                    <Column id="codecolumn" size="256"/>
                    <Column id="datacolumn" size="256"/>
                  </ColumnInfo>
                  <Rows>
                    <Row>
                      <Col id="codecolumn">Y</Col>
                      <Col id="datacolumn">사용</Col>
                    </Row>
                    <Row>
                      <Col id="codecolumn">N</Col>
                      <Col id="datacolumn">미사용</Col>
                    </Row>
                  </Rows>
                </Dataset>
              </Radio>
              <Static id="sta_ttl" taborder="6" text="제목" left="10" top="47" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_ttlSize" taborder="7" text="(0 / 300 Byte)" left="edt_ttl:4" top="51" height="24" textAlign="right" width="88" usedecorate="true"/>
              <Static id="Static05" taborder="8" top="249" height="48" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="Static10" taborder="9" top="109" height="48" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_pcLstImg" taborder="10" text="[PC] 표지 이미지" left="10" top="109" width="130" height="48" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="sta_mblDtlImg" taborder="11" text="[Mobile] 상세이미지" left="10" top="249" width="130" height="48" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="Static08" taborder="12" top="202" height="48" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="Static09" taborder="13" top="78" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_subTtl" taborder="14" text="서브 타이틀" left="10" top="78" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_mblLstImg" taborder="15" text="[Mobile] 표지 이미지" left="10" top="202" width="130" height="48" cssclass="sta_cm_box01L"/>
              <Static id="Static07" taborder="16" top="156" height="48" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_pcDtlImg" taborder="17" text="[PC] 상세이미지" left="10" top="156" width="130" height="48" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Static id="Static06" taborder="18" top="295" height="32" cssclass="sta_cm_box02L" left="10" right="10" text=""/>
              <Static id="sta_cnsolSrwr" taborder="19" text="연결 검색어" left="10" top="295" width="130" height="32" cssclass="sta_cm_box01L" onclick="Div02_Static02_onclick"/>
              <Edit id="edt_subTtl" taborder="20" left="150" top="81" height="24" right="126" onkeyup="edt_subTtl_onkeyup"/>
              <Static id="sta_subTtlSize" taborder="21" text="(0 / 300 Byte)" left="edt_subTtl:4" top="81" height="24" textAlign="right" width="88" usedecorate="true"/>
              <Edit id="edt_pcLstAtflNm" taborder="22" left="150" top="113" height="24" width="230" readonly="true" onmouseenter="edt_atflNm_onmouseenter" onmouseleave="edt_atflNm_onmouseleave"/>
              <Button id="btn_pcLstImgAdd" taborder="23" text="파일첨부" top="113" width="80" height="24" left="384" onclick="btn_imgAdd_onclick"/>
              <Button id="btn_pcLstImgDelete" taborder="24" left="468" top="113" height="24" text="X" visible="true" width="24" onclick="btn_imgDelete_onclick"/>
              <Edit id="edt_pcDtlAtflNm" taborder="25" left="150" top="160" height="24" width="230" readonly="true" onmouseenter="edt_atflNm_onmouseenter" onmouseleave="edt_atflNm_onmouseleave"/>
              <Button id="btn_pcDtlImgAdd" taborder="26" text="파일첨부" top="160" width="80" height="24" left="384" onclick="btn_imgAdd_onclick"/>
              <Button id="btn_pcDtlImgDelete" taborder="27" left="468" top="160" height="24" text="X" visible="true" width="24" onclick="btn_imgDelete_onclick"/>
              <Edit id="edt_mblLstAtflNm" taborder="28" left="150" top="206" height="24" width="230" readonly="true" onmouseenter="edt_atflNm_onmouseenter" onmouseleave="edt_atflNm_onmouseleave"/>
              <Button id="btn_mblLstImgAdd" taborder="29" text="파일첨부" top="206" width="80" height="24" left="384" onclick="btn_imgAdd_onclick"/>
              <Button id="btn_mblLstImgDelete" taborder="30" left="468" top="206" height="24" text="X" visible="true" width="24" onclick="btn_imgDelete_onclick"/>
              <Edit id="edt_mblDtlAtflNm" taborder="31" left="150" top="253" height="24" width="230" readonly="true" onmouseenter="edt_atflNm_onmouseenter" onmouseleave="edt_atflNm_onmouseleave"/>
              <Button id="btn_mblDtlImgAdd" taborder="32" text="파일첨부" top="253" width="80" height="24" left="384" onclick="btn_imgAdd_onclick"/>
              <Button id="btn_mblDtlImgDelete" taborder="33" left="468" top="253" height="24" text="X" visible="true" width="24" onclick="btn_imgDelete_onclick"/>
              <Edit id="edt_cnsolSrwr" taborder="34" left="150" top="299" height="24" right="20" onkeyup="edt_ttl_onkeyup"/>
              <Grid id="grd_pnbStoryCatgDtl" taborder="35" left="10" top="396" height="286" autofittype="col" cssclass="grd_WF_list" binddataset="ds_grdPnbStoryCatgDtl" autosizingtype="none" cellsizingtype="col" width="130" oncellclick="grd_pnbStoryCatgDtl_oncellclick">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="70"/>
                      <Column size="40"/>
                    </Columns>
                    <Rows>
                      <Row size="31" band="head"/>
                      <Row size="31"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="카테고리 명"/>
                      <Cell col="1" text="순서"/>
                    </Band>
                    <Band id="body">
                      <Cell text="bind:CATG_NM" textAlign="left" displaytype="normal" edittype="none"/>
                      <Cell col="1" text="bind:CATG_DISP_SO"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Static id="Static11" taborder="36" left="150" top="396" height="32" cssclass="sta_cm_box02L" right="10"/>
              <Static id="sta_catgNm" taborder="37" text="카테고리 명" left="150" top="396" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Static id="sta_catgDispSo" taborder="38" text="카테고리 순서" left="540" top="396" width="130" height="32" cssclass="sta_cm_box01L"/>
              <Edit id="edt_catgNm" taborder="39" left="290" top="400" width="240" height="24"/>
              <Edit id="edt_catgDispSo" taborder="40" left="680" top="400" width="30" height="24" maxlength="5" inputtype="number"/>
              <Static id="Static13" taborder="41" top="427" height="255" cssclass="sta_cm_box02L" right="10" left="150"/>
              <Static id="sta_pnbStoryCatgPrdDtl" taborder="42" text="등록 상품" left="150" top="427" width="130" height="255" cssclass="sta_cm_box01L"/>
              <Grid id="grd_pnbStoryCatgPrdDtl" taborder="43" left="290" top="465" height="206" autofittype="none" cssclass="grd_WF_list" binddataset="ds_grdPnbStoryCatgPrdDtl" autosizingtype="none" cellsizingtype="col" oncellclick="grd_pnbStoryCatgPrdDtl_oncellclick" right="10">
                <Formats>
                  <Format id="default">
                    <Columns>
                      <Column size="55"/>
                      <Column size="140"/>
                      <Column size="240"/>
                      <Column size="260"/>
                      <Column size="260"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                      <Column size="80"/>
                    </Columns>
                    <Rows>
                      <Row size="31" band="head"/>
                      <Row size="31"/>
                    </Rows>
                    <Band id="head">
                      <Cell text="삭제"/>
                      <Cell col="1" text="상품ID"/>
                      <Cell col="2" text="상품명"/>
                      <Cell col="3" text="대표규격"/>
                      <Cell col="4" text="제조원"/>
                      <Cell col="5" text="공용전용구분"/>
                      <Cell col="6" text="대표상품구분"/>
                      <Cell col="7" text="SSP상품상태"/>
                      <Cell col="8" text="SSP진열상태"/>
                    </Band>
                    <Band id="body">
                      <Cell displaytype="decoratetext" expr="&quot;&lt;u v='true'&gt;삭제&lt;/u&gt;&quot;" text="bind:DELETE_ROW"/>
                      <Cell col="1" text="bind:PRD_ID_VIEW" textAlign="center"/>
                      <Cell col="2" text="bind:PRD_NM" textAlign="left"/>
                      <Cell col="3" textAlign="left" displaytype="normal" text="bind:ATTR_VAL"/>
                      <Cell col="4" textAlign="left" text="bind:MNFR"/>
                      <Cell col="5" text="bind:PUB_ONLY_SPR_NM"/>
                      <Cell col="6" text="bind:REPR_PRD_SPR_NM"/>
                      <Cell col="7" text="bind:PRD_USE_YN_NM"/>
                      <Cell col="8" text="bind:DISP_STATS_NM"/>
                    </Band>
                  </Format>
                </Formats>
              </Grid>
              <Button id="btn_searchPrdId" taborder="44" top="438" width="79" height="24" text="상품검색" left="549" onclick="btn_searchPrdId_onclick"/>
              <Button id="btn_catgDelete" taborder="45" top="438" width="79" height="24" text="카테고리 삭제" left="383" onclick="btn_catgDelete_onclick"/>
              <Button id="btn_catgAdd" taborder="46" top="438" width="79" height="24" text="카테고리 추가" left="466" onclick="btn_catgAdd_onclick"/>
              <Button id="btn_searchPrdIdMulText" taborder="47" top="438" width="79" height="24" text="멀티텍스트" left="632" onclick="btn_searchPrdIdMulText_onclick"/>
              <Static id="sta_totalCountPrdDtl" taborder="48" text="(총 0건)" left="290" top="444" width="80" height="25" usedecorate="true"/>
              <Static id="Static01" taborder="49" text=" 상품 목록" left="9" top="365" height="30" cssclass="sta_WF_title02" width="300"/>
              <Button id="btn_saveThmItm" taborder="50" text="저장" top="9" width="81" height="28" right="8" onclick="btn_saveThmItm_onclick"/>
              <Button id="btn_deleteThmItm" taborder="51" text="삭제" top="9" width="81" height="28" right="94" onclick="btn_deleteThmItm_onclick"/>
              <Static id="sta_pcLstImgSizeRef" taborder="52" text="용량 : 10M 미만 / 형식 : PNG, JPG(최적 사이즈 : 324*420)" left="150" top="135" height="24" textAlign="left" width="334"/>
              <Static id="sta_pcDtlImgSizeRef" taborder="53" text="용량 : 10M 미만 / 형식 : PNG, JPG(최적 사이즈 : 1,216*250)" left="150" top="181" height="24" textAlign="left" width="334"/>
              <Static id="sta_mblLstImgSizeRef" taborder="54" text="용량 : 10M 미만 / 형식 : PNG, JPG(최적 사이즈 : 135*175)" left="150" top="226" height="24" textAlign="left" width="334"/>
              <Static id="sta_mblDtlImgSizeRef" taborder="55" text="용량 : 10M 미만 / 형식 : PNG, JPG(최적 사이즈 : 370*240)" left="150" top="274" height="24" textAlign="left" width="334"/>
            </Layout>
          </Layouts>
          <InitValue>
            <Radio id="rdo_useYn" innerdataset="ds_useYn" datacolumn="USE_YN_NM" codecolumn="USE_YN"/>
          </InitValue>
        </Div>
        <ImageViewer id="img_view" taborder="2" left="2240" top="0" width="100" imagealign="center middle" padding="0px" stretch="fixaspectratio" text="" height="100" visible="false"/>
        <Grid id="grd_excelPnbStoryList" taborder="5" left="20" binddataset="ds_excelPnbStoryList" autofittype="none" autoenter="select" autosizingtype="none" right="20" nodatatext="조회된 데이터가 없습니다." top="930" bottom="-214" cellmovingtype="col" visible="false">
          <Formats>
            <Format id="default">
              <Columns>
                <Column size="106"/>
                <Column size="56"/>
                <Column size="55"/>
                <Column size="59"/>
                <Column size="58"/>
                <Column size="115"/>
                <Column size="131"/>
                <Column size="89"/>
                <Column size="65"/>
                <Column size="58"/>
                <Column size="85"/>
                <Column size="57"/>
                <Column size="129"/>
                <Column size="159"/>
                <Column size="171"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
                <Column size="80"/>
              </Columns>
              <Rows>
                <Row size="31" band="head"/>
                <Row size="30"/>
              </Rows>
              <Band id="head">
                <Cell text="테마제목"/>
                <Cell col="1" text="PC&#13;&#10;노출개수"/>
                <Cell col="2" text="모바일&#13;&#10;노출개수"/>
                <Cell col="3" text="테마&#13;&#10;전시순서"/>
                <Cell col="4" text="테마&#13;&#10;사용여부"/>
                <Cell col="5" text="아이템제목"/>
                <Cell col="6" text="아이템서브타이틀"/>
                <Cell col="7" text="연결검색어"/>
                <Cell col="8" text="아이템&#13;&#10;전시순서"/>
                <Cell col="9" text="아이템&#13;&#10;사용여부"/>
                <Cell col="10" text="카테고리명"/>
                <Cell col="11" text="카테고리&#13;&#10;전시순서"/>
                <Cell col="12" text="상품ID"/>
                <Cell col="13" text="상품명"/>
                <Cell col="14" text="규격"/>
                <Cell col="15" text="공용전용구분"/>
                <Cell col="16" text="대표상품구분"/>
                <Cell col="17" text="SSP상품상태"/>
                <Cell col="18" text="SSP진열상태"/>
              </Band>
              <Band id="body">
                <Cell text="bind:THM_TTL"/>
                <Cell col="1" text="bind:PC_EXPS_CNT"/>
                <Cell col="2" text="bind:MBL_EXPS_CNT"/>
                <Cell col="3" text="bind:DISP_SO"/>
                <Cell col="4" text="bind:USE_YN_NM"/>
                <Cell col="5" text="bind:TTL"/>
                <Cell col="6" text="bind:SUB_TTL"/>
                <Cell col="7" text="bind:CNSOL_SRWR"/>
                <Cell col="8" text="bind:UI_DISP_SEQ"/>
                <Cell col="9" text="bind:ITM_USE_YN_NM"/>
                <Cell col="10" text="bind:CATG_NM"/>
                <Cell col="11" text="bind:CATG_DISP_SO"/>
                <Cell col="12" text="bind:PRD_ID_VIEW"/>
                <Cell col="13" text="bind:PRD_NM"/>
                <Cell col="14" text="bind:ATTR_VAL"/>
                <Cell col="15" text="bind:PUB_ONLY_SPR_NM"/>
                <Cell col="16" text="bind:REPR_PRD_SPR_NM"/>
                <Cell col="17" text="bind:PRD_USE_YN_NM"/>
                <Cell col="18" text="bind:DISP_STATS_NM"/>
              </Band>
            </Format>
          </Formats>
        </Grid>
      </Layout>
    </Layouts>
    <Objects>
      <Dataset id="ds_search">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_searchComCd">
        <ColumnInfo>
          <Column id="CODE_LIST" type="STRING" size="256"/>
          <Column id="LANG_CD" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdPnbStoryThmList">
        <ColumnInfo>
          <Column id="PNB_LVL" type="STRING" size="256"/>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="TTL" type="STRING" size="256"/>
          <Column id="SUB_TTL" type="STRING" size="256"/>
          <Column id="CNSOL_SRWR" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_EXPS_CNT" type="STRING" size="256"/>
          <Column id="MBL_EXPS_CNT" type="STRING" size="256"/>
          <Column id="DISP_SO" type="STRING" size="256"/>
          <Column id="UI_DISP_SEQ" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="REG_DTM" type="STRING" size="256"/>
          <Column id="REGPSN_ID" type="STRING" size="256"/>
          <Column id="REGPSN_NM" type="STRING" size="256"/>
          <Column id="UPD_DTM" type="STRING" size="256"/>
          <Column id="UPDPSN_ID" type="STRING" size="256"/>
          <Column id="UPDPSN_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_pnbStoryInfo">
        <ColumnInfo>
          <Column id="PNB_LVL" type="STRING" size="256"/>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="TTL" type="STRING" size="256"/>
          <Column id="SUB_TTL" type="STRING" size="256"/>
          <Column id="CNSOL_SRWR" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_EXPS_CNT" type="STRING" size="256"/>
          <Column id="MBL_EXPS_CNT" type="STRING" size="256"/>
          <Column id="DISP_SO" type="STRING" size="256"/>
          <Column id="UI_DISP_SEQ" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="REG_DTM" type="STRING" size="256"/>
          <Column id="REGPSN_ID" type="STRING" size="256"/>
          <Column id="REGPSN_NM" type="STRING" size="256"/>
          <Column id="UPD_DTM" type="STRING" size="256"/>
          <Column id="UPDPSN_ID" type="STRING" size="256"/>
          <Column id="UPDPSN_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
        </ColumnInfo>
        <Rows>
          <Row/>
        </Rows>
      </Dataset>
      <Dataset id="ds_grdPnbStoryList">
        <ColumnInfo>
          <Column id="PNB_LVL" type="STRING" size="256"/>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="TTL" type="STRING" size="256"/>
          <Column id="SUB_TTL" type="STRING" size="256"/>
          <Column id="CNSOL_SRWR" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_EXPS_CNT" type="STRING" size="256"/>
          <Column id="MBL_EXPS_CNT" type="STRING" size="256"/>
          <Column id="DISP_SO" type="STRING" size="256"/>
          <Column id="UI_DISP_SEQ" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="REG_DTM" type="STRING" size="256"/>
          <Column id="REGPSN_ID" type="STRING" size="256"/>
          <Column id="REGPSN_NM" type="STRING" size="256"/>
          <Column id="UPD_DTM" type="STRING" size="256"/>
          <Column id="UPDPSN_ID" type="STRING" size="256"/>
          <Column id="UPDPSN_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdPnbStoryListTemp">
        <ColumnInfo>
          <Column id="PNB_LVL" type="STRING" size="256"/>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="TTL" type="STRING" size="256"/>
          <Column id="SUB_TTL" type="STRING" size="256"/>
          <Column id="CNSOL_SRWR" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_ID" type="STRING" size="256"/>
          <Column id="PC_EXPS_CNT" type="STRING" size="256"/>
          <Column id="MBL_EXPS_CNT" type="STRING" size="256"/>
          <Column id="DISP_SO" type="STRING" size="256"/>
          <Column id="UI_DISP_SEQ" type="STRING" size="256"/>
          <Column id="USE_YN" type="STRING" size="256"/>
          <Column id="REG_DTM" type="STRING" size="256"/>
          <Column id="REGPSN_ID" type="STRING" size="256"/>
          <Column id="REGPSN_NM" type="STRING" size="256"/>
          <Column id="UPD_DTM" type="STRING" size="256"/>
          <Column id="UPDPSN_ID" type="STRING" size="256"/>
          <Column id="UPDPSN_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_LST_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_LST_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="PC_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="PC_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="MBL_DTL_ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="MBL_DTL_ATFL_STOR_PATH" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_searchPrdIdCheckList">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PRD_ID" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_prdInfoList" useclientlayout="true">
        <ColumnInfo>
          <Column id="PRD_ID" type="STRING" size="256"/>
          <Column id="PRD_ID_VIEW" type="STRING" size="256"/>
          <Column id="PRD_NM" type="STRING" size="256"/>
          <Column id="ATTR_VAL" type="STRING" size="256"/>
          <Column id="MNFR" type="STRING" size="256"/>
          <Column id="PUB_ONLY_SPR_NM" type="STRING" size="256"/>
          <Column id="REPR_PRD_SPR_NM" type="STRING" size="256"/>
          <Column id="PRD_USE_YN" type="STRING" size="256"/>
          <Column id="PRD_USE_YN_NM" type="STRING" size="256"/>
          <Column id="DISP_STATS_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdPnbStoryCatgDtl" useclientlayout="true">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="PNB_CATG_SEQ" type="STRING" size="256"/>
          <Column id="CATG_NM" type="STRING" size="256"/>
          <Column id="CATG_DISP_SO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdPnbStoryCatgPrdDtl" useclientlayout="true">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="PNB_CATG_SEQ" type="STRING" size="256"/>
          <Column id="PRD_ID" type="STRING" size="256"/>
          <Column id="PRD_ID_VIEW" type="STRING" size="256"/>
          <Column id="PRD_NM" type="STRING" size="256"/>
          <Column id="ATTR_VAL" type="STRING" size="256"/>
          <Column id="MNFR" type="STRING" size="256"/>
          <Column id="PUB_ONLY_SPR_NM" type="STRING" size="256"/>
          <Column id="REPR_PRD_SPR_NM" type="STRING" size="256"/>
          <Column id="PRD_USE_YN" type="STRING" size="256"/>
          <Column id="PRD_USE_YN_NM" type="STRING" size="256"/>
          <Column id="DISP_STATS_NM" type="STRING" size="256"/>
          <Column id="DELETE_ROW" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdPnbStoryCatgDtlTemp" useclientlayout="true">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="PNB_CATG_SEQ" type="STRING" size="256"/>
          <Column id="CATG_NM" type="STRING" size="256"/>
          <Column id="CATG_DISP_SO" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_grdPnbStoryCatgPrdDtlTemp" useclientlayout="true">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="PNB_CATG_SEQ" type="STRING" size="256"/>
          <Column id="PRD_ID" type="STRING" size="256"/>
          <Column id="PRD_ID_VIEW" type="STRING" size="256"/>
          <Column id="PRD_NM" type="STRING" size="256"/>
          <Column id="ATTR_VAL" type="STRING" size="256"/>
          <Column id="MNFR" type="STRING" size="256"/>
          <Column id="PUB_ONLY_SPR_NM" type="STRING" size="256"/>
          <Column id="REPR_PRD_SPR_NM" type="STRING" size="256"/>
          <Column id="PRD_USE_YN" type="STRING" size="256"/>
          <Column id="PRD_USE_YN_NM" type="STRING" size="256"/>
          <Column id="DISP_STATS_NM" type="STRING" size="256"/>
          <Column id="DELETE_ROW" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <FileDialog id="fileDialog" onclose="fileDialog_onclose"/>
      <FileUpTransfer id="fileUpTrans" onerror="fileUpTrans_onerror" onprogress="fileUpTrans_onprogress" onsuccess="fileUpTrans_onsuccess"/>
      <FileDownTransfer id="FileDownTransfer" onsuccess="FileDownTransfer_onsuccess" onerror="FileDownTransfer_onerror"/>
      <Dataset id="ds_file">
        <ColumnInfo>
          <Column id="DOC_REG_ID" type="STRING" size="256"/>
          <Column id="DOC_REG_SEQ" type="STRING" size="256"/>
          <Column id="ATFL_NM" type="STRING" size="256"/>
          <Column id="ATFL_STOR_PATH" type="STRING" size="256"/>
          <Column id="ORI_ATFL_NM" type="STRING" size="256"/>
          <Column id="IMG_TYPE" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
      <Dataset id="ds_excelPnbStoryList">
        <ColumnInfo>
          <Column id="CO_CD" type="STRING" size="256"/>
          <Column id="PNB_THM_SEQ" type="STRING" size="256"/>
          <Column id="PC_EXPS_CNT" type="STRING" size="256"/>
          <Column id="MBL_EXPS_CNT" type="STRING" size="256"/>
          <Column id="DISP_SO" type="STRING" size="256"/>
          <Column id="USE_YN_NM" type="STRING" size="256"/>
          <Column id="PNB_SEQ" type="STRING" size="256"/>
          <Column id="TTL" type="STRING" size="256"/>
          <Column id="SUB_TTL" type="STRING" size="256"/>
          <Column id="CNSOL_SRWR" type="STRING" size="256"/>
          <Column id="UI_DISP_SEQ" type="STRING" size="256"/>
          <Column id="ITM_USE_YN_NM" type="STRING" size="256"/>
          <Column id="PNB_CATG_SEQ" type="STRING" size="256"/>
          <Column id="CATG_NM" type="STRING" size="256"/>
          <Column id="CATG_DISP_SO" type="STRING" size="256"/>
          <Column id="PRD_ID" type="STRING" size="256"/>
          <Column id="PRD_ID_VIEW" type="STRING" size="256"/>
          <Column id="PRD_NM" type="STRING" size="256"/>
          <Column id="ATTR_VAL" type="STRING" size="256"/>
          <Column id="PUB_ONLY_SPR_NM" type="STRING" size="256"/>
          <Column id="REPR_PRD_SPR_NM" type="STRING" size="256"/>
          <Column id="PRD_USE_YN_NM" type="STRING" size="256"/>
          <Column id="DISP_STATS_NM" type="STRING" size="256"/>
        </ColumnInfo>
      </Dataset>
    </Objects>
    <Script type="xscript5.1"><![CDATA[/*******************************************************
  PROJECT NAME : PNB스토리 - 목록
  CREATION DATES : 2022.03.30
*******************************************************/

/* 스크립트 인클루드 */
include "CO::coUtils.xjs";
include "OD::odUtils.xjs";
include "SA::saUtils.xjs";
/***********************************************************************************************
 * Form 변수 선언 영역
************************************************************************************************/
this.fv_oApp = nexacro.getApplication();
this.fv_coCd = this.fv_oApp.gds_userInfo.getColumn(0, "CO_CD");
this.totalCount = 0;
this.preSelectRowPosition = -1;
this.selPnbThmSeq = "";
this.selPnbSeq = "";
this.selPnbLvl = 0;
var curImgBtnName = "";
this.maxFileSize = "10";
/***********************************************************************************************
* FORM EVENT 영역(onload)
************************************************************************************************/
this.fn_onLoad = function(obj:Form, e:nexacro.LoadEventInfo)
{
	// 공통 함수 호출(필수)
	this.gfn_formOnLoad(this);
	
 	this.ds_search.setColumn(0, "CO_CD", this.fv_coCd);
	
	this.fn_grdPnbStoryThmList(); 
}

this.fn_onkeyup = function(obj:nexacro.Form,e:nexacro.KeyEventInfo)
{
	// CTRL+ENTER KEY
	if(e.keycode == 13 && e.ctrlkey) {
		this.div_search_btn_search_onclick();
	}
};


/***********************************************************************************************
* Transaction 서비스 호출 영역
************************************************************************************************/
/**
 * PNB스토리 grid 값 조회
 */
this.fn_grdPnbStoryThmList = function ()
{	
	var sSvcId = "grdPnbStoryThmList";  
	var sUrl = "/sa/pnb-story/select-pnb-story-thm-list.do";
	var sInData = "ds_search=ds_search"
	var sOutData = "ds_grdPnbStoryThmList=ds_output1";
	var sArg = "";
	var sCallback = "fn_callBack";

	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
};

/**
 * PNB스토리 테마 전시 순서 저장
 */
this.fn_saveThmDispSo = function()
{
	var sSvcId = "saveThmDispSo";
	var sUrl = "/sa/pnb-story/save-thm-disp-so.do";
	var sInData = "ds_save=ds_grdPnbStoryList:U"
	var sOutData = "";
	var sArg = "";
	var sCallback = "fn_callBack"; 
	 
	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}

/**
 * PNB스토리 테마 저장
 */
this.fn_saveThmInfo = function()
{
	var sSvcId = "saveThmInfo";  
	var sUrl = "/sa/pnb-story/save-thm-info.do";
	var sInData = "ds_save=ds_pnbStoryInfo:A ds_save2=ds_grdPnbStoryList:U"
	var sOutData = "";
	var sArg = "";
	var sCallback = "fn_callBack"; 
	 
	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}

/**
 * PNB스토리 테마 삭제
 */
this.fn_deleteThmInfo = function()
{
	var sSvcId = "deleteThmInfo";  
	var sUrl = "/sa/pnb-story/delete-thm-info.do";
	var sInData = "ds_delete=ds_pnbStoryInfo:A"
	var sOutData = "";
	var sArg = "";
	var sCallback = "fn_callBack"; 
	 
	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}

/**
 * PNB스토리 테마 아이템 저장(PNB_STORY_INFO)
 */
this.fn_savePnbStoryInfo = function()
{
	var sSvcId = "savePnbStoryInfo";  
	var sUrl = "/sa/pnb-story/save-pnb-story-info.do";
	var sInData = "ds_save=ds_pnbStoryInfo:A ds_save2=ds_grdPnbStoryCatgDtl:U ds_save3=ds_grdPnbStoryCatgPrdDtl:U"
	var sOutData = "";
	var sArg = "";
	var sCallback = "fn_callBack"; 
	 
	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}

/**
 * PNB스토리 테마 아이템 삭제(PNB_STORY_INFO)
 */
this.fn_deletePnbStoryInfo = function()
{
	var sSvcId = "deletePnbStoryInfo";  
	var sUrl = "/sa/pnb-story/delete-pnb-story-info.do";
	var sInData = "ds_delete=ds_pnbStoryInfo:A"
	var sOutData = "";
	var sArg = "";
	var sCallback = "fn_callBack"; 
	 
	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}

/**
 * PNB스토리 카테고리, 카테고리 상품 조회
 */
this.fn_grdPnbStoryCatgPrdList = function ()
{	
	var sSvcId = "grdPnbStoryCatgPrdList";  
	var sUrl = "/sa/pnb-story/select-pnb-story-catg-prd-list.do";
	var sInData = "ds_search=ds_pnbStoryInfo"
	var sOutData = "ds_grdPnbStoryCatgDtl=ds_output1 ds_grdPnbStoryCatgPrdDtl=ds_output2";
	var sArg = "";
	var sCallback = "fn_callBack";

	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
};

/**
 * 상품ID 유효성 검사
 */
this.fn_prdIdCheck = function()
{
	var sSvcId = "prdIdCheck";  
	var sUrl = "/sa/com/select-prd-id-check-list.do";
	var sInData = "ds_search=ds_search:A ds_searchPrdIdCheckList=ds_searchPrdIdCheckList:A"
	var sOutData = "ds_prdInfoList=ds_output1";
	var sArg = "";
	var sCallback = "fn_callBack"; 
	 
	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}

// 대용량 엑셀 다운로드
this.fn_largeExcelDown = function()
{
	var sSvcId = "selectPnbStoryExcel";
	var sUrl = "/sa/pnb-story/select-pnb-story-excel.do";
	var sInData = "ds_search=ds_search";
	var sOutData    = "ds_excelPnbStoryList=ds_output1";
	var sArg = "";
	var sCallback = "fn_callBack";

	this.gfn_transaction(sSvcId, sUrl, sInData, sOutData, sArg, sCallback);
}
/***********************************************************************************************
* Callback 처리 영역
************************************************************************************************/
/**
 * 공통 callback
 */
this.fn_callBack = function(svcID, errorCode, errorMsg)
{
	if(errorCode < 0) {
		alert(errorMsg);
		return;
	}
	
	switch (svcID) {
		case "grdPnbStoryThmList" :
			
			this.fn_pnbStorySelect(this.preSelectRowPosition);
			
			// 트리에서 선택된 것이 아이템일 경우 트리 열면서 위치 찾기
			if(this.selPnbLvl == 2) {
				this.fn_grdSetPosition();
			} else { // 아이템이 아닐 경우 선택위치만 세팅
				this.ds_grdPnbStoryThmList.set_rowposition(this.preSelectRowPosition);
			}
			break;
			
		case "saveThmDispSo" :
			if(errorCode == "") {
				alert(this.fn_getMessage("ERRN000030")); // 저장되었습니다.
				this.fn_grdPnbStoryThmList();
			}else{
				alert(errorMsg);
			}
			break;
			
		case "saveThmInfo" :
			if(errorCode == "") {
				alert(this.fn_getMessage("ERRN000030")); // 저장되었습니다.
				this.fn_grdPnbStoryThmList();
			}else{
				alert(errorMsg);
			}
			break;
			
		case "deleteThmInfo" :
			if(errorCode == "") {
				alert(this.fn_getMessage("ERRC000047")); // 삭제되었습니다.
				this.preSelectRowPosition = -1; // 초기화
				this.fn_grdPnbStoryThmList();
			}else{
				alert(errorMsg);
			}
			break;
		
		case "savePnbStoryInfo" :
			if(errorCode == "") {
				alert(this.fn_getMessage("ERRN000030")); // 저장되었습니다.
				this.fn_grdPnbStoryThmList();
			}else{
				alert(errorMsg);
			}			
			break;
		
		case "deletePnbStoryInfo" :
			if(errorCode == "") {
				alert(this.fn_getMessage("ERRC000047")); // 삭제되었습니다.
				this.preSelectRowPosition = -1; // 초기화
				this.fn_grdPnbStoryThmList();
			} else {
				alert(errorMsg);
			}
			break;
		
		case "grdPnbStoryCatgPrdList" :
			
			// 첫번째 카테고리의 상품 조회
			var nRow = this.ds_grdPnbStoryCatgDtl.rowposition;
			if (nRow >= 0) {
				var sPnbStoryCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(nRow, "PNB_CATG_SEQ");
				this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == '" + sPnbStoryCatgSeq + "'");	
			} else {
				this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == 'NOTHING'");	
			}
			
			var sTotText = "(<b v='true'>총 " + this.ds_grdPnbStoryCatgPrdDtl.getRowCount() + "건 </b>)";			
			this.div_dtl3.form.sta_totalCountPrdDtl.set_text(sTotText);
			
			break;
		
		case "selectPnbStoryExcel" :
			var sFileName = "PNB스토리_상품상태_EXCEL_EXPORT";
			var aGrid = [this.grd_excelPnbStoryList];
			var aSht  = ["PNB스토리"];
			var sToday = this.fn_todayTime();
			sFileName = sFileName + "_" + sToday;
			
			var oParam = {form:this, grid:aGrid, fileName:sFileName, sheetName:aSht};
			this.gfn_exportExcel(oParam);
			
			break;
			
		case "prdIdCheck" :

			var tempPrdId = "";
			
			for (var x = 0; x < this.ds_prdInfoList.getRowCount(); x++) {
				var sPrdId = this.ds_prdInfoList.getColumn(x, "PRD_ID");
				var sPrdIdView = this.ds_prdInfoList.getColumn(x, "PRD_ID_VIEW");
				var sPrdNm = this.ds_prdInfoList.getColumn(x, "PRD_NM");
				
				if (this.gfn_isNull(sPrdNm)) {
					tempPrdId = tempPrdId + sPrdIdView + ",";
				}
			}
			
			tempPrdId = tempPrdId.substring(0, tempPrdId.length-1);
			
			if (tempPrdId != "") {
				this.fn_textCopy(this.fn_getMessage("ERRN000025", tempPrdId));
				alert(this.fn_getMessage("ERRN000025", tempPrdId)); // 없는 상품ID가 있습니다. 상품ID를 확인해주세요.\n&1
			}

			var nRow = this.ds_grdPnbStoryCatgDtl.rowposition;	// this.grd_pnbStoryCatgDtl.currentrow;
			var sPnbCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(nRow, "PNB_CATG_SEQ");

			var totalCount2 = 0;
			tempPrdId = "";
	
			for (var x = 0; x < this.ds_prdInfoList.getRowCount(); x++) {
				var sPrdId = this.ds_prdInfoList.getColumn(x, "PRD_ID");
				var sPrdIdView = this.ds_prdInfoList.getColumn(x, "PRD_ID_VIEW");
				var sPrdNm = this.ds_prdInfoList.getColumn(x, "PRD_NM");
				var sAttrVal = this.ds_prdInfoList.getColumn(x, "ATTR_VAL");
				var sMnfr = this.ds_prdInfoList.getColumn(x, "MNFR");
				var sPubOnlySprNm = this.ds_prdInfoList.getColumn(x, "PUB_ONLY_SPR_NM");
				var sReprPrdSprNm = this.ds_prdInfoList.getColumn(x, "REPR_PRD_SPR_NM");
				var sPrdUseYnNm = this.ds_prdInfoList.getColumn(x, "PRD_USE_YN_NM");
				var sDispStatsNm = this.ds_prdInfoList.getColumn(x, "DISP_STATS_NM");
			
				if (!this.gfn_isNull(sPrdNm)) {
					var findRow = this.ds_grdPnbStoryCatgPrdDtl.findRowExpr("PRD_ID == '" + sPrdId + "'");

					if(findRow < 0) {
						var nRow = this.ds_grdPnbStoryCatgPrdDtl.addRow();
						
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "CO_CD", this.fv_coCd);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PNB_THM_SEQ", this.selPnbThmSeq);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PNB_SEQ", "");
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PNB_CATG_SEQ", sPnbCatgSeq);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_ID", sPrdId);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_ID_VIEW", sPrdIdView);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_NM", sPrdNm);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "ATTR_VAL", sAttrVal);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "MNFR", sMnfr);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PUB_ONLY_SPR_NM", sPubOnlySprNm);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "REPR_PRD_SPR_NM", sReprPrdSprNm);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_USE_YN_NM", sPrdUseYnNm);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "DISP_STATS_NM", sDispStatsNm);
						this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "DELETE_ROW", "");
					} else {
						totalCount2 = totalCount2 + 1;
							
						tempPrdId = tempPrdId + sPrdIdView + ",";
					}
				}
			}
		
			if (totalCount2 > 0) {
				tempPrdId = tempPrdId.substring(0, tempPrdId.length-1);
				this.fn_textCopy(this.fn_getMessage("ERRN000026", tempPrdId));
				alert(this.fn_getMessage("ERRN000026", tempPrdId)); // 상품이 중복되었습니다. 상품ID를 확인해주세요.\n&1
			}

			this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == '" + sPnbCatgSeq + "'");

			var sTotText = "(<b v='true'>총 " + this.ds_grdPnbStoryCatgPrdDtl.getRowCount() + "건 </b>)";			
			this.div_dtl3.form.sta_totalCountPrdDtl.set_text(sTotText);

			break;
			
		default : 
		
			break;
	}
}

// 팝업 callback
this.fn_popupCallback = function(sPopupId, sRetValue)
{
	if(this.gfn_isNull(sRetValue)) {
		return;
	}
	
	var retObj = JSON.parse(sRetValue);
	
	switch(sPopupId) {
		case "btn_searchPrdId" :

			var nRow = this.ds_grdPnbStoryCatgDtl.rowposition;	// this.grd_pnbStoryCatgDtl.currentrow;
			var sPnbCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(nRow, "PNB_CATG_SEQ");

			var totalCount2 = 0;
			var tempPrdId = "";
		
			for(var i=0; i<retObj.length; i++) {
				var rowData = JSON.parse(retObj[i]);
				
				var findRow = this.ds_grdPnbStoryCatgPrdDtl.findRowExpr("PRD_ID == '" + rowData.PRD_ID + "'");

				if(findRow < 0) {
					var nRow = this.ds_grdPnbStoryCatgPrdDtl.addRow();
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "CO_CD", this.fv_coCd);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PNB_THM_SEQ", this.selPnbThmSeq);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PNB_SEQ", "");
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PNB_CATG_SEQ", sPnbCatgSeq);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_ID", rowData.PRD_ID);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_ID_VIEW", rowData.PRD_ID_VIEW);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_NM", rowData.PRD_NM);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "ATTR_VAL", rowData.ATTR_VAL);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "MNFR", rowData.MNFR_NM);
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PUB_ONLY_SPR_NM", "");
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "REPR_PRD_SPR_NM", "");
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "PRD_USE_YN_NM", "");
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "DISP_STATS_NM", "");
					this.ds_grdPnbStoryCatgPrdDtl.setColumn(nRow, "DELETE_ROW", "");
				} else {
					totalCount2 = totalCount2 + 1;
							
					tempPrdId = tempPrdId + rowData.PRD_ID_VIEW + ",";
				}
			}
			
			if (totalCount2 > 0) {
				tempPrdId = tempPrdId.substring(0, tempPrdId.length-1);
				this.fn_textCopy(this.fn_getMessage("ERRN000026", tempPrdId));
				alert(this.fn_getMessage("ERRN000026", tempPrdId)); // 상품이 중복되었습니다. 상품ID를 확인해주세요.\n&1
			}
			
			this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == '" + sPnbCatgSeq + "'");

			var sTotText = "(<b v='true'>총 " + this.ds_grdPnbStoryCatgPrdDtl.getRowCount() + "건 </b>)";			
			this.div_dtl3.form.sta_totalCountPrdDtl.set_text(sTotText);

			break;
	
		case "btn_searchPrdIdMulText" :
		
			var retValue = retObj.textValue;
			
			if (retValue != "") {
				this.ds_searchPrdIdCheckList.clearData();
				
				var sTempValue = retValue.split(",");

				for (var x = 0; x < sTempValue.length; x++) {
					var sPrdId = sTempValue[x];
				
					if (sPrdId != "") {
						var nRow = this.ds_searchPrdIdCheckList.addRow();
						
						this.ds_searchPrdIdCheckList.setColumn(nRow, "CO_CD", this.fv_coCd);
						this.ds_searchPrdIdCheckList.setColumn(nRow, "PRD_ID", sPrdId);
					}
				}

				this.fn_prdIdCheck();
			}

			break;

		default : 
		
			break;
	}
}

/***********************************************************************************************
* 외부 호출 FUNCTION 영역
************************************************************************************************/
/**
 * 화면 설정 함수
 */
this.cfn_formInit = function()
{
	// 필수 설정
	this.div_dtl2.form.sta_ttl.uEssentiel = "true";
	this.div_dtl2.form.sta_expsCnt.uEssentiel = "true";
	this.div_dtl2.form.sta_pcImg.uEssentiel = "true";
	this.div_dtl2.form.sta_mblImg.uEssentiel = "true";	
	
	this.div_dtl3.form.sta_ttl.uEssentiel = "true";
	this.div_dtl3.form.sta_pcLstImg.uEssentiel = "true";
	this.div_dtl3.form.sta_pcDtlImg.uEssentiel = "true";
	this.div_dtl3.form.sta_mblLstImg.uEssentiel = "true";
	this.div_dtl3.form.sta_mblDtlImg.uEssentiel = "true";
	this.div_dtl3.form.sta_useYn.uEssentiel = "true";
}

/***********************************************************************************************
*  개발자(사용자) 함수 영역
************************************************************************************************/
// 트리 선택
this.fn_pnbStorySelect = function(selRow) {
	this.preSelectRowPosition = selRow; //선택한 로우 저장
	var dtlHeight = 33;
	var leafStatus = this.div_mst.form.grd_pnbStoryThmList.isTreeLeafRow(selRow);
	var vCoCd = this.ds_grdPnbStoryThmList.getColumn(selRow, "CO_CD");
	this.selPnbThmSeq = this.ds_grdPnbStoryThmList.getColumn(selRow, "PNB_THM_SEQ");
	this.selPnbSeq = this.ds_grdPnbStoryThmList.getColumn(selRow, "PNB_SEQ");	
	this.selPnbLvl = this.ds_grdPnbStoryThmList.getColumn(selRow, "PNB_LVL");	
	var activeDiv = this.div_dtl1;
	this.ds_pnbStoryInfo.copyRow(0, this.ds_grdPnbStoryThmList, selRow);
	
	// selRow == -1(테마전체조회) or vPnbLvl == 1(테마의 아이템 목록 조회) 일 경우
	if(this.selPnbLvl != 2) {
		this.ds_grdPnbStoryListTemp.clearData();
		this.ds_grdPnbStoryList.clearData();
		this.ds_grdPnbStoryListTemp.copyData(this.ds_grdPnbStoryThmList);
		if(selRow == -1) {
			this.ds_grdPnbStoryListTemp.filter("PNB_LVL == 1");
			this.div_dtl2.set_visible(false);
			this.div_dtl3.set_visible(false);
			
			this.div_mst.form.btn_itmAdd.set_visible(false);
		} else if(this.selPnbLvl == 1) {
			this.ds_grdPnbStoryListTemp.filter("PNB_THM_SEQ == '" + this.selPnbThmSeq + "' && PNB_LVL == '" + (this.selPnbLvl+1) + "'");
			activeDiv = this.div_dtl2;
			this.div_dtl1.set_visible(false);
			this.div_dtl3.set_visible(false);
			// 테마 삭제 버튼 노출, 취소버튼 미노출
			this.div_dtl3.form.btn_deleteThmItm.set_visible(true);
			this.div_dtl3.form.btn_cancelThmItm.set_visible(false);
			
			this.fn_setLenByte(this.div_dtl2.form.edt_ttl.value, 300, "thmNm"); // 글자수 체크
			
			this.div_mst.form.btn_itmAdd.set_visible(true);
			this.div_dtl3.form.sta_itmInfo.set_text("아이템 상세");
		}
		// 필터된 PNB리스트 복사
		this.ds_grdPnbStoryList.copyData(this.ds_grdPnbStoryListTemp, true);
		
		// 테마 아이템 크기 조정
		if(activeDiv.form.grd_pnbStoryList.rowcount == 0) {
			activeDiv.form.grd_pnbStoryList.set_height(dtlHeight + 2);
		}else{
			dtlHeight = activeDiv.form.grd_pnbStoryList.getRealRowFullSize();
			activeDiv.form.grd_pnbStoryList.set_height(dtlHeight + 2);	
		}
		activeDiv.form.sta_thmItmBack.set_height(dtlHeight+50);
		activeDiv.form.sta_thmItm.set_height(dtlHeight+50);
	} else {
		activeDiv = this.div_dtl3;
		this.div_dtl1.set_visible(false);
		this.div_dtl2.set_visible(false);
		// 테마 삭제 버튼 노출, 취소버튼 미노출
		this.div_dtl3.form.btn_deleteThmItm.set_visible(true);
		this.div_dtl3.form.btn_cancelThmItm.set_visible(false);
		
		this.div_mst.form.btn_itmAdd.set_visible(true);
		this.div_dtl3.form.sta_itmInfo.set_text("아이템 상세");
		
		// 글자수 체크
		this.fn_setLenByte(this.div_dtl3.form.edt_ttl.value, 300, "ttl");
		this.fn_setLenByte(this.div_dtl3.form.edt_subTtl.value, 300, "subTtl");
		
		// 카테고리 상품 조회
		this.fn_grdPnbStoryCatgPrdList();
	}
	activeDiv.set_visible(true);
	
	// div 위치값 조정
	activeDiv.set_left(600);
	activeDiv.set_top(0);
	activeDiv.set_right(0);
	
	//그리드 자동 펼치기
	var gridObj = this.div_mst.form.grd_pnbStoryThmList;
	var nGridRow = gridObj.getTreeRow(selRow);
	var nStatus  = gridObj.getTreeStatus(nGridRow);

	if(nStatus == 3) return;
	nStatus = (nStatus == 0 ? 1 : 0);
	gridObj.setTreeStatus(nGridRow, nStatus);
}

// 테마 아이템 등록 화면 세팅
this.fn_thmItmAdd = function() {
	var activeDiv = this.div_dtl3;
	this.div_dtl1.set_visible(false);
	this.div_dtl2.set_visible(false);
	this.div_dtl3.set_visible(true);
	activeDiv.set_left(600);
	activeDiv.set_top(0);
	activeDiv.set_right(0);
	// 테마 삭제 버튼 미노출, 취소버튼 노출
	this.div_dtl3.form.btn_deleteThmItm.set_visible(false);
	this.div_dtl3.form.btn_cancelThmItm.set_visible(true);
	
	this.ds_grdPnbStoryCatgDtl.clearData();
	this.ds_grdPnbStoryCatgPrdDtl.clearData();
	this.ds_grdPnbStoryCatgDtlTemp.clearData();
	this.ds_grdPnbStoryCatgPrdDtlTemp.clearData();
	this.ds_pnbStoryInfo.clearData();
	
	this.div_dtl3.form.sta_ttlSize.set_text("(0 / 300 Byte)");
	this.div_dtl3.form.sta_subTtlSize.set_text("(0 / 300 Byte)");
	
	this.ds_pnbStoryInfo.addRow();
	this.ds_pnbStoryInfo.setColumn(0, "CO_CD", this.fv_coCd)
	this.ds_pnbStoryInfo.setColumn(0, "PNB_THM_SEQ", this.ds_grdPnbStoryThmList.getColumn(this.preSelectRowPosition, "PNB_THM_SEQ"));
	this.div_dtl3.form.rdo_useYn.set_index(1);
	
	this.div_dtl3.form.sta_itmInfo.set_text("아이템 추가");
};

/**
 * 글자 byte 체크 함수
 */
this.fn_setLenByte = function(sVal, maxByte, sGubun)
{
	var expsText = "";
	
	var count = 0;
	if(!this.gfn_isNull(sVal)) {
		count = nexacro._getUtf8Length(sVal);
	}	
	
	if (count < 0) {
		count = 0;
	}
	
	if(count <= maxByte) {
		expsText = "(<fc v='red'>" + count + "</fc> / " + maxByte + " Byte)";
		
		if(sGubun == "thmNm") {
			this.div_dtl2.form.sta_ttlSize.set_text(expsText);
		} else if(sGubun == "ttl") {
			this.div_dtl3.form.sta_ttlSize.set_text(expsText);
		}  else if(sGubun == "subTtl") {
			this.div_dtl3.form.sta_subTtlSize.set_text(expsText);
		}
		return;
	}
	
	var tempVal = "";
	tempVal = nexacro._substrByUtf8(sVal, 0, maxByte);
	count = nexacro._getUtf8Length(tempVal);
	
	expsText = "(<fc v='red'>" + count + "</fc> / " + maxByte + " Byte)";

	if(sGubun == "thmNm") {
		this.div_dtl2.form.edt_ttl.set_value("");
		this.div_dtl2.form.edt_ttl.set_value(tempVal);
		this.div_dtl2.form.sta_ttlSize.set_text(expsText);
	} else if(sGubun == "ttl") {
		this.div_dtl3.form.edt_ttl.set_value("");
		this.div_dtl3.form.edt_ttl.set_value(tempVal);
		this.div_dtl3.form.sta_ttlSize.set_text(expsText);
	} else if(sGubun == "subTtl") {
		this.div_dtl3.form.edt_subTtl.set_value("");
		this.div_dtl3.form.edt_subTtl.set_value(tempVal);
		this.div_dtl3.form.sta_subTtlSize.set_text(expsText);
	}
};

//트리 셀 인덱스 가져온다.
this.fnGetTreeCellIndex = function(objGrid)
{
	var nCellCount = objGrid.getCellCount("body");
	var nCellType;
	var nCol = 0;
	for(nCol=0; nCol<nCellCount; nCol++) {
		nCellType = objGrid.getCellProperty("body",nCol,"displaytype");
		//get first treecell num
		if(nCellType = "treeitemcontrol") {
			break;
		}
	}
	return nCol;
}

// 선택된 위치로 이동
this.fn_grdSetPosition = function() 
{
	var grdTree	 	= this.div_mst.form.grd_pnbStoryThmList;
	var nCellIndex 	= this.fnGetTreeCellIndex(grdTree);
	var nRow 		= this.ds_grdPnbStoryThmList.findRow("PNB_SEQ",this.selPnbSeq);

	var nStartLvl 	= grdTree.getCellProperty("body",nCellIndex,"treestartlevel");
	var nEndLvl 	= 0;

	var arrRoot 	= new Array();
	grdTree.set_enableevent(false);
	if(!grdTree.isTreeRootRow(nRow,true)) {
		nEndLvl = grdTree.getCellPropertyValue(nRow,nCellIndex,"treelevel");
		var parentsRow 	= 0;
		var nRowFindRow = nRow;
		for(var i=nStartLvl; i<nEndLvl; i++) {
			parentsRow = grdTree.getTreeParentRow(nRowFindRow);
			if (parentsRow>-1) {
				arrRoot.push(parentsRow);
				nRowFindRow = parentsRow;
			} else {
				break;
			}
		}
	}
	grdTree.set_enableevent(true);

	for(var i=arrRoot.length; i>-1; i--) {
		grdTree.setTreeStatus(grdTree.getTreeRow(arrRoot[i]),true);
	}

	this.ds_grdPnbStoryThmList.set_rowposition(nRow);
}

//입력값 찾기
this.setFindeCodeRow = function (objForm) 
{
	var edtValue = this.div_mst.form.edt_searchNm.value;
	var dsTree	 = this.ds_grdPnbStoryThmList;
	var grdTree	 = this.div_mst.form.grd_pnbStoryThmList;

	var nTreeCellIndex = this.fnGetTreeCellIndex(grdTree);
	var nStartLvl = grdTree.getCellProperty("body",nTreeCellIndex,"treestartlevel");
	var nCellIndex = this.fnGetTreeCellIndex(grdTree);

	var nRowPos	 = dsTree.rowposition;

	if(!this.gfn_isNull(edtValue)) {
		var strSearchId = "TTL";
		var sFilterstr = strSearchId.toUpperCase() +".indexOf('"+edtValue.toUpperCase()+"') > -1";

		var findRow = 0;
			nRowPos++;
			findRow = dsTree.findRowExpr(sFilterstr,nRowPos);
	} else {
		//alert("검색어를 입력해 주세요.");
		this.alert(this.fn_getMessage("ERRS000220"));
		return false;
	}

	//parent row tree status update -> parent tree status "expand"
	var nTreeRow = 0;
	var nStartLvl = grdTree.getCellProperty("body",nCellIndex,"treestartlevel");
	var nEndLvl = 0;

	var arrRoot = new Array();
	grdTree.set_enableevent(false);
	if(!grdTree.isTreeRootRow(findRow,true)) {
		nEndLvl = grdTree.getCellPropertyValue(findRow,nCellIndex,"treelevel");

		var parentsRow = 0;
		var nRowFindRow = findRow;
		for(var i=nStartLvl; i<nEndLvl; i++) {
			parentsRow = grdTree.getTreeParentRow(nRowFindRow);

			if (parentsRow>-1){
				arrRoot.push(parentsRow);
				nRowFindRow = parentsRow;
			} else {
				break;
			}
		}
	}
	grdTree.set_enableevent(true);

	for(var i=arrRoot.length; i>-1; i--) {
		grdTree.setTreeStatus(grdTree.getTreeRow(arrRoot[i]),true);
	}

	if( findRow == -1 ) {
		alert(this.fn_getMessage("ERRN000035")); // 검색된 내용이 없습니다.
		findRow = 0;
	} 
	//set_rowposition
	dsTree.set_rowposition(findRow);
};

/***********************************************************************************************
*  각 Component 별 이벤트 영역
************************************************************************************************/
// 트리 클릭
this.grd_pnbStoryThmList_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(e.clickitem == "treeitembutton") {
		return false;
	}
	this.fn_pnbStorySelect(e.row);
};

// 카테고리 추가
this.btn_catgAdd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nRowCurr = this.ds_grdPnbStoryCatgDtl.rowposition;

	if (nRowCurr >= 0) {
		var sPnbCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(nRowCurr, "PNB_CATG_SEQ");
		var sCatgNm = this.ds_grdPnbStoryCatgDtl.getColumn(nRowCurr, "CATG_NM");
		var sCatgDispSo = this.ds_grdPnbStoryCatgDtl.getColumn(nRowCurr, "CATG_DISP_SO");
				
		if (this.div_dtl3.form.edt_catgNm.value == "" || this.div_dtl3.form.edt_catgNm.value == undefined) {
			alert(this.fn_getMessage("ERRN000001", "카테고리 명은")); // 카테고리 명은 필수 입력항목입니다.
			this.div_dtl3.form.edt_catgNm.setFocus();
			return;
		}
		
		if (this.div_dtl3.form.edt_catgDispSo.value == "" || this.div_dtl3.form.edt_catgDispSo.value == undefined) {
			alert(this.fn_getMessage("ERRN000001", "카테고리 순서는")); // 카테고리 순서는 필수 입력항목입니다.
			this.div_dtl3.form.edt_catgDispSo.setFocus();
			return;
		}

		this.ds_grdPnbStoryCatgDtlTemp.clearData();

		for(var i=0; i<this.ds_grdPnbStoryCatgDtl.getRowCount(); i++) {
			if (nRowCurr != i) {
				var nRowAdd = this.ds_grdPnbStoryCatgDtlTemp.addRow();
				
				this.ds_grdPnbStoryCatgDtlTemp.setColumn(nRowAdd, "CO_CD", this.ds_grdPnbStoryCatgDtl.getColumn(i, "CO_CD"));
				this.ds_grdPnbStoryCatgDtlTemp.setColumn(nRowAdd, "PNB_THM_SEQ", this.ds_grdPnbStoryCatgDtl.getColumn(i, "PNB_THM_SEQ"));
				this.ds_grdPnbStoryCatgDtlTemp.setColumn(nRowAdd, "PNB_SEQ", this.ds_grdPnbStoryCatgDtl.getColumn(i, "PNB_SEQ"));
				this.ds_grdPnbStoryCatgDtlTemp.setColumn(nRowAdd, "PNB_CATG_SEQ", this.ds_grdPnbStoryCatgDtl.getColumn(i, "PNB_CATG_SEQ"));
				this.ds_grdPnbStoryCatgDtlTemp.setColumn(nRowAdd, "CATG_NM", this.ds_grdPnbStoryCatgDtl.getColumn(i, "CATG_NM"));
				this.ds_grdPnbStoryCatgDtlTemp.setColumn(nRowAdd, "CATG_DISP_SO", this.ds_grdPnbStoryCatgDtl.getColumn(i, "CATG_DISP_SO"));
			}
		}

		var findRow = this.ds_grdPnbStoryCatgDtlTemp.findRowExpr("CATG_DISP_SO == '" + this.div_dtl3.form.edt_catgDispSo.value + "'");

		if(findRow >= 0) {
			alert(this.fn_getMessage("ERRN000005")); // 동일한 순서가 있습니다. 확인 후 재 입력해 주시기 바랍니다.
			this.div_dtl3.form.edt_catgDispSo.setFocus();
			return;
		}

		if (this.ds_grdPnbStoryCatgPrdDtl.getRowCount() <= 0) {
			alert(this.fn_getMessage("ERRN000006")); // 기본 상품은 최소 1개는 추가해야 합니다.
			return;
		}
	}
	
	var nRow = this.ds_grdPnbStoryCatgDtl.addRow();

	this.ds_grdPnbStoryCatgDtl.setColumn(nRow, "CO_CD", this.fv_coCd);
	this.ds_grdPnbStoryCatgDtl.setColumn(nRow, "PNB_THM_SEQ", this.selPnbThmSeq);
	this.ds_grdPnbStoryCatgDtl.setColumn(nRow, "PNB_SEQ", "");
	this.ds_grdPnbStoryCatgDtl.setColumn(nRow, "PNB_CATG_SEQ", "C" + nRow);
	
	this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == '" + "C" + nRow + "'");
};

// 카테고리 삭제
this.btn_catgDelete_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nRow = this.div_dtl3.form.grd_pnbStoryCatgDtl.currentrow;
	
	if (nRow < 0) {
		alert(this.fn_getMessage("ERRN000004")); // 카테고리를 먼저 선택해야 합니다.
		return;
	}
	
	if(confirm(this.fn_getMessage("ERRN000048"))) { // 삭제하시겠습니까?
	
		var nRow = this.ds_grdPnbStoryCatgDtl.rowposition;
		
		var sPnbCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(nRow, "PNB_CATG_SEQ");

		var aDelArr = new Array();
		
		for(var i = 0; i< this.ds_grdPnbStoryCatgPrdDtl.rowcount; i++) {
			if(this.ds_grdPnbStoryCatgPrdDtl.getColumn(i, "PNB_CATG_SEQ") == sPnbCatgSeq) {
				aDelArr.push(i);
			}
		}
		
		// 상품 삭제
		this.ds_grdPnbStoryCatgPrdDtl.deleteMultiRows(aDelArr);
		
		// 카테고리 삭제
		this.ds_grdPnbStoryCatgDtl.deleteRow(nRow);
		
		var nRow2 = this.ds_grdPnbStoryCatgDtl.rowposition;

		if (nRow2 >= 0) {
			var sPnbCatgSeq2 = this.ds_grdPnbStoryCatgDtl.getColumn(nRow2, "PNB_CATG_SEQ");

			this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == '" + sPnbCatgSeq2 + "'");	
		} else {
			this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == 'NOTHING'");	
		}
		
		var sTotText = "(<b v='true'>총 " + this.ds_grdPnbStoryCatgPrdDtl.getRowCount() + "건 </b>)";			
		this.div_dtl3.form.sta_totalCountPrdDtl.set_text(sTotText);
	}
};

// 상품 검색
this.btn_searchPrdId_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nRow = this.div_dtl3.form.grd_pnbStoryCatgDtl.currentrow;
	
	if (nRow < 0) {
		alert(this.fn_getMessage("ERRN000004")); // 카테고리를 먼저 선택해야 합니다.
		return;
	}
	
	var oArg = { coCd : this.fv_coCd
			   , mallSprCd : "0" // 몰구분없이 조회되도록
	           }; 

	var oOption = { top : "-1"
	              , left : "-1"
	              , width : "-1"
	              , height : "-1"
	              , popuptype : "modal"	// modal:showModal, modeless:application.open, modalsync:showModalSync, modalwindow:showModalWindow
	              , layered : "false"
	              , opacity : "100"
	              , autosize : "true"
	              , titlebar : "true"
	              , title : "카테고리 상품 조회"
	              };	

	this.gfn_openPopup(e.fromobject.id, "PR_POP::SSP_BO_PP_16.xfdl", oArg, "fn_popupCallback", oOption);
};

// 상품검색 멀티텍스트
this.btn_searchPrdIdMulText_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var nRow = this.div_dtl3.form.grd_pnbStoryCatgDtl.currentrow;
	
	if (nRow < 0) {
		alert(this.fn_getMessage("ERRN000004")); // 카테고리를 먼저 선택해야 합니다.
		return;
	}

	var oArg = { coCd : this.fv_coCd
	           , textId : this.div_dtl3.form.btn_searchPrdIdMulText
	           }; 

	var oOption = { top : "-1"
	              , left : "-1"
	              , width : "-1"
	              , height : "-1"
	              , popuptype : "modal"	// modal:showModal, modeless:application.open, modalsync:showModalSync, modalwindow:showModalWindow
	              , layered : "false"
	              , opacity : "100"
	              , autosize : "true"
	              , titlebar : "true"
	              , title : "멀티 텍스트"
	              };

	this.gfn_openPopup(e.fromobject.id, "CO_POP::SSP_BO_PP_13.xfdl", oArg, "fn_popupCallback", oOption);
};

// 카테고리 그리드 cell 클릭 시
this.grd_pnbStoryCatgDtl_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	var objDs = obj.getBindDataset();
	var nRow = objDs.rowposition;
	
	var sPnbCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(nRow, "PNB_CATG_SEQ");
	
	this.ds_grdPnbStoryCatgPrdDtl.filter("PNB_CATG_SEQ == '" + sPnbCatgSeq + "'");

	var sTotText = "(<b v='true'>총 " + this.ds_grdPnbStoryCatgPrdDtl.getRowCount() + "건 </b>)";			
	this.div_dtl3.form.sta_totalCountPrdDtl.set_text(sTotText);
};


// 카테고리 상품 cell 클릭 시
this.grd_pnbStoryCatgPrdDtl_oncellclick = function(obj:nexacro.Grid,e:nexacro.GridClickEventInfo)
{
	if(e.col == this.div_dtl3.form.grd_pnbStoryCatgPrdDtl.getBindCellIndex("body", "DELETE_ROW")) {
		if(confirm(this.fn_getMessage("ERRN000048"))) { // 삭제하시겠습니까?
		
			var objDs = obj.getBindDataset();
			var nRow = objDs.rowposition;
			
			objDs.deleteRow(nRow);
			
			var sTotText = "(<b v='true'>총 " + this.ds_grdPnbStoryCatgPrdDtl.getRowCount() + "건 </b>)";			
			this.div_dtl3.form.sta_totalCountPrdDtl.set_text(sTotText);
		}
	}
}

// 테마 추가
this.btn_thmAdd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var objParam = {};
	this.gfn_openPopup("thmRegPop", "SA::SSP_BO_NA_15.xfdl", objParam);
};

// 아이템 추가
this.btn_itmAdd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fn_thmItmAdd();
};

// 테마 전시 순서 저장
this.btn_saveThmDispSo_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	// 테마 아이템 순서
	for(var i = 0; i< this.ds_grdPnbStoryList.rowcount; i++) {
		this.ds_grdPnbStoryList.setColumn(i, "DISP_SO", i+1);
	}
	if( !this.fn_dataCheck(this.ds_grdPnbStoryList) ) {
		alert(this.fn_getMessage("ERRN000036")); // 변경된 내용이 없습니다.
		return false;
	}
	this.fn_saveThmDispSo();
};

// 테마 저장
this.btn_saveThm_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.gfn_isNull(this.div_dtl2.form.edt_ttl.value)) {
		alert(this.fn_getMessage("COMS000011", "테마 명")); // 테마 명을(를) 입력해 주십시오
		this.div_dtl2.form.edt_ttl.setFocus();
		return;
	}
	if(this.gfn_isNull(this.div_dtl2.form.edt_pcAtflNm.value)) {
		alert(this.fn_getMessage("ERRN000001", "PC 공통 표지 이미지는")); // PC 공통 표지 이미지는 필수 입력항목입니다.
		this.div_dtl2.form.edt_pcAtflNm.setFocus();
		return;
	}
	if(this.gfn_isNull(this.div_dtl2.form.edt_mblAtflNm.value)) {
		alert(this.fn_getMessage("ERRN000001", "Mobile 공통 표지 이미지는")); // Mobile 공통 표지 이미지는 필수 입력항목입니다.
		this.div_dtl2.form.edt_mblAtflNm.setFocus();
		return;
	}
	
	// 테마 아이템 순서
	for(var i = 0; i< this.ds_grdPnbStoryList.rowcount; i++) {
		this.ds_grdPnbStoryList.setColumn(i, "UI_DISP_SEQ", i+1);
	}
		
	// 파일업로드
	if( this.ds_file.rowcount > 0 ) {
		if(this.fn_dataCheck(this.ds_file) ) {
			var jsonArray = new Array();
			for(var i=0; i<this.ds_file.rowcount; i++){
				var imgType = this.ds_file.getColumn(i, "IMG_TYPE") == undefined ? "" : this.ds_file.getColumn(i, "IMG_TYPE");

				if(this.ds_file.getColumn(i, "IMG_TYPE") == "pc") {
					var jsonObj		= new Object();
					jsonObj.IMG_TYPE = imgType;
					jsonObj.DOC_REG_SEQ = this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_SEQ") == undefined ? 1 :this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_SEQ").toString();
					jsonObj.DOC_REG_ID = this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_ID") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_ID");
					jsonObj.ATFL_STOR_PATH = this.ds_pnbStoryInfo.getColumn(0, "PC_ATFL_STOR_PATH") == undefined ? "" :this.ds_pnbStoryInfo.getColumn(0, "PC_ATFL_STOR_PATH");
					jsonObj.ORI_ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "PC_ORI_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_ORI_ATFL_NM");
					jsonObj.ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "PC_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_ATFL_NM");
					jsonArray.push(jsonObj);
				} else if(this.ds_file.getColumn(i, "IMG_TYPE") == "mbl") {
					var jsonObj		= new Object();
					jsonObj.IMG_TYPE = imgType;
					jsonObj.DOC_REG_SEQ = this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_SEQ") == undefined ? 1 :this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_SEQ").toString();
					jsonObj.DOC_REG_ID = this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_ID") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_ID");
					jsonObj.ATFL_STOR_PATH = this.ds_pnbStoryInfo.getColumn(0, "MBL_ATFL_STOR_PATH") == undefined ? "" :this.ds_pnbStoryInfo.getColumn(0, "MBL_ATFL_STOR_PATH");
					jsonObj.ORI_ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "MBL_ORI_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_ORI_ATFL_NM");
					jsonObj.ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "MBL_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_ATFL_NM");
					jsonArray.push(jsonObj);
				}
			}
			this.fileUpTrans.setPostData("resList", JSON.stringify(jsonArray));
			this.fileUpTrans.upload('/sa/com/file-upload.do');
		} else {
			this.fn_saveThmInfo();
		}
	} else {
		this.fn_saveThmInfo();
	}
	
};

// 테마 아이템 등록 취소
this.btn_cancelThmItm_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	this.fn_pnbStorySelect(this.preSelectRowPosition);	
};

// 테마 삭제
this.btn_deleteThm_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.confirm(this.fn_getMessage("ERRN000048"))) { // 삭제하시겠습니까?
	   this.fn_deleteThmInfo();
	}
};

// 테마 아이템 저장(PNB_STORY_INFO)
this.btn_saveThmItm_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.gfn_isNull(this.div_dtl3.form.edt_ttl.value)) {
		alert(this.fn_getMessage("ERRN000001", "제목은")); // 제목은 필수 입력항목입니다.
		this.div_dtl3.form.edt_ttl.setFocus();
		return;
	}
	if(this.gfn_isNull(this.div_dtl3.form.edt_pcLstAtflNm.value)) {
		alert(this.fn_getMessage("ERRN000001", "[PC] 이미지")); // [PC] 이미지는 필수 입력항목입니다.
		this.div_dtl3.form.edt_pcLstAtflNm.setFocus();
		return;
	}
	if(this.gfn_isNull(this.div_dtl3.form.edt_pcDtlAtflNm.value)) {
		alert(this.fn_getMessage("ERRN000001", "[PC] 상세이미지")); // [PC] 상세이미지는 필수 입력항목입니다.
		this.div_dtl3.form.edt_pcDtlAtflNm.setFocus();
		return;
	}
	if(this.gfn_isNull(this.div_dtl3.form.edt_mblLstAtflNm.value)) {
		alert(this.fn_getMessage("ERRN000001", "[Mobile] 이미지")); // [Mobile] 이미지는 필수 입력항목입니다.
		this.div_dtl3.form.edt_mblLstAtflNm.setFocus();
		return;
	}
	if(this.gfn_isNull(this.div_dtl3.form.edt_mblDtlAtflNm.value)) {
		alert(this.fn_getMessage("ERRN000001", "[Mobile] 상세이미지")); // [Mobile] 상세이미지는 필수 입력항목입니다.
		this.div_dtl3.form.edt_mblDtlAtflNm.setFocus();
		return;
	}
	
	for(var i = 0; i< this.ds_grdPnbStoryCatgDtl.rowcount; i++) {
		var sPnbCatgSeq = this.ds_grdPnbStoryCatgDtl.getColumn(i, "PNB_CATG_SEQ");
		var sCatgNm = this.ds_grdPnbStoryCatgDtl.getColumn(i, "CATG_NM");
		var sCatgDispSo = this.ds_grdPnbStoryCatgDtl.getColumn(i, "CATG_DISP_SO");
		
		if (this.gfn_isNull(sCatgNm)) {
			alert(this.fn_getMessage("ERRN000001", "카테고리를 추가하면 카테고리 명은")); // 카테고리를 추가하면 카테고리 명은 필수 입력항목입니다.
			return;
		}
		
		if (this.gfn_isNull(sCatgDispSo)) {
			alert(this.fn_getMessage("ERRN000001", "카테고리를 추가하면 카테고리 순서는")); // 카테고리를 추가하면 카테고리 순서는 필수 입력항목입니다.
			this.edt_catgDispSo.setFocus();
			return;
		}

		this.ds_grdPnbStoryCatgDtlTemp.clearData();
		this.ds_grdPnbStoryCatgDtlTemp.copyData(this.ds_grdPnbStoryCatgDtl);
		this.ds_grdPnbStoryCatgDtlTemp.filter("CATG_DISP_SO == '" + this.div_dtl3.form.edt_catgDispSo.value + "'");
		var nCnt = this.ds_grdPnbStoryCatgDtlTemp.getRowCount();
		
		if(nCnt > 1) {
			alert(this.fn_getMessage("ERRN000005")); // 동일한 순서가 있습니다. 확인 후 재 입력해 주시기 바랍니다.
			this.div_dtl3.form.edt_catgDispSo.setFocus();
			return;
		}

		this.ds_grdPnbStoryCatgPrdDtlTemp.clearData();
		this.ds_grdPnbStoryCatgPrdDtlTemp.copyData(this.ds_grdPnbStoryCatgPrdDtl);
		this.ds_grdPnbStoryCatgPrdDtlTemp.filter("PNB_CATG_SEQ == '" + sPnbCatgSeq + "'");

		if (this.ds_grdPnbStoryCatgPrdDtlTemp.getRowCount() <= 0) {
			alert(this.fn_getMessage("ERRN000007")); // 카테고리를 추가하면 기본 상품은 최소 1개는 추가해야 합니다.
			return;
		}
	}
	
	// 파일업로드
	if( this.ds_file.rowcount > 0 ) {
		if(this.fn_dataCheck(this.ds_file) ) {
			var jsonArray = new Array();
			for(var i=0; i<this.ds_file.rowcount; i++){
				var imgType = this.ds_file.getColumn(i, "IMG_TYPE") == undefined ? "" : this.ds_file.getColumn(i, "IMG_TYPE");

				if(this.ds_file.getColumn(i, "IMG_TYPE") == "pcLst") {
					var jsonObj		= new Object();
					jsonObj.IMG_TYPE = imgType;
					jsonObj.DOC_REG_SEQ = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_DOC_REG_SEQ") == undefined ? 1 :this.ds_pnbStoryInfo.getColumn(0, "PC_LST_DOC_REG_SEQ").toString();
					jsonObj.DOC_REG_ID = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_DOC_REG_ID") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_LST_DOC_REG_ID");
					jsonObj.ATFL_STOR_PATH = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_ATFL_STOR_PATH") == undefined ? "" :this.ds_pnbStoryInfo.getColumn(0, "PC_LST_ATFL_STOR_PATH");
					jsonObj.ORI_ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_ORI_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_LST_ORI_ATFL_NM");
					jsonObj.ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_LST_ATFL_NM");
					jsonArray.push(jsonObj);
				} else if(this.ds_file.getColumn(i, "IMG_TYPE") == "mblLst") {
					var jsonObj		= new Object();
					jsonObj.IMG_TYPE = imgType;
					jsonObj.DOC_REG_SEQ = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_DOC_REG_SEQ") == undefined ? 1 :this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_DOC_REG_SEQ").toString();
					jsonObj.DOC_REG_ID = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_DOC_REG_ID") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_DOC_REG_ID");
					jsonObj.ATFL_STOR_PATH = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_ATFL_STOR_PATH") == undefined ? "" :this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_ATFL_STOR_PATH");
					jsonObj.ORI_ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_ORI_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_ORI_ATFL_NM");
					jsonObj.ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_ATFL_NM");
					jsonArray.push(jsonObj);
				} else if(this.ds_file.getColumn(i, "IMG_TYPE") == "pcDtl") {
					var jsonObj		= new Object();
					jsonObj.IMG_TYPE = imgType;
					jsonObj.DOC_REG_SEQ = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_DOC_REG_SEQ") == undefined ? 1 :this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_DOC_REG_SEQ").toString();
					jsonObj.DOC_REG_ID = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_DOC_REG_ID") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_DOC_REG_ID");
					jsonObj.ATFL_STOR_PATH = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_ATFL_STOR_PATH") == undefined ? "" :this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_ATFL_STOR_PATH");
					jsonObj.ORI_ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_ORI_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_ORI_ATFL_NM");
					jsonObj.ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_ATFL_NM");
					jsonArray.push(jsonObj);
				} else if(this.ds_file.getColumn(i, "IMG_TYPE") == "mblDtl") {
					var jsonObj		= new Object();
					jsonObj.IMG_TYPE = imgType;
					jsonObj.DOC_REG_SEQ = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_DOC_REG_SEQ") == undefined ? 1 :this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_DOC_REG_SEQ").toString();
					jsonObj.DOC_REG_ID = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_DOC_REG_ID") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_DOC_REG_ID");
					jsonObj.ATFL_STOR_PATH = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_ATFL_STOR_PATH") == undefined ? "" :this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_ATFL_STOR_PATH");
					jsonObj.ORI_ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_ORI_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_ORI_ATFL_NM");
					jsonObj.ATFL_NM = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_ATFL_NM") == undefined ? "" : this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_ATFL_NM");
					jsonArray.push(jsonObj);
				}
			}
			this.fileUpTrans.setPostData("resList", JSON.stringify(jsonArray));
			this.fileUpTrans.upload('/sa/com/file-upload.do');
		} else {
			this.fn_savePnbStoryInfo();
		}
	} else {
		this.fn_savePnbStoryInfo();
	}
};

// 테마 아이템 삭제(PNB_STORY_INFO)
this.btn_deleteThmItm_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(this.confirm(this.fn_getMessage("ERRN000048"))) { // 삭제하시겠습니까?
		this.fn_deletePnbStoryInfo();
	}
};

// 검색
this.btn_find_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var objForm = obj.parent;
	this.setFindeCodeRow(objForm);
};

//검색 input
this.edt_searchNm_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	if( e.keycode == 13 ) {
		this.div_mst.form.btn_find.click();
	}	
};

//drag 시작
this.grd_pnbStoryList_ondrag = function(obj:nexacro.Grid,e:nexacro.GridDragEventInfo)
{
	// 그리드의 ☰ 표시 눌러서만 드래그되게
	if(e.col != 1) {
		return;
	}
	
	var nRow = e.row;
	var oBindDs = this[obj.binddataset];
	var sValue = oBindDs.getColumn(e.row,"TTL");
	
	//static component check 
	var oStatic =  this["sta_drag"];
	if(!this.gfn_isNull(oStatic)){
		oStatic = this.removeChild("sta_drag");
		oStatic.destroy();
	}
	
	//static component position 설정
	var nLeft = e.clientx + obj.getOffsetLeft() + 10 + 600; //600px left값을 더해줌
	var nTop  = e.clienty + obj.getOffsetTop();
	
	//static component 생성
	oStatic = new Static();	
	oStatic.init( "sta_drag", nLeft, nTop, 200,50);
	this.addChild("sta_drag",oStatic);
	oStatic.set_background("#bcbcbc");
	oStatic.set_text(sValue);
	oStatic.uAsRow = nRow;
	oStatic.show();
	
	return true;
};

//이동
this.grd_pnbStoryList_ondragmove = function(obj:nexacro.Grid,e:nexacro.GridDragEventInfo)
{
	var nLeft = e.clientx + obj.getOffsetLeft() + 10 + 600; //600px left값을 더해줌
	var nTop  = e.clienty + obj.getOffsetTop();
	this.sta_drag.move(nLeft,nTop);
};

//row 변경
this.grd_pnbStoryList_ondrop = function(obj:nexacro.Grid,e:nexacro.GridDragEventInfo)
{
	var nToRow = e.row;
	var oBindDs = this[obj.binddataset];
	oBindDs.moveRow(this.sta_drag.uAsRow, nToRow)
	var	oStatic = this.removeChild("sta_drag");
	oStatic.destroy();
};

// 이미지 삭제
this.btn_imgDelete_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	var findRow = -1;
	if(e.fromobject.id == "btn_pcImgDelete") {	
		this.ds_pnbStoryInfo.setColumn(0,"PC_ATFL_NM", "");		
		this.fileUpTrans.removeFile("pc");
		findRow = this.ds_file.findRowExpr("IMG_TYPE == 'pc'");		
	} else if(e.fromobject.id == "btn_mblImgDelete") {	
		this.ds_pnbStoryInfo.setColumn(0,"MBL_ATFL_NM", "");		
		this.fileUpTrans.removeFile("mbl");
		findRow = this.ds_file.findRowExpr("IMG_TYPE == 'mbl'");
	} else if(e.fromobject.id == "btn_pcLstImgDelete") {	
		this.ds_pnbStoryInfo.setColumn(0,"PC_LST_ATFL_NM", "");		
		this.fileUpTrans.removeFile("pcLst");
		findRow = this.ds_file.findRowExpr("IMG_TYPE == 'pcLst'");
	} else if(e.fromobject.id == "btn_pcDtlImgDelete") {	
		this.ds_pnbStoryInfo.setColumn(0,"PC_DTL_ATFL_NM", "");		
		this.fileUpTrans.removeFile("pcDtl");
		findRow = this.ds_file.findRowExpr("IMG_TYPE == 'pcDtl'");
	} else if(e.fromobject.id == "btn_mblLstImgDelete") {	
		this.ds_pnbStoryInfo.setColumn(0,"MBL_LST_ATFL_NM", "");		
		this.fileUpTrans.removeFile("mblLst");
		findRow = this.ds_file.findRowExpr("IMG_TYPE == 'mblLst'");
	} else if(e.fromobject.id == "btn_mblDtlImgDelete") {	
		this.ds_pnbStoryInfo.setColumn(0,"MBL_DTL_ATFL_NM", "");		
		this.fileUpTrans.removeFile("mblDtl");
		findRow = this.ds_file.findRowExpr("IMG_TYPE == 'mblDtl'");
	}
	
	if (findRow >= 0) {
		this.ds_file.deleteRow(findRow);
	}
};

// 이미지 등록
this.btn_imgAdd_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	curImgBtnName = e.fromobject.id;
	this.fileDialog.set_accept(this.fileType);
	this.fileDialog.open('nexacro17', FileDialog.MULTILOAD);
};

// 이미지 노출 처리
this.edt_atflNm_onmouseenter = function(obj:nexacro.Edit,e:nexacro.MouseEventInfo)
{
	var docRegId = "";
	var docRegSeq = "";
	
	if(e.fromobject.id == "edt_pcAtflNm") {
		docRegId = this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_ID");
		docRegSeq = this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_SEQ");
	} else if(e.fromobject.id == "edt_mblAtflNm") {
		docRegId = this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_ID");
		docRegSeq = this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_SEQ");
	} else if(e.fromobject.id == "edt_pcLstAtflNm") {
		docRegId = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_DOC_REG_ID");
		docRegSeq = this.ds_pnbStoryInfo.getColumn(0, "PC_LST_DOC_REG_SEQ");
	} else if(e.fromobject.id == "edt_mblLstAtflNm") {
		docRegId = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_DOC_REG_ID");
		docRegSeq = this.ds_pnbStoryInfo.getColumn(0, "MBL_LST_DOC_REG_SEQ");
	} else if(e.fromobject.id == "edt_pcDtlAtflNm") {
		docRegId = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_DOC_REG_ID");
		docRegSeq = this.ds_pnbStoryInfo.getColumn(0, "PC_DTL_DOC_REG_SEQ");
	} else if(e.fromobject.id == "edt_mblDtlAtflNm") {
		docRegId = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_DOC_REG_ID");
		docRegSeq = this.ds_pnbStoryInfo.getColumn(0, "MBL_DTL_DOC_REG_SEQ");
	}
	this.img_view.set_width(200);
 	this.img_view.set_height(300);

	if(!this.gfn_isNull(docRegId)) {
		// 화면을 띄우기에 obj.left는 150px이고 좌측에 떨어진 600px 을 더해야해서 하드코딩
		obj.left = 750;
		this.fn_imgView(this.img_view, obj, docRegId, docRegSeq);
	}
};

this.edt_atflNm_onmouseleave = function(obj:nexacro.Edit,e:nexacro.MouseEventInfo)
{
	this.img_view.set_visible(false);
};

// 테마명 keyup
this.edt_thmNm_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	this.fn_setLenByte(obj.value, 300, "thmNm");
};

// 제목 keyup
this.edt_ttl_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	this.fn_setLenByte(obj.value, 300, "ttl");
};
// 서브 제목 keyup
this.edt_subTtl_onkeyup = function(obj:nexacro.Edit,e:nexacro.KeyEventInfo)
{
	this.fn_setLenByte(obj.value, 300, "subTtl");
};

// 대용량 엑셀 다운로드
this.btn_largeExcel_onclick = function(obj:nexacro.Button,e:nexacro.ClickEventInfo)
{
	if(!this.confirm(this.fn_getMessage("ERRP000268"))) { // 대용량 다운로드를 실행하시겠습니까?
	   return false;
	}
	
	this.fn_largeExcelDown();
};

/***********************************************************************************************
*  파일 관련 영역
************************************************************************************************/

//해당 row에 파일 추가
this.addFileList = function(filelists)
{
	var vFile= filelists[0];
	vFile.addEventHandler("onsuccess", this.fileList_onsuccess, this);
	vFile.addEventHandler("onerror", this.fileList_onerror, this);
	vFile.open(null, VirtualFile.openRead);
	vFile.getFileSize();	//return file size
	vFile.close();
};

//업로드용 Virtual 파일 onsuccess 이벤트
this.fileList_onsuccess = function(obj:nexacro.VirtualFile, e:nexacro.VirtualFileEventInfo)
{
	if (e.reason == 1){
		//파일사이즈 체크
		obj.getFileSize();
	}

	if (e.reason == 9) {
		if( !this.fn_fileSizeCheck(obj, e.filesize) ) return false;


		// 같은 이름의 파일을 업로드했을 경우 대비
// 		this.ds_pnbStoryInfo.set_updatecontrol(false);
// 		this.ds_pnbStoryInfo.setRowType(0, Dataset.ROWTYPE_UPDATE);
// 		this.ds_pnbStoryInfo.set_updatecontrol(true);
		var imgType = "";
		var colName = "";
		if(curImgBtnName == "btn_pcImgAdd") {
			imgType = "pc";
			colName = "PC_ATFL_NM";
		} else if(curImgBtnName == "btn_mblImgAdd") {
			imgType = "mbl";
			colName = "MBL_ATFL_NM";
		} else if(curImgBtnName == "btn_pcLstImgAdd") {
			imgType = "pcLst";
			colName = "PC_LST_ATFL_NM";
		} else if(curImgBtnName == "btn_mblLstImgAdd") {
			imgType = "mblLst";
			colName = "MBL_LST_ATFL_NM";
		} else if(curImgBtnName == "btn_pcDtlImgAdd") {
			imgType = "pcDtl";
			colName = "PC_DTL_ATFL_NM";
		} else if(curImgBtnName == "btn_mblDtlImgAdd") {
			imgType = "mblDtl";
			colName = "MBL_DTL_ATFL_NM";
		}
		
		this.fileUpTrans.removeFile(imgType);
		var findRow = this.ds_file.findRowExpr("IMG_TYPE == '" + imgType + "'");
		if (findRow >= 0) {
			this.ds_file.deleteRow(findRow);
		}

		// 수정 후 다시 저장 시에 기존 파일 데이터도 같이 전송하여 삭제 처리.
		var nRowIdx = this.ds_file.addRow();
		this.ds_file.setColumn(nRowIdx, "ATFL_NM", obj.filename);
		this.ds_file.setColumn(nRowIdx, "IMG_TYPE", imgType);
		this.ds_pnbStoryInfo.setColumn(0, colName, obj.filename);
		this.fileUpTrans.addFile(imgType, obj)
	}
};

//업로드용 Virtual 파일 oneroor 이벤트
this.fileList_onerror = function(obj:nexacro.VirtualFile, e:nexacro.VirtualFileErrorEventInfo)
{
	var msg = ">>>>>>>>> VirtualFile event ERROR >>>>>>>>\n";
	msg += "errortype : "+e.errortype+"\n";
	msg += "errormsg : "+e.errormsg+"\n";
	msg += "statuscode : "+e.statuscode;
	this.nRow = -1;
	alert(msg);
};

// 파일 다운로드
this.downloadfile = function(imgType) {
	tthis.FileDownTransfer.clearPostDataList();
	if(imgType == "pc") {
		this.FileDownTransfer.set_downloadfilename(this.ds_pnbStoryInfo.getColumn(0, "PC_ATFL_NM"));	//runtime 전용 프로퍼티
		this.FileDownTransfer.setPostData("docRegId",this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_ID"));
		this.FileDownTransfer.setPostData("docRegSeq",this.ds_pnbStoryInfo.getColumn(0, "PC_DOC_REG_SEQ"));
	} else if(imgType == "mbl") {
		this.FileDownTransfer.set_downloadfilename(this.ds_pnbStoryInfo.getColumn(0, "MBL_ATFL_NM"));	//runtime 전용 프로퍼티
		this.FileDownTransfer.setPostData("docRegId",this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_ID"));
		this.FileDownTransfer.setPostData("docRegSeq",this.ds_pnbStoryInfo.getColumn(0, "MBL_DOC_REG_SEQ"));
	}
	this.FileDownTransfer.download('/co/file-download.do');
};

//파일 확장자 검증
this.fn_fileSizeCheck = function(obj, fileSize) {
	var fileName = obj.filename;
	var extNm  = fileName.substr(fileName.lastIndexOf(".") + 1); // 맨 뒤 확장자만 자르기
	var fileGbn = ".jpg, .png";

	extNm = extNm.toLowerCase();

	//10485760 - 10메가
	//메가바이트 변환
	var mbSize = fileSize / 1024 / 1024;

	if( this.maxFileSize < mbSize ) {
		alert(this.fn_getMessage("ERRN000039", extNm)); // &1 파일은 10MB 이상으로 첨부하실 수 없습니다.
		return false;
	}

	if( fileGbn.indexOf(extNm) == -1 ) {
		alert(this.fn_getMessage("ERRN000040", extNm)); // &1 파일은 허용되지 않는 파일 타입입니다.
		return false;
	}

	return true;
};

//파일 DIALOG CLOSE 이벤트
this.fileDialog_onclose = function(obj:nexacro.FileDialog,e:nexacro.FileDialogEventInfo)
{
	if(this.gfn_isNull(e.virtualfiles)){
		return;
	}

	var vFile = e.virtualfiles[0];
	//VirtualFile 이벤트 생성
	vFile.addEventHandler("onsuccess", this.fileList_onsuccess, this);
	vFile.addEventHandler("onerror", this.fileList_onerror, this);
	vFile.open(null, 1);
};

//다운 완료
this.FileDownTransfer_onsuccess = function(obj:nexacro.FileDownTransfer,e:nexacro.FileDownTransferEventInfo)
{
	console.log(e);
	console.log(obj);
};

//다운 실패
this.FileDownTransfer_onerror = function(obj:nexacro.FileDownTransfer,e:nexacro.FileDownTransferErrorEventInfo)
{
	console.log(e);
	console.log(obj);
};

//저장 -> 파일 업로드 성공 시
this.fileUpTrans_onsuccess = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferEventInfo)
{
	var thmSaveYn = "N";
	var objCallDs = e.datasets[0];
	if(objCallDs.rowcount  == 0 ){
		alert(this.fn_getMessage("ERRN000041")); // 파일 업로드 오류입니다.
	}

	for(var i = 0 ; i < objCallDs.rowcount ; i++){
// 		if(objCallDs.getColumn(i, "result") == "none") {
// 			alert("파일이 없습니다.");
// 			return;
// 		}
		if(objCallDs.getColumn(i, "imgType") == "pc") {
			this.ds_pnbStoryInfo.setColumn(0, "PC_DOC_REG_ID", objCallDs.getColumn(i, "docRegId"));
			thmSaveYn = "Y";
		} else if(objCallDs.getColumn(i, "imgType") == "mbl") {
			this.ds_pnbStoryInfo.setColumn(0, "MBL_DOC_REG_ID", objCallDs.getColumn(i, "docRegId"));
			thmSaveYn = "Y";
		} else if(objCallDs.getColumn(i, "imgType") == "pcLst") {
			this.ds_pnbStoryInfo.setColumn(0, "PC_LST_DOC_REG_ID", objCallDs.getColumn(i, "docRegId"));
		} else if(objCallDs.getColumn(i, "imgType") == "mblLst") {
			this.ds_pnbStoryInfo.setColumn(0, "MBL_LST_DOC_REG_ID", objCallDs.getColumn(i, "docRegId"));
		} else if(objCallDs.getColumn(i, "imgType") == "pcDtl") {
			this.ds_pnbStoryInfo.setColumn(0, "PC_DTL_DOC_REG_ID", objCallDs.getColumn(i, "docRegId"));
		} else if(objCallDs.getColumn(i, "imgType") == "mblDtl") {
			this.ds_pnbStoryInfo.setColumn(0, "MBL_DTL_DOC_REG_ID", objCallDs.getColumn(i, "docRegId"));
		}
	}
	
	this.ds_file.clearData(); // 업로드 완료 후 ds_file 클리어
	this.fileUpTrans.clearFileList();

	if(thmSaveYn == "Y") { // 테마
		this.fn_saveThmInfo();
	} else { // 테마 아이템
		this.fn_savePnbStoryInfo();
	}

};

// 파일전송 실패
this.fileUpTrans_onerror = function(obj:nexacro.FileUpTransfer,e:nexacro.FileUpTransferErrorEventInfo)
{
	alert(e.errormsg);
};

]]></Script>
    <Bind>
      <BindItem id="item5" compid="edt_searchRegpsnIdNm" propid="value" datasetid="ds_search" columnid="REGPSN_ID_NM"/>
      <BindItem id="item0" compid="div_dtl2.form.edt_ttl" propid="value" datasetid="ds_pnbStoryInfo" columnid="TTL"/>
      <BindItem id="item1" compid="div_dtl2.form.rdo_useYn" propid="value" datasetid="ds_pnbStoryInfo" columnid="USE_YN"/>
      <BindItem id="item2" compid="div_dtl2.form.sta_regpsnId" propid="text" datasetid="ds_pnbStoryInfo" columnid="REGPSN_ID"/>
      <BindItem id="item3" compid="div_dtl2.form.sta_regDtm" propid="text" datasetid="ds_pnbStoryInfo" columnid="REG_DTM"/>
      <BindItem id="item4" compid="div_dtl2.form.sta_regpsnNm" propid="text" datasetid="ds_pnbStoryInfo" columnid="REGPSN_NM"/>
      <BindItem id="item6" compid="div_dtl2.form.sta_updDtm" propid="text" datasetid="ds_pnbStoryInfo" columnid="UPD_DTM"/>
      <BindItem id="item7" compid="div_dtl2.form.sta_updpsnId" propid="text" datasetid="ds_pnbStoryInfo" columnid="UPDPSN_ID"/>
      <BindItem id="item8" compid="div_dtl2.form.sta_updpsnNm" propid="text" datasetid="ds_pnbStoryInfo" columnid="UPDPSN_NM"/>
      <BindItem id="item10" compid="div_dtl3.form.edt_ttl" propid="value" datasetid="ds_pnbStoryInfo" columnid="TTL"/>
      <BindItem id="item11" compid="div_dtl3.form.rdo_useYn" propid="value" datasetid="ds_pnbStoryInfo" columnid="USE_YN"/>
      <BindItem id="item13" compid="div_dtl3.form.edt_subTtl" propid="value" datasetid="ds_pnbStoryInfo" columnid="SUB_TTL"/>
      <BindItem id="item12" compid="div_dtl3.form.edt_pcLstAtflNm" propid="value" datasetid="ds_pnbStoryInfo" columnid="PC_LST_ATFL_NM"/>
      <BindItem id="item14" compid="div_dtl3.form.edt_pcDtlAtflNm" propid="value" datasetid="ds_pnbStoryInfo" columnid="PC_DTL_ATFL_NM"/>
      <BindItem id="item15" compid="div_dtl3.form.edt_mblLstAtflNm" propid="value" datasetid="ds_pnbStoryInfo" columnid="MBL_LST_ATFL_NM"/>
      <BindItem id="item16" compid="div_dtl3.form.edt_mblDtlAtflNm" propid="value" datasetid="ds_pnbStoryInfo" columnid="MBL_DTL_ATFL_NM"/>
      <BindItem id="item17" compid="div_dtl3.form.edt_cnsolSrwr" propid="value" datasetid="ds_pnbStoryInfo" columnid="CNSOL_SRWR"/>
      <BindItem id="item18" compid="div_dtl3.form.edt_catgNm" propid="value" datasetid="ds_grdPnbStoryCatgDtl" columnid="CATG_NM"/>
      <BindItem id="item19" compid="div_dtl3.form.edt_catgDispSo" propid="value" datasetid="ds_grdPnbStoryCatgDtl" columnid="CATG_DISP_SO"/>
      <BindItem id="item21" compid="div_dtl2.form.edt_pcAtflNm" propid="value" datasetid="ds_pnbStoryInfo" columnid="PC_ATFL_NM"/>
      <BindItem id="item22" compid="div_dtl2.form.edt_mblAtflNm" propid="value" datasetid="ds_pnbStoryInfo" columnid="MBL_ATFL_NM"/>
      <BindItem id="item9" compid="div_dtl2.form.cbo_pcExpsCnt" propid="value" datasetid="ds_pnbStoryInfo" columnid="PC_EXPS_CNT"/>
      <BindItem id="item20" compid="div_dtl2.form.cbo_mblExpsCnt" propid="value" datasetid="ds_pnbStoryInfo" columnid="MBL_EXPS_CNT"/>
    </Bind>
    <InitValue/>
  </Form>
</FDL>
